{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.1", "generated_at": "2025-02-02T21:18:09.025947Z", "invocation_id": "0ed7a9d4-1b6f-4bb6-9a72-ad4caf8c3d86", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.447387Z", "completed_at": "2025-02-02T21:18:08.467455Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.467455Z", "completed_at": "2025-02-02T21:18:08.467455Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023284196853637695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.src_hosts", "compiled": true, "compiled_code": "WITH raw_hosts AS (\n    SELECT\n        *\n    FROM\n       \"DBT\".\"raw\".\"raw_hosts\"\n)\nSELECT\n    id AS host_id,\n    NAME AS host_name,\n    is_superhost,\n    created_at,\n    updated_at\nFROM\n    raw_hosts", "relation_name": "\"DBT\".\"raw\".\"src_hosts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.473647Z", "completed_at": "2025-02-02T21:18:08.478579Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.479576Z", "completed_at": "2025-02-02T21:18:08.479576Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00787353515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.src_listings", "compiled": true, "compiled_code": "-- import raw_listings\nWITH raw_listings AS (\n        SELECT * FROM \"DBT\".\"raw\".\"raw_listings\"\n)\nSELECT \n   id AS listing_id,\n   listing_url,\n   name AS listing_name,\n   room_type,\n   minimum_nights,\n   host_id,\n   price AS price_str,\n   created_at,\n   updated_at\nFROM raw_listings", "relation_name": "\"DBT\".\"raw\".\"src_listings\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.483473Z", "completed_at": "2025-02-02T21:18:08.491752Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.493835Z", "completed_at": "2025-02-02T21:18:08.493835Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011525392532348633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.src_reviews", "compiled": true, "compiled_code": "WITH raw_reviews AS (\n    SELECT\n        *\n    FROM\n        \"DBT\".\"raw\".\"raw_reviews\"\n)\nSELECT\n    listing_id,\n    review_date AS review_date,\n    reviewer_name,\n    comments AS review_text,\n    sentiment AS review_sentiment\nFROM\n    raw_reviews", "relation_name": "\"DBT\".\"raw\".\"src_reviews\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.498150Z", "completed_at": "2025-02-02T21:18:08.518491Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.519825Z", "completed_at": "2025-02-02T21:18:08.519825Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022705554962158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.dbtlearn.dbtlearn-on-run-end-0", "compiled": true, "compiled_code": "\n \n  \n  \n  \n  \n  \n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.521678Z", "completed_at": "2025-02-02T21:18:08.524033Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.524033Z", "completed_at": "2025-02-02T21:18:08.524033Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031778812408447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbtlearn.seed_full_moon_dates", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.527074Z", "completed_at": "2025-02-02T21:18:08.530969Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.532318Z", "completed_at": "2025-02-02T21:18:08.532318Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0062408447265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbtlearn.scd_raw_hosts", "compiled": true, "compiled_code": "\n\n\n\nselect * FROM \"DBT\".\"raw\".\"raw_hosts\"\n", "relation_name": "\"DBT\".\"raw\".\"scd_raw_hosts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.533812Z", "completed_at": "2025-02-02T21:18:08.534838Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.534838Z", "completed_at": "2025-02-02T21:18:08.534838Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001482248306274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbtlearn.scd_raw_listings", "compiled": true, "compiled_code": "\n\n\n\nselect * FROM \"DBT\".\"raw\".\"raw_listings\"\n", "relation_name": "\"DBT\".\"raw\".\"scd_raw_listings\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.541569Z", "completed_at": "2025-02-02T21:18:08.563528Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.563528Z", "completed_at": "2025-02-02T21:18:08.563528Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023955106735229492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65", "compiled": true, "compiled_code": "\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \ncount(distinct room_type) = 4\n as expression\n\n\n    from \"DBT\".\"raw\".\"raw_listings\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.567427Z", "completed_at": "2025-02-02T21:18:08.577272Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.577272Z", "completed_at": "2025-02-02T21:18:08.577272Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01087498664855957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \n\ncoalesce(array_length((select regexp_matches(price, '^\\\\$[0-9][0-9\\\\.]+$', '')), 1), 0)\n\n\n > 0\n as expression\n\n\n    from \"DBT\".\"raw\".\"raw_listings\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.584106Z", "completed_at": "2025-02-02T21:18:08.587131Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.587131Z", "completed_at": "2025-02-02T21:18:08.588130Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005053997039794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.test_listing_review_created_at_consistency", "compiled": true, "compiled_code": "with listing_reviews as\r\n(\r\n\tselect\r\n\trl.id as listing_id,\r\n\trl.created_at  as listing_created_at,\r\n\trr.review_date as review_created_at\r\n\tfrom raw.raw_listings rl left join raw.raw_reviews rr\r\n\ton rl.id=rr.listing_id\r\n\t--where rl.created_at > rr.review_date\r\n)\r\n\r\nselect \r\nlisting_id,\r\nlisting_created_at,\r\nreview_created_at\r\nfrom \r\nlisting_reviews\r\nwhere review_created_at < listing_created_at", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.589584Z", "completed_at": "2025-02-02T21:18:08.593941Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.593941Z", "completed_at": "2025-02-02T21:18:08.593941Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006542205810546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_hosts_cleansed", "compiled": true, "compiled_code": "WITH src_hosts AS (\n    SELECT * FROM \"DBT\".\"raw\".\"src_hosts\"\n)\nSELECT \n    host_id,\n    COALESCE(host_name, 'Anonymous') AS name,\n    is_superhost,\n    created_at,\n    updated_at\nfrom src_hosts", "relation_name": "\"DBT\".\"raw\".\"dim_hosts_cleansed\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.596142Z", "completed_at": "2025-02-02T21:18:08.600356Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.600356Z", "completed_at": "2025-02-02T21:18:08.600356Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0043718814849853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_listings_cleansed", "compiled": true, "compiled_code": "WITH src_listings AS (\n    SELECT * FROM \"DBT\".\"raw\".\"src_listings\"\n)\nSELECT \n    listing_id,\n    listing_name,\n    room_type,\n    CASE \n        WHEN minimum_nights = 0 THEN 1\n        ELSE minimum_nights \n    END AS minimum_nights,\n    host_id,\n    ROUND(REPLACE(price_str, '$', '')::NUMERIC, 2) as price_str,\n    created_at,\n    updated_at\nFROM src_listings", "relation_name": "\"DBT\".\"raw\".\"dim_listings_cleansed\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.602680Z", "completed_at": "2025-02-02T21:18:08.629546Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.629546Z", "completed_at": "2025-02-02T21:18:08.630506Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02808094024658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.fct_reviews", "compiled": true, "compiled_code": "\n\nWITH src_reviews AS (\n  SELECT * FROM \"DBT\".\"raw\".\"src_reviews\"\n)\nSELECT \n  md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,\n  *\nFROM src_reviews\nWHERE review_text is not null\n\n  \n    AND review_date > (select max(review_date) from \"DBT\".\"raw\".\"fct_reviews\")\n    \n  \n", "relation_name": "\"DBT\".\"raw\".\"fct_reviews\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.632013Z", "completed_at": "2025-02-02T21:18:08.637770Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.638769Z", "completed_at": "2025-02-02T21:18:08.638769Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00826263427734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_listings_w_hosts", "compiled": true, "compiled_code": "\n\nWITH    \nl As (\n    select * from \"DBT\".\"raw\".\"dim_listings_cleansed\"\n),\nh as (select * from \"DBT\".\"raw\".\"dim_hosts_cleansed\")\n\nselect \n    l.listing_id,\n    l.listing_name,\n    l.room_type,\n    l.minimum_nights,\n    l.price_str,\n    l.host_id,\n    h.NAME,\n    h.IS_SUPERHOST as host_is_superhost,\n    l.created_at,\n    GREATEST (l.updated_at,h.updated_at) as update_at\n    from l   \n    left join h on (h.host_id = l.host_id)", "relation_name": "\"DBT\".\"raw\".\"dim_listings_w_hosts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.641524Z", "completed_at": "2025-02-02T21:18:08.647462Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.648461Z", "completed_at": "2025-02-02T21:18:08.648461Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009691953659057617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.dim_listings_minimum_nights", "compiled": true, "compiled_code": "SELECT\n    *\nFROM\n    \"DBT\".\"raw\".\"dim_listings_cleansed\"\nWHERE minimum_nights < 1\nLIMIT 10", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.651684Z", "completed_at": "2025-02-02T21:18:08.923853Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.923853Z", "completed_at": "2025-02-02T21:18:08.923853Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2800173759460449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.no_nulls_in_dim_listings", "compiled": true, "compiled_code": "\n    SELECT * FROM \"DBT\".\"raw\".\"dim_listings_cleansed\" WHERE\n    listing_id IS NULL OR\n    listing_name IS NULL OR\n    room_type IS NULL OR\n    minimum_nights IS NULL OR\n    host_id IS NULL OR\n    price_str IS NULL OR\n    created_at IS NULL OR\n    updated_at IS NULL OR\n    \n    FALSE\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.936241Z", "completed_at": "2025-02-02T21:18:08.960364Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.962930Z", "completed_at": "2025-02-02T21:18:08.962930Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028720378875732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom \"DBT\".\"raw\".\"dim_listings_cleansed\"\nwhere host_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.967371Z", "completed_at": "2025-02-02T21:18:08.968415Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.976585Z", "completed_at": "2025-02-02T21:18:08.976585Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011104583740234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom \"DBT\".\"raw\".\"dim_listings_cleansed\"\nwhere listing_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.980106Z", "completed_at": "2025-02-02T21:18:08.990552Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:08.991549Z", "completed_at": "2025-02-02T21:18:08.991549Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012840986251831055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select host_id as from_field\n    from \"DBT\".\"raw\".\"dim_listings_cleansed\"\n    where host_id is not null\n),\n\nparent as (\n    select host_id as to_field\n    from \"DBT\".\"raw\".\"dim_hosts_cleansed\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:08.993379Z", "completed_at": "2025-02-02T21:18:09.001337Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:09.002336Z", "completed_at": "2025-02-02T21:18:09.002336Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010011434555053711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    listing_id as unique_field,\n    count(*) as n_records\n\nfrom \"DBT\".\"raw\".\"dim_listings_cleansed\"\nwhere listing_id is not null\ngroup by listing_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:09.003720Z", "completed_at": "2025-02-02T21:18:09.010185Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:09.011182Z", "completed_at": "2025-02-02T21:18:09.011182Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007791280746459961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.mart_fullmoon_reviews", "compiled": true, "compiled_code": "\nWITH fct_reviews AS (\n    select * from \"DBT\".\"raw\".\"fct_reviews\"\n),\nfull_moon_dates AS (\n    select * from \"DBT\".\"raw\".\"seed_full_moon_dates\"\n)\nselect r.*,\ncase\nwhen fm.full_moon_date IS NULL THEN 'not full moon'\nelse 'full moon'\nEND AS is_full_moon\nfrom\nfct_reviews r\nleft join full_moon_dates fm \n--on (TO_DATE(r.review_date) = DATEADD(DAY,1, fm.full_moon_date))\nON (r.review_date::date = fm.full_moon_date + INTERVAL '1 day')", "relation_name": "\"DBT\".\"raw\".\"mart_fullmoon_reviews\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:09.012845Z", "completed_at": "2025-02-02T21:18:09.016549Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:09.017547Z", "completed_at": "2025-02-02T21:18:09.017547Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006129264831542969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.consistent_created_at", "compiled": true, "compiled_code": "SELECT * FROM \"DBT\".\"raw\".\"dim_listings_cleansed\" l\nINNER JOIN \"DBT\".\"raw\".\"fct_reviews\" r\nUSING (listing_id)\nWHERE l.created_at >= r.review_date", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-02T21:18:09.018808Z", "completed_at": "2025-02-02T21:18:09.019805Z"}, {"name": "execute", "started_at": "2025-02-02T21:18:09.019805Z", "completed_at": "2025-02-02T21:18:09.019805Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001260995864868164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbtlearn.full_moon_no_sleep", "compiled": true, "compiled_code": "WITH fullmoon_reviews AS (\n    SELECT * FROM \"DBT\".\"raw\".\"mart_fullmoon_reviews\"\n)\nSELECT\n    is_full_moon,\n    review_sentiment,\n    COUNT(*) as reviews\nFROM\n    fullmoon_reviews\nGROUP BY\n    is_full_moon,\n    review_sentiment\nORDER BY\n    is_full_moon,\n    review_sentiment", "relation_name": null, "batch_results": null}], "elapsed_time": 0.834122896194458, "args": {"partial_parse": true, "printer_width": 80, "defer": false, "indirect_selection": "eager", "quiet": false, "empty_catalog": false, "state_modified_compare_vars": false, "partial_parse_file_diff": true, "introspect": true, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": false, "use_colors_file": true, "favor_state": false, "write_json": true, "profiles_dir": "C:\\Users\\admin\\.dbt", "populate_cache": true, "invocation_command": "dbt docs generate", "exclude": [], "send_anonymous_usage_stats": true, "print": true, "warn_error_options": {"include": [], "exclude": []}, "use_colors": true, "which": "generate", "macro_debugging": false, "require_batched_execution_for_custom_microbatch_strategy": false, "static_parser": true, "log_format_file": "debug", "log_path": "C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs", "require_nested_cumulative_type_params": false, "skip_nodes_if_on_run_start_fails": false, "log_level": "info", "show_resource_report": false, "require_yaml_configuration_for_mf_time_spines": false, "require_resource_names_without_spaces": false, "compile": true, "strict_mode": false, "cache_selected_only": false, "project_dir": "C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn", "log_file_max_bytes": 10485760, "log_level_file": "debug", "select": [], "state_modified_compare_more_unrendered_values": false, "version_check": true, "vars": {}, "static": false}}