[0m18:03:15.325930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002504AAF3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002504AAF1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002504AAF2BD0>]}


============================== 18:03:15.331932 | 97a59881-4637-46a8-99bb-5501cc67574a ==============================
[0m18:03:15.331932 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:03:15.332940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:03:15.358028 [info ] [MainThread]: dbt version: 1.9.1
[0m18:03:15.358875 [info ] [MainThread]: python version: 3.12.6
[0m18:03:15.360171 [info ] [MainThread]: python path: C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\env\Scripts\python.exe
[0m18:03:15.360838 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m18:03:15.503378 [info ] [MainThread]: Using profiles dir at C:\Users\admin\.dbt
[0m18:03:15.504375 [info ] [MainThread]: Using profiles.yml file at C:\Users\admin\.dbt\profiles.yml
[0m18:03:15.505372 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\dbt_project.yml
[0m18:03:15.507369 [info ] [MainThread]: adapter type: postgres
[0m18:03:15.510360 [info ] [MainThread]: adapter version: 1.9.0
[0m18:03:15.655999 [info ] [MainThread]: Configuration:
[0m18:03:15.657157 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:03:15.657964 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:03:15.657964 [info ] [MainThread]: Required dependencies:
[0m18:03:15.659070 [debug] [MainThread]: Executing "git --help"
[0m18:03:15.726483 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:03:15.728481 [debug] [MainThread]: STDERR: "b''"
[0m18:03:15.729476 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:03:15.731287 [info ] [MainThread]: Connection:
[0m18:03:15.733285 [info ] [MainThread]:   host: localhost
[0m18:03:15.734500 [info ] [MainThread]:   port: 5432
[0m18:03:15.735975 [info ] [MainThread]:   user: postgres
[0m18:03:15.736398 [info ] [MainThread]:   database: DBT
[0m18:03:15.738517 [info ] [MainThread]:   schema: dbtraw
[0m18:03:15.739349 [info ] [MainThread]:   connect_timeout: 10
[0m18:03:15.740347 [info ] [MainThread]:   role: None
[0m18:03:15.741343 [info ] [MainThread]:   search_path: None
[0m18:03:15.743343 [info ] [MainThread]:   keepalives_idle: 0
[0m18:03:15.744335 [info ] [MainThread]:   sslmode: None
[0m18:03:15.745333 [info ] [MainThread]:   sslcert: None
[0m18:03:15.747358 [info ] [MainThread]:   sslkey: None
[0m18:03:15.747358 [info ] [MainThread]:   sslrootcert: None
[0m18:03:15.748325 [info ] [MainThread]:   application_name: dbt
[0m18:03:15.749349 [info ] [MainThread]:   retries: 1
[0m18:03:15.750320 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:03:15.977710 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:03:20.312827 [debug] [MainThread]: Using postgres connection "debug"
[0m18:03:20.313824 [debug] [MainThread]: On debug: select 1 as id
[0m18:03:20.313824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:20.482578 [debug] [MainThread]: SQL status: SELECT 1 in 0.168 seconds
[0m18:03:20.483403 [debug] [MainThread]: On debug: Close
[0m18:03:20.484367 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:03:20.485375 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:03:20.487359 [debug] [MainThread]: Command `dbt debug` succeeded at 18:03:20.486362 after 5.34 seconds
[0m18:03:20.487359 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:03:20.488356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025049FD3FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025048639A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025049FFC4A0>]}
[0m18:03:20.488356 [debug] [MainThread]: Flushing usage events
[0m18:03:21.088752 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:38.937211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35781B380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35781A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F357819460>]}


============================== 18:03:38.941890 | 47b80d9b-d8f1-47d7-8ebe-05189792f48c ==============================
[0m18:03:38.941890 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:03:38.941890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m src_hosts', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:03:39.177779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47b80d9b-d8f1-47d7-8ebe-05189792f48c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F357837C50>]}
[0m18:03:39.250258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47b80d9b-d8f1-47d7-8ebe-05189792f48c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F356D88A40>]}
[0m18:03:39.251858 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:03:39.456589 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m18:03:39.458555 [debug] [MainThread]: Command `dbt run` failed at 18:03:39.458555 after 0.67 seconds
[0m18:03:39.458555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3574DD430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3576CE0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F357819610>]}
[0m18:03:39.459582 [debug] [MainThread]: Flushing usage events
[0m18:03:39.970590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:50.991889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB606B9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5F1D8740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB61F3C620>]}


============================== 18:03:50.995836 | d09333cc-9a03-4d7d-aee2-bdcb553c76e4 ==============================
[0m18:03:50.995836 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:03:50.997055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:03:51.135305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd09333cc-9a03-4d7d-aee2-bdcb553c76e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB62922900>]}
[0m18:03:51.172947 [debug] [MainThread]: Set downloads directory='C:\Users\admin\AppData\Local\Temp\dbt-downloads-yfn0vy47'
[0m18:03:51.173923 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:03:51.278791 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:03:51.281451 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:03:51.347228 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:03:51.373830 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m18:03:51.436855 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m18:03:51.441842 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m18:03:51.509404 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m18:03:51.544302 [info ] [MainThread]: Updating lock file in file path: C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn/package-lock.yml
[0m18:03:51.559237 [debug] [MainThread]: Set downloads directory='C:\Users\admin\AppData\Local\Temp\dbt-downloads-fz_cqbk4'
[0m18:03:51.569210 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:03:52.120527 [info ] [MainThread]: Installed from version 1.3.0
[0m18:03:52.121475 [info ] [MainThread]: Up to date!
[0m18:03:52.122433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd09333cc-9a03-4d7d-aee2-bdcb553c76e4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB6295F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB62B076E0>]}
[0m18:03:52.123433 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m18:03:53.171522 [info ] [MainThread]: Installed from version 0.10.1
[0m18:03:53.172170 [info ] [MainThread]: Updated version available: 0.10.4
[0m18:03:53.172170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd09333cc-9a03-4d7d-aee2-bdcb553c76e4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB62F2B8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB62F2B680>]}
[0m18:03:53.173168 [info ] [MainThread]: Installing calogica/dbt_date
[0m18:03:53.541145 [info ] [MainThread]: Installed from version 0.10.1
[0m18:03:53.541372 [info ] [MainThread]: Up to date!
[0m18:03:53.542371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd09333cc-9a03-4d7d-aee2-bdcb553c76e4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB62F4FCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB62F4F980>]}
[0m18:03:53.543400 [info ] [MainThread]: 
[0m18:03:53.544365 [info ] [MainThread]: Updates available for packages: ['calogica/dbt_expectations']                 
Update your versions in packages.yml, then run dbt deps
[0m18:03:53.548354 [debug] [MainThread]: Command `dbt deps` succeeded at 18:03:53.548354 after 2.71 seconds
[0m18:03:53.549351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB624902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB62493500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB61E5A2A0>]}
[0m18:03:53.549351 [debug] [MainThread]: Flushing usage events
[0m18:03:54.030703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:00.027181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527811B3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015277678B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015278119FA0>]}


============================== 18:04:00.032247 | 4e1cc7d7-5209-4c53-a447-d3a0ca065bf1 ==============================
[0m18:04:00.032247 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:04:00.034188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m src_hosts', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:04:00.249755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e1cc7d7-5209-4c53-a447-d3a0ca065bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152754CD850>]}
[0m18:04:00.317606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e1cc7d7-5209-4c53-a447-d3a0ca065bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527816DF70>]}
[0m18:04:00.319120 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:04:00.597551 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:04:00.598562 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:04:00.599613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e1cc7d7-5209-4c53-a447-d3a0ca065bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015278272C00>]}
[0m18:04:07.570297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e1cc7d7-5209-4c53-a447-d3a0ca065bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152770C4890>]}
[0m18:04:07.731179 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:04:07.755118 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:04:07.792922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e1cc7d7-5209-4c53-a447-d3a0ca065bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015279D2FAD0>]}
[0m18:04:07.792922 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 3 sources, 1 exposure, 813 macros
[0m18:04:07.793919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e1cc7d7-5209-4c53-a447-d3a0ca065bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015279CB94F0>]}
[0m18:04:07.795913 [info ] [MainThread]: 
[0m18:04:07.796488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:07.796941 [info ] [MainThread]: 
[0m18:04:07.797908 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:07.802416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_dbtraw'
[0m18:04:07.894194 [debug] [ThreadPool]: Using postgres connection "list_DBT_dbtraw"
[0m18:04:07.895220 [debug] [ThreadPool]: On list_DBT_dbtraw: BEGIN
[0m18:04:07.895220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:07.937579 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m18:04:07.938576 [debug] [ThreadPool]: Using postgres connection "list_DBT_dbtraw"
[0m18:04:07.938576 [debug] [ThreadPool]: On list_DBT_dbtraw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_dbtraw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtraw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtraw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbtraw'
  
[0m18:04:07.954312 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.015 seconds
[0m18:04:07.957310 [debug] [ThreadPool]: On list_DBT_dbtraw: ROLLBACK
[0m18:04:07.957910 [debug] [ThreadPool]: On list_DBT_dbtraw: Close
[0m18:04:07.957910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_dbtraw, now list_DBT_DEV)
[0m18:04:07.964794 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:04:07.964794 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:04:07.964794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:08.148200 [debug] [ThreadPool]: SQL status: BEGIN in 0.183 seconds
[0m18:04:08.149238 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:04:08.149238 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:04:08.162193 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m18:04:08.165189 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:04:08.166151 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:04:08.174133 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:08.175130 [debug] [MainThread]: On master: BEGIN
[0m18:04:08.175714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:08.211031 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m18:04:08.211031 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:08.212028 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:04:08.221102 [debug] [MainThread]: SQL status: SELECT 3 in 0.009 seconds
[0m18:04:08.224028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e1cc7d7-5209-4c53-a447-d3a0ca065bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527873D100>]}
[0m18:04:08.224028 [debug] [MainThread]: On master: ROLLBACK
[0m18:04:08.224961 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:08.224961 [debug] [MainThread]: On master: BEGIN
[0m18:04:08.225961 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:04:08.225961 [debug] [MainThread]: On master: COMMIT
[0m18:04:08.226995 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:08.227990 [debug] [MainThread]: On master: COMMIT
[0m18:04:08.227990 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:08.228953 [debug] [MainThread]: On master: Close
[0m18:04:08.230948 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m18:04:08.231975 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_hosts'
[0m18:04:08.231975 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m18:04:08.240958 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m18:04:08.243930 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m18:04:08.245908 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:08.245908 [debug] [MainThread]: On master: BEGIN
[0m18:04:08.246906 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:08.281326 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m18:04:08.281326 [debug] [MainThread]: On master: COMMIT
[0m18:04:08.282360 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:08.282360 [debug] [MainThread]: On master: COMMIT
[0m18:04:08.283128 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:08.283128 [debug] [MainThread]: On master: Close
[0m18:04:08.283128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:08.284128 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m18:04:08.284128 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m18:04:08.284128 [info ] [MainThread]: 
[0m18:04:08.285125 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m18:04:08.286124 [debug] [MainThread]: Command end result
[0m18:04:08.349068 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:04:08.351633 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:04:08.355067 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:04:08.355589 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:08.355589 after 8.53 seconds
[0m18:04:08.356617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015277C53FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527780AB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152778098E0>]}
[0m18:04:08.356617 [debug] [MainThread]: Flushing usage events
[0m18:04:08.924535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:52.164640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D2AFCFC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D2AFCF110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D2AFCF920>]}


============================== 18:04:52.169652 | 45eabca5-933f-4d67-85b4-1bbbe793125c ==============================
[0m18:04:52.169652 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:04:52.170622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m src_hosts', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:04:52.382929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45eabca5-933f-4d67-85b4-1bbbe793125c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D2B18CE60>]}
[0m18:04:52.448887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45eabca5-933f-4d67-85b4-1bbbe793125c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D2B123C80>]}
[0m18:04:52.450353 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:04:52.687064 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:04:52.880067 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:04:52.881445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '45eabca5-933f-4d67-85b4-1bbbe793125c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D2AB39A30>]}
[0m18:04:55.839007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45eabca5-933f-4d67-85b4-1bbbe793125c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D2C81D9A0>]}
[0m18:04:55.995876 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:04:55.999963 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:04:56.032735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45eabca5-933f-4d67-85b4-1bbbe793125c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D2C78D820>]}
[0m18:04:56.033482 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 3 sources, 1 exposure, 813 macros
[0m18:04:56.034476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45eabca5-933f-4d67-85b4-1bbbe793125c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D2C7A0C20>]}
[0m18:04:56.035497 [info ] [MainThread]: 
[0m18:04:56.036837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:56.037497 [info ] [MainThread]: 
[0m18:04:56.038466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:56.039475 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:04:56.118997 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:04:56.118997 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:04:56.120068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:56.298269 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.178 seconds
[0m18:04:56.299997 [debug] [ThreadPool]: On list_DBT: Close
[0m18:04:56.308016 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m18:04:56.317933 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:04:56.318943 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:04:56.318943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:56.488756 [debug] [ThreadPool]: SQL status: BEGIN in 0.170 seconds
[0m18:04:56.489722 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:04:56.490691 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:04:56.499666 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m18:04:56.501691 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:04:56.502688 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:04:56.503688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_dbtraw)
[0m18:04:56.507675 [debug] [ThreadPool]: Using postgres connection "list_DBT_dbtraw"
[0m18:04:56.508675 [debug] [ThreadPool]: On list_DBT_dbtraw: BEGIN
[0m18:04:56.508675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:56.669880 [debug] [ThreadPool]: SQL status: BEGIN in 0.161 seconds
[0m18:04:56.669880 [debug] [ThreadPool]: Using postgres connection "list_DBT_dbtraw"
[0m18:04:56.670835 [debug] [ThreadPool]: On list_DBT_dbtraw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_dbtraw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtraw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtraw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbtraw'
  
[0m18:04:56.681721 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.010 seconds
[0m18:04:56.683747 [debug] [ThreadPool]: On list_DBT_dbtraw: ROLLBACK
[0m18:04:56.685407 [debug] [ThreadPool]: On list_DBT_dbtraw: Close
[0m18:04:56.697678 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:56.698676 [debug] [MainThread]: On master: BEGIN
[0m18:04:56.698676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:56.737212 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m18:04:56.738021 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:56.738021 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:04:56.747705 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m18:04:56.750659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45eabca5-933f-4d67-85b4-1bbbe793125c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D2C77B4A0>]}
[0m18:04:56.750659 [debug] [MainThread]: On master: ROLLBACK
[0m18:04:56.751811 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:56.751811 [debug] [MainThread]: On master: BEGIN
[0m18:04:56.752655 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:04:56.752655 [debug] [MainThread]: On master: COMMIT
[0m18:04:56.752655 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:56.753677 [debug] [MainThread]: On master: COMMIT
[0m18:04:56.754265 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:56.754650 [debug] [MainThread]: On master: Close
[0m18:04:56.756643 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m18:04:56.756643 [info ] [Thread-1 (]: 1 of 1 START sql table model dbtraw.src_hosts .................................. [RUN]
[0m18:04:56.757839 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_hosts'
[0m18:04:56.757839 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m18:04:56.767613 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m18:04:56.767613 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m18:04:56.816484 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m18:04:56.819476 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:04:56.820117 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: BEGIN
[0m18:04:56.820473 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:56.855626 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m18:04:56.856376 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:04:56.856376 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */

  
    

  create  table "DBT"."dbtraw"."src_hosts__dbt_tmp"
  
  
    as
  
  (
    WITH raw_hosts AS (
    SELECT
        *
    FROM
       "DBT"."raw"."raw_hosts"
)
SELECT
    id AS host_id,
    NAME AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
  
[0m18:04:56.871364 [debug] [Thread-1 (]: SQL status: SELECT 14111 in 0.014 seconds
[0m18:04:56.880312 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:04:56.880312 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
alter table "DBT"."dbtraw"."src_hosts" rename to "src_hosts__dbt_backup"
[0m18:04:56.881310 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:56.884301 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:04:56.885299 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
alter table "DBT"."dbtraw"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m18:04:56.885299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:56.891283 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:04:56.891283 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */

        GRANT SELECT ON "DBT"."dbtraw"."src_hosts" TO ROLE REPORTER
      
[0m18:04:56.900333 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "REPORTER"
LINE 3: ... GRANT SELECT ON "DBT"."dbtraw"."src_hosts" TO ROLE REPORTER
                                                               ^

[0m18:04:56.900333 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: ROLLBACK
[0m18:04:56.901593 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m18:04:56.919234 [debug] [Thread-1 (]: Database Error in model src_hosts (models\src\src_hosts.sql)
  syntax error at or near "REPORTER"
  LINE 3: ... GRANT SELECT ON "DBT"."dbtraw"."src_hosts" TO ROLE REPORTER
                                                                 ^
  compiled code at target\run\dbtlearn\models\src\src_hosts.sql
[0m18:04:56.921589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45eabca5-933f-4d67-85b4-1bbbe793125c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D2D1B87A0>]}
[0m18:04:56.922225 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbtraw.src_hosts ......................... [[31mERROR[0m in 0.16s]
[0m18:04:56.923479 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m18:04:56.924195 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.src_hosts' to be skipped because of status 'error'.  Reason: Database Error in model src_hosts (models\src\src_hosts.sql)
  syntax error at or near "REPORTER"
  LINE 3: ... GRANT SELECT ON "DBT"."dbtraw"."src_hosts" TO ROLE REPORTER
                                                                 ^
  compiled code at target\run\dbtlearn\models\src\src_hosts.sql.
[0m18:04:56.926190 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:56.926190 [debug] [MainThread]: On master: BEGIN
[0m18:04:56.927212 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:56.973064 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m18:04:56.974093 [debug] [MainThread]: On master: COMMIT
[0m18:04:56.974093 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:56.975060 [debug] [MainThread]: On master: COMMIT
[0m18:04:56.975410 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:56.976056 [debug] [MainThread]: On master: Close
[0m18:04:56.976056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:56.977054 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:04:56.977054 [debug] [MainThread]: Connection 'list_DBT_dbtraw' was properly closed.
[0m18:04:56.978052 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m18:04:56.978052 [info ] [MainThread]: 
[0m18:04:56.979050 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m18:04:56.980047 [debug] [MainThread]: Command end result
[0m18:04:57.055970 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:04:57.058963 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:04:57.068936 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:04:57.069933 [info ] [MainThread]: 
[0m18:04:57.070078 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:04:57.070931 [info ] [MainThread]: 
[0m18:04:57.071928 [error] [MainThread]:   Database Error in model src_hosts (models\src\src_hosts.sql)
  syntax error at or near "REPORTER"
  LINE 3: ... GRANT SELECT ON "DBT"."dbtraw"."src_hosts" TO ROLE REPORTER
                                                                 ^
  compiled code at target\run\dbtlearn\models\src\src_hosts.sql
[0m18:04:57.071928 [info ] [MainThread]: 
[0m18:04:57.072926 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:04:57.074716 [debug] [MainThread]: Command `dbt run` failed at 18:04:57.073923 after 5.08 seconds
[0m18:04:57.074919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D2AD9D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D28D99250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D28D99160>]}
[0m18:04:57.075916 [debug] [MainThread]: Flushing usage events
[0m18:04:57.655106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:11.212995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF526D2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF53CFD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF526F500>]}


============================== 18:06:11.216983 | 2b7d75b2-d346-44d1-a095-fe67b6884534 ==============================
[0m18:06:11.216983 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:06:11.218151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m src_hosts', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:11.428661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b7d75b2-d346-44d1-a095-fe67b6884534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF58DB770>]}
[0m18:06:11.495004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b7d75b2-d346-44d1-a095-fe67b6884534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF575C200>]}
[0m18:06:11.497064 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:06:11.732444 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:06:11.920962 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:06:11.922042 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:06:11.922042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b7d75b2-d346-44d1-a095-fe67b6884534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF6D68620>]}
[0m18:06:14.893335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b7d75b2-d346-44d1-a095-fe67b6884534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF7479220>]}
[0m18:06:15.047923 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:06:15.050933 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:06:15.084136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b7d75b2-d346-44d1-a095-fe67b6884534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF7334380>]}
[0m18:06:15.085134 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 3 sources, 1 exposure, 813 macros
[0m18:06:15.085134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b7d75b2-d346-44d1-a095-fe67b6884534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF72EAD80>]}
[0m18:06:15.087160 [info ] [MainThread]: 
[0m18:06:15.088255 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:15.089124 [info ] [MainThread]: 
[0m18:06:15.089639 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:06:15.090843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:06:15.169007 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:06:15.169898 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:06:15.169898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:15.206980 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.037 seconds
[0m18:06:15.207979 [debug] [ThreadPool]: On list_DBT: Close
[0m18:06:15.213625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m18:06:15.221606 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:06:15.221606 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:06:15.222603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:15.260319 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m18:06:15.260319 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:06:15.261283 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:06:15.268034 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m18:06:15.269999 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:06:15.270528 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:06:15.270528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_raw, now list_DBT_DEV)
[0m18:06:15.274123 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:06:15.274542 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:06:15.274542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:15.306424 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m18:06:15.306424 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:06:15.307422 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:06:15.313438 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:06:15.314403 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:06:15.315763 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:06:15.320712 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:15.320712 [debug] [MainThread]: On master: BEGIN
[0m18:06:15.321710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:15.353456 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m18:06:15.354376 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:15.354376 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:06:15.362672 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m18:06:15.364702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b7d75b2-d346-44d1-a095-fe67b6884534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF72D0D10>]}
[0m18:06:15.364702 [debug] [MainThread]: On master: ROLLBACK
[0m18:06:15.365698 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:15.365698 [debug] [MainThread]: On master: BEGIN
[0m18:06:15.366736 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:06:15.366736 [debug] [MainThread]: On master: COMMIT
[0m18:06:15.367691 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:15.367691 [debug] [MainThread]: On master: COMMIT
[0m18:06:15.367691 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:06:15.368688 [debug] [MainThread]: On master: Close
[0m18:06:15.370195 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m18:06:15.371228 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.src_hosts ..................................... [RUN]
[0m18:06:15.372190 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_hosts'
[0m18:06:15.372190 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m18:06:15.380200 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m18:06:15.381197 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m18:06:15.423086 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m18:06:15.424087 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:06:15.425050 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: BEGIN
[0m18:06:15.425050 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:15.463418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m18:06:15.463418 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:06:15.464448 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */

  
    

  create  table "DBT"."raw"."src_hosts__dbt_tmp"
  
  
    as
  
  (
    WITH raw_hosts AS (
    SELECT
        *
    FROM
       "DBT"."raw"."raw_hosts"
)
SELECT
    id AS host_id,
    NAME AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
  
[0m18:06:15.475989 [debug] [Thread-1 (]: SQL status: SELECT 14111 in 0.011 seconds
[0m18:06:15.482969 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:06:15.483967 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
alter table "DBT"."raw"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m18:06:15.485041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:06:15.502915 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: COMMIT
[0m18:06:15.502915 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:06:15.503915 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: COMMIT
[0m18:06:15.509437 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:06:15.517258 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."src_hosts__dbt_backup"
[0m18:06:15.522245 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:06:15.522245 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
drop table if exists "DBT"."raw"."src_hosts__dbt_backup" cascade
[0m18:06:15.524817 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:06:15.526844 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m18:06:15.530200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b7d75b2-d346-44d1-a095-fe67b6884534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF2ABCAD0>]}
[0m18:06:15.530827 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.src_hosts ................................ [[32mSELECT 14111[0m in 0.16s]
[0m18:06:15.531797 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m18:06:15.532893 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:15.533906 [debug] [MainThread]: On master: BEGIN
[0m18:06:15.533906 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:15.574341 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m18:06:15.575123 [debug] [MainThread]: On master: COMMIT
[0m18:06:15.575123 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:15.576116 [debug] [MainThread]: On master: COMMIT
[0m18:06:15.576694 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:06:15.577112 [debug] [MainThread]: On master: Close
[0m18:06:15.577112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:15.577112 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:06:15.578078 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m18:06:15.578078 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m18:06:15.579077 [info ] [MainThread]: 
[0m18:06:15.580077 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m18:06:15.581070 [debug] [MainThread]: Command end result
[0m18:06:15.627725 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:06:15.632862 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:06:15.639352 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:06:15.639352 [info ] [MainThread]: 
[0m18:06:15.640356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:15.640356 [info ] [MainThread]: 
[0m18:06:15.641542 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:06:15.642345 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:15.642345 after 4.59 seconds
[0m18:06:15.642345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF516F9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF2A694C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF20BD790>]}
[0m18:06:15.643366 [debug] [MainThread]: Flushing usage events
[0m18:06:16.124393 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:40.279769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF782EF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF782EFBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF782EFFB0>]}


============================== 18:06:40.284786 | 0ea5dbc4-210e-404f-8150-9ae858042db9 ==============================
[0m18:06:40.284786 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:06:40.285752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m src_listings', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:06:40.493803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ea5dbc4-210e-404f-8150-9ae858042db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF784CD670>]}
[0m18:06:40.557632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ea5dbc4-210e-404f-8150-9ae858042db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF77B8EEA0>]}
[0m18:06:40.559592 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:06:40.790007 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:06:41.115750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:41.116663 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:41.210419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ea5dbc4-210e-404f-8150-9ae858042db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7855DD90>]}
[0m18:06:41.369749 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:06:41.373287 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:06:41.403433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ea5dbc4-210e-404f-8150-9ae858042db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF785D9760>]}
[0m18:06:41.404464 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 3 sources, 1 exposure, 813 macros
[0m18:06:41.405041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ea5dbc4-210e-404f-8150-9ae858042db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF78724D40>]}
[0m18:06:41.406425 [info ] [MainThread]: 
[0m18:06:41.407515 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:41.407515 [info ] [MainThread]: 
[0m18:06:41.408446 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:06:41.409443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:06:41.489235 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:06:41.490232 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:06:41.490232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:41.529099 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.038 seconds
[0m18:06:41.530059 [debug] [ThreadPool]: On list_DBT: Close
[0m18:06:41.535046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m18:06:41.541996 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:06:41.541996 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:06:41.543025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:41.579578 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m18:06:41.580344 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:06:41.580344 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:06:41.588060 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m18:06:41.589091 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:06:41.590058 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:06:41.590058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m18:06:41.593079 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:06:41.593674 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:06:41.593674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:41.626812 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m18:06:41.626812 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:06:41.627775 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:06:41.634423 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m18:06:41.636418 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:06:41.637015 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:06:41.644367 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:41.645401 [debug] [MainThread]: On master: BEGIN
[0m18:06:41.645839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:41.677453 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m18:06:41.677453 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:41.678496 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:06:41.686341 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m18:06:41.688337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ea5dbc4-210e-404f-8150-9ae858042db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF75E92C60>]}
[0m18:06:41.688337 [debug] [MainThread]: On master: ROLLBACK
[0m18:06:41.689298 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:41.689298 [debug] [MainThread]: On master: BEGIN
[0m18:06:41.690295 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:06:41.690295 [debug] [MainThread]: On master: COMMIT
[0m18:06:41.690295 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:41.691294 [debug] [MainThread]: On master: COMMIT
[0m18:06:41.691833 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:06:41.691833 [debug] [MainThread]: On master: Close
[0m18:06:41.693783 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m18:06:41.694811 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.src_listings .................................. [RUN]
[0m18:06:41.695779 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_listings'
[0m18:06:41.695779 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m18:06:41.703788 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m18:06:41.704954 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m18:06:41.748668 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m18:06:41.749633 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_listings"
[0m18:06:41.749633 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: BEGIN
[0m18:06:41.750661 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:41.919782 [debug] [Thread-1 (]: SQL status: BEGIN in 0.169 seconds
[0m18:06:41.920700 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_listings"
[0m18:06:41.920700 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */

  
    

  create  table "DBT"."raw"."src_listings__dbt_tmp"
  
  
    as
  
  (
    -- import raw_listings
WITH raw_listings AS (
        SELECT * FROM "DBT"."raw"."raw_listings"
)
SELECT 
   id AS listing_id,
   listing_url,
   name AS listing_name,
   room_type,
   minimum_nights,
   host_id,
   price AS price_str,
   created_at,
   updated_at
FROM raw_listings
  );
  
[0m18:06:41.948983 [debug] [Thread-1 (]: SQL status: SELECT 17499 in 0.028 seconds
[0m18:06:41.958106 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_listings"
[0m18:06:41.958986 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
alter table "DBT"."raw"."src_listings__dbt_tmp" rename to "src_listings"
[0m18:06:41.959953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:06:41.979933 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: COMMIT
[0m18:06:41.979933 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_listings"
[0m18:06:41.979933 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: COMMIT
[0m18:06:42.009481 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m18:06:42.023035 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."src_listings__dbt_backup"
[0m18:06:42.031012 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_listings"
[0m18:06:42.031012 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
drop table if exists "DBT"."raw"."src_listings__dbt_backup" cascade
[0m18:06:42.032009 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:06:42.035997 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m18:06:42.038961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ea5dbc4-210e-404f-8150-9ae858042db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF756AC800>]}
[0m18:06:42.039958 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.src_listings ............................. [[32mSELECT 17499[0m in 0.34s]
[0m18:06:42.040955 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m18:06:42.041953 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:42.042978 [debug] [MainThread]: On master: BEGIN
[0m18:06:42.042978 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:42.081743 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m18:06:42.081743 [debug] [MainThread]: On master: COMMIT
[0m18:06:42.081743 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:42.082742 [debug] [MainThread]: On master: COMMIT
[0m18:06:42.083322 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:06:42.083738 [debug] [MainThread]: On master: Close
[0m18:06:42.083738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:42.083738 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:06:42.084704 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m18:06:42.084704 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m18:06:42.084704 [info ] [MainThread]: 
[0m18:06:42.085951 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m18:06:42.086699 [debug] [MainThread]: Command end result
[0m18:06:42.127627 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:06:42.131613 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:06:42.139559 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:06:42.139559 [info ] [MainThread]: 
[0m18:06:42.140700 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:42.141588 [info ] [MainThread]: 
[0m18:06:42.142155 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:06:42.143546 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:42.143546 after 2.01 seconds
[0m18:06:42.143546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF77F0F260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF77A985C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF782CF680>]}
[0m18:06:42.143546 [debug] [MainThread]: Flushing usage events
[0m18:06:42.611602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:02.766823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24CBA1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24CBA1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24CBA2180>]}


============================== 18:31:02.770810 | 589aaad1-9421-415c-b6a4-0898efcfa668 ==============================
[0m18:31:02.770810 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:31:02.771979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m18:31:02.793872 [info ] [MainThread]: dbt version: 1.9.1
[0m18:31:02.795293 [info ] [MainThread]: python version: 3.12.6
[0m18:31:02.795873 [info ] [MainThread]: python path: C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\env\Scripts\python.exe
[0m18:31:02.796867 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m18:31:02.890243 [info ] [MainThread]: Using profiles dir at C:\Users\admin\.dbt
[0m18:31:02.890826 [info ] [MainThread]: Using profiles.yml file at C:\Users\admin\.dbt\profiles.yml
[0m18:31:02.891790 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\dbt_project.yml
[0m18:31:02.892787 [info ] [MainThread]: adapter type: postgres
[0m18:31:02.893875 [info ] [MainThread]: adapter version: 1.9.0
[0m18:31:03.017462 [info ] [MainThread]: Configuration:
[0m18:31:03.018597 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:31:03.019459 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:31:03.019459 [info ] [MainThread]: Required dependencies:
[0m18:31:03.020478 [debug] [MainThread]: Executing "git --help"
[0m18:31:03.060341 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:31:03.061339 [debug] [MainThread]: STDERR: "b''"
[0m18:31:03.061339 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:31:03.062394 [info ] [MainThread]: Connection:
[0m18:31:03.063332 [info ] [MainThread]:   host: localhost
[0m18:31:03.064470 [info ] [MainThread]:   port: 5432
[0m18:31:03.065329 [info ] [MainThread]:   user: postgres
[0m18:31:03.066329 [info ] [MainThread]:   database: DBT
[0m18:31:03.067321 [info ] [MainThread]:   schema: raw
[0m18:31:03.068319 [info ] [MainThread]:   connect_timeout: 10
[0m18:31:03.068319 [info ] [MainThread]:   role: None
[0m18:31:03.069316 [info ] [MainThread]:   search_path: None
[0m18:31:03.070313 [info ] [MainThread]:   keepalives_idle: 0
[0m18:31:03.070313 [info ] [MainThread]:   sslmode: None
[0m18:31:03.071310 [info ] [MainThread]:   sslcert: None
[0m18:31:03.071310 [info ] [MainThread]:   sslkey: None
[0m18:31:03.072308 [info ] [MainThread]:   sslrootcert: None
[0m18:31:03.072308 [info ] [MainThread]:   application_name: dbt
[0m18:31:03.073304 [info ] [MainThread]:   retries: 1
[0m18:31:03.073863 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:31:03.288044 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:31:03.348768 [debug] [MainThread]: Using postgres connection "debug"
[0m18:31:03.349766 [debug] [MainThread]: On debug: select 1 as id
[0m18:31:03.349766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:03.388698 [debug] [MainThread]: SQL status: SELECT 1 in 0.039 seconds
[0m18:31:03.389498 [debug] [MainThread]: On debug: Close
[0m18:31:03.390496 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:31:03.391463 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:31:03.392477 [debug] [MainThread]: Command `dbt debug` succeeded at 18:31:03.392477 after 0.83 seconds
[0m18:31:03.392477 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:31:03.393457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24CA32F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24CEADBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24CB7DF70>]}
[0m18:31:03.393457 [debug] [MainThread]: Flushing usage events
[0m18:31:03.876217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:09.647381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAD904B950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAD904BE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAD904AC60>]}


============================== 18:32:09.652395 | b4cf649f-49f0-4ec1-992a-bfd4799ef2c2 ==============================
[0m18:32:09.652395 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:32:09.652776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m src_reviews', 'send_anonymous_usage_stats': 'True'}
[0m18:32:09.863422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4cf649f-49f0-4ec1-992a-bfd4799ef2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAD8D42750>]}
[0m18:32:09.929034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4cf649f-49f0-4ec1-992a-bfd4799ef2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAD9213B60>]}
[0m18:32:09.931046 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:32:10.163553 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:32:10.335093 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:32:10.335722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4cf649f-49f0-4ec1-992a-bfd4799ef2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EADA6A4740>]}
[0m18:32:13.315882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4cf649f-49f0-4ec1-992a-bfd4799ef2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EADAD85940>]}
[0m18:32:13.483368 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:32:13.487022 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:32:13.521806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4cf649f-49f0-4ec1-992a-bfd4799ef2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EADABE5880>]}
[0m18:32:13.522144 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:32:13.523142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4cf649f-49f0-4ec1-992a-bfd4799ef2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EADABFE4E0>]}
[0m18:32:13.525136 [info ] [MainThread]: 
[0m18:32:13.525508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:13.526458 [info ] [MainThread]: 
[0m18:32:13.526458 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:32:13.527479 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:32:13.609577 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:32:13.610574 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:32:13.610574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:13.648529 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.038 seconds
[0m18:32:13.649526 [debug] [ThreadPool]: On list_DBT: Close
[0m18:32:13.655322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m18:32:13.662305 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:32:13.662305 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:32:13.662305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:13.702087 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m18:32:13.702087 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:32:13.703111 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:32:13.710611 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m18:32:13.711611 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:32:13.712997 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:32:13.712997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_raw, now list_DBT_DEV)
[0m18:32:13.716865 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:32:13.717862 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:32:13.717862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:13.749999 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m18:32:13.749999 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:32:13.749999 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:32:13.757190 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:32:13.758187 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:32:13.758987 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:32:13.764171 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:13.764171 [debug] [MainThread]: On master: BEGIN
[0m18:32:13.765168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:32:13.797688 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m18:32:13.797688 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:13.798705 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:32:13.807194 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m18:32:13.808223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4cf649f-49f0-4ec1-992a-bfd4799ef2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EADABE5460>]}
[0m18:32:13.809221 [debug] [MainThread]: On master: ROLLBACK
[0m18:32:13.809914 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:13.809914 [debug] [MainThread]: On master: BEGIN
[0m18:32:13.810720 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:32:13.810720 [debug] [MainThread]: On master: COMMIT
[0m18:32:13.810720 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:13.811706 [debug] [MainThread]: On master: COMMIT
[0m18:32:13.811706 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:32:13.812672 [debug] [MainThread]: On master: Close
[0m18:32:13.814829 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m18:32:13.814829 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.src_reviews ................................... [RUN]
[0m18:32:13.816079 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_reviews'
[0m18:32:13.816079 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m18:32:13.824986 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m18:32:13.826677 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m18:32:13.868474 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m18:32:13.870471 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m18:32:13.870471 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: BEGIN
[0m18:32:13.870471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:32:13.903962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m18:32:13.904991 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m18:32:13.904991 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */

  
    

  create  table "DBT"."raw"."src_reviews__dbt_tmp"
  
  
    as
  
  (
    WITH raw_reviews AS (
    SELECT
        *
    FROM
        "DBT"."raw"."raw_reviews"
)
SELECT
    listing_id,
    DATE AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
  
[0m18:32:13.929265 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "date" does not exist
LINE 20:     DATE AS review_date,
             ^

[0m18:32:13.929993 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: ROLLBACK
[0m18:32:13.930979 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m18:32:13.938069 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  column "date" does not exist
  LINE 20:     DATE AS review_date,
               ^
  compiled code at target\run\dbtlearn\models\src\src_reviews.sql
[0m18:32:13.941278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4cf649f-49f0-4ec1-992a-bfd4799ef2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EADACE27B0>]}
[0m18:32:13.942263 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model raw.src_reviews .......................... [[31mERROR[0m in 0.12s]
[0m18:32:13.943488 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m18:32:13.944257 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.src_reviews' to be skipped because of status 'error'.  Reason: Database Error in model src_reviews (models\src\src_reviews.sql)
  column "date" does not exist
  LINE 20:     DATE AS review_date,
               ^
  compiled code at target\run\dbtlearn\models\src\src_reviews.sql.
[0m18:32:13.946253 [info ] [MainThread]: 
[0m18:32:13.947277 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:13.948249 [debug] [MainThread]: On master: BEGIN
[0m18:32:13.948249 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:32:13.985190 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m18:32:13.985839 [debug] [MainThread]: On master: COMMIT
[0m18:32:13.986146 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:13.986146 [debug] [MainThread]: On master: COMMIT
[0m18:32:13.987163 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:32:13.991164 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:32:13.994158 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:13.995153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.src_reviews', 'table',
'2025-01-22 17:32:09.591563+00:00',
'2025-01-22 17:32:13.817006',
'2025-01-22 17:32:13.930979'
,'error','0.12288808822631836',
'b4cf649f-49f0-4ec1-992a-bfd4799ef2c2','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m18:32:14.001849 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.006 seconds
[0m18:32:14.002877 [info ] [MainThread]: 
     
[0m18:32:14.003879 [info ] [MainThread]: ========== End Summary ==========
[0m18:32:14.004763 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:32:14.010780 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:32:14.011804 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.02s]
[0m18:32:14.012753 [debug] [MainThread]: On master: Close
[0m18:32:14.012753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:14.013880 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:32:14.013880 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m18:32:14.014738 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m18:32:14.015737 [info ] [MainThread]: 
[0m18:32:14.016731 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m18:32:14.017730 [debug] [MainThread]: Command end result
[0m18:32:14.104496 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:32:14.107271 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:32:14.114470 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:32:14.115468 [info ] [MainThread]: 
[0m18:32:14.115468 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:32:14.116465 [info ] [MainThread]: 
[0m18:32:14.117462 [error] [MainThread]:   Database Error in model src_reviews (models\src\src_reviews.sql)
  column "date" does not exist
  LINE 20:     DATE AS review_date,
               ^
  compiled code at target\run\dbtlearn\models\src\src_reviews.sql
[0m18:32:14.118460 [info ] [MainThread]: 
[0m18:32:14.118460 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:32:14.120455 [debug] [MainThread]: Command `dbt run` failed at 18:32:14.119458 after 4.62 seconds
[0m18:32:14.120455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAD877C7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EADACA5DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EADAE7EAB0>]}
[0m18:32:14.120455 [debug] [MainThread]: Flushing usage events
[0m18:32:14.666631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:12.927240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C3837FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C3836F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C38375C0>]}


============================== 18:44:12.932226 | 137f8d33-adc7-46f7-9bd7-88f258ee3cff ==============================
[0m18:44:12.932226 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:44:12.932736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m src_hosts', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:44:13.144175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '137f8d33-adc7-46f7-9bd7-88f258ee3cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C0BFD850>]}
[0m18:44:13.207225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '137f8d33-adc7-46f7-9bd7-88f258ee3cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C39E8320>]}
[0m18:44:13.209080 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:44:13.439203 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:44:13.666215 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbtlearn: sources.yml - Runtime Error
    Syntax error near line 38
    ------------------------------
    35 |     schema: dev
    36 |     tables:
    37 |       - name: src_hosts
    38 | ```[_{{{CITATION{{{_1{Defining a schema source property | dbt Developer Hub - dbt Labs](https://docs.getdbt.com/reference/resource-properties/schema)[_{{{CITATION{{{_2{Add sources to your DAG | dbt Developer Hub - dbt Labs](https://docs.getdbt.com/docs/build/sources)
    
    Raw Error:
    ------------------------------
    while scanning for the next token
    found character that cannot start any token
      in "<unicode string>", line 38, column 1
[0m18:44:13.668863 [debug] [MainThread]: Command `dbt run` failed at 18:44:13.668863 after 0.93 seconds
[0m18:44:13.669890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C372F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C4E48560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C4E485F0>]}
[0m18:44:13.669890 [debug] [MainThread]: Flushing usage events
[0m18:44:14.240699 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:11.457341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C242BB6C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C242BB6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C242BB5EB0>]}


============================== 18:50:11.462327 | 1989f66d-4108-4af4-867d-5d0610836f7d ==============================
[0m18:50:11.462327 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:50:11.462741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m src_hosts', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:50:11.669717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1989f66d-4108-4af4-867d-5d0610836f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C242BD7D10>]}
[0m18:50:11.732770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1989f66d-4108-4af4-867d-5d0610836f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C242A6E0C0>]}
[0m18:50:11.733947 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:50:11.956848 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:50:12.290395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:50:12.290395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:50:12.383452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1989f66d-4108-4af4-867d-5d0610836f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C242D9F410>]}
[0m18:50:12.548835 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:50:12.552664 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:50:12.587682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1989f66d-4108-4af4-867d-5d0610836f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C242D7ACF0>]}
[0m18:50:12.588806 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:50:12.589676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1989f66d-4108-4af4-867d-5d0610836f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C242E2F770>]}
[0m18:50:12.591703 [info ] [MainThread]: 
[0m18:50:12.592125 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:12.592668 [info ] [MainThread]: 
[0m18:50:12.593750 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:12.594673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:50:12.674837 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:50:12.675827 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:50:12.675827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:12.714637 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.039 seconds
[0m18:50:12.716603 [debug] [ThreadPool]: On list_DBT: Close
[0m18:50:12.721441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m18:50:12.727759 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:50:12.728424 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:50:12.728959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:12.761373 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m18:50:12.761373 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:50:12.762333 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:50:12.769230 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m18:50:12.770201 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:50:12.771131 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:50:12.771131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m18:50:12.774127 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:50:12.774127 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:50:12.775087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:12.929351 [debug] [ThreadPool]: SQL status: BEGIN in 0.154 seconds
[0m18:50:12.929351 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:50:12.930350 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:50:12.939181 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m18:50:12.940324 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:50:12.941318 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:50:12.948335 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:12.949328 [debug] [MainThread]: On master: BEGIN
[0m18:50:12.949328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:12.981282 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m18:50:12.982279 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:12.982279 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:12.990493 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m18:50:12.992457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1989f66d-4108-4af4-867d-5d0610836f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C23FDC03E0>]}
[0m18:50:12.992457 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:12.993639 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:12.993639 [debug] [MainThread]: On master: BEGIN
[0m18:50:12.994500 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:50:12.994500 [debug] [MainThread]: On master: COMMIT
[0m18:50:12.995448 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:12.995448 [debug] [MainThread]: On master: COMMIT
[0m18:50:12.996113 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:12.996113 [debug] [MainThread]: On master: Close
[0m18:50:12.998642 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m18:50:12.999061 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.src_hosts ..................................... [RUN]
[0m18:50:13.000086 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_hosts'
[0m18:50:13.000086 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m18:50:13.009067 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m18:50:13.010036 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m18:50:13.050953 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m18:50:13.051952 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:50:13.052917 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: BEGIN
[0m18:50:13.052917 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:50:13.234626 [debug] [Thread-1 (]: SQL status: BEGIN in 0.181 seconds
[0m18:50:13.234989 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:50:13.235988 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */

  
    

  create  table "DBT"."raw"."src_hosts__dbt_tmp"
  
  
    as
  
  (
    WITH raw_hosts AS (
    SELECT
        *
    FROM
       "DBT"."raw"."raw_hosts"
)
SELECT
    id AS host_id,
    NAME AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
  
[0m18:50:13.251707 [debug] [Thread-1 (]: SQL status: SELECT 14111 in 0.016 seconds
[0m18:50:13.260653 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:50:13.260653 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
alter table "DBT"."raw"."src_hosts" rename to "src_hosts__dbt_backup"
[0m18:50:13.261979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:50:13.264973 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:50:13.265971 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
alter table "DBT"."raw"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m18:50:13.266415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:50:13.287963 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: COMMIT
[0m18:50:13.287963 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:50:13.289034 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: COMMIT
[0m18:50:13.293825 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:50:13.302803 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."src_hosts__dbt_backup"
[0m18:50:13.308787 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m18:50:13.308787 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
drop table if exists "DBT"."raw"."src_hosts__dbt_backup" cascade
[0m18:50:13.316794 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m18:50:13.318818 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m18:50:13.322192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1989f66d-4108-4af4-867d-5d0610836f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C23FF6C8C0>]}
[0m18:50:13.322810 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.src_hosts ................................ [[32mSELECT 14111[0m in 0.32s]
[0m18:50:13.323794 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m18:50:13.324770 [info ] [MainThread]: 
[0m18:50:13.325803 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:13.325803 [debug] [MainThread]: On master: BEGIN
[0m18:50:13.326765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:13.364308 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m18:50:13.364308 [debug] [MainThread]: On master: COMMIT
[0m18:50:13.364308 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:13.365336 [debug] [MainThread]: On master: COMMIT
[0m18:50:13.365877 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:13.376308 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:50:13.379302 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:13.380296 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.src_hosts', 'table',
'2025-01-22 17:50:11.369721+00:00',
'2025-01-22 17:50:13.001083',
'2025-01-22 17:50:13.318818'
,'success','0.3197298049926758',
'1989f66d-4108-4af4-867d-5d0610836f7d','1.9.1',CURRENT_TIMESTAMP(0),'14111');
           
      
  
[0m18:50:13.385168 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.005 seconds
[0m18:50:13.386168 [info ] [MainThread]: 
     
[0m18:50:13.387527 [info ] [MainThread]: ========== End Summary ==========
[0m18:50:13.388378 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:50:13.395392 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:50:13.396486 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m18:50:13.397381 [debug] [MainThread]: On master: Close
[0m18:50:13.398352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:13.398352 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:50:13.399350 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m18:50:13.399350 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m18:50:13.399350 [info ] [MainThread]: 
[0m18:50:13.400761 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m18:50:13.402366 [debug] [MainThread]: Command end result
[0m18:50:13.449294 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:50:13.452016 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:50:13.459550 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:50:13.459550 [info ] [MainThread]: 
[0m18:50:13.460575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:50:13.461545 [info ] [MainThread]: 
[0m18:50:13.462577 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:50:13.463539 [debug] [MainThread]: Command `dbt run` succeeded at 18:50:13.463539 after 2.19 seconds
[0m18:50:13.463539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C24271BB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C242C0E4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C242B8DFA0>]}
[0m18:50:13.464537 [debug] [MainThread]: Flushing usage events
[0m18:50:13.946647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:29.123444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B4F9F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B4F9F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B4F9F1D0>]}


============================== 18:50:29.128086 | d06d2ff7-33a7-4b14-b007-0f2b5403fd0b ==============================
[0m18:50:29.128086 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:50:29.129437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m src_reviews', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:50:29.340078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd06d2ff7-33a7-4b14-b007-0f2b5403fd0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B5107B60>]}
[0m18:50:29.403821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd06d2ff7-33a7-4b14-b007-0f2b5403fd0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B45978C0>]}
[0m18:50:29.405887 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:50:29.623788 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:50:29.937875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:50:29.938873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:50:30.032827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd06d2ff7-33a7-4b14-b007-0f2b5403fd0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B54215B0>]}
[0m18:50:30.202729 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:50:30.206945 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:50:30.240338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd06d2ff7-33a7-4b14-b007-0f2b5403fd0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B670DD90>]}
[0m18:50:30.240338 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:50:30.241346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd06d2ff7-33a7-4b14-b007-0f2b5403fd0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B556CA10>]}
[0m18:50:30.243275 [info ] [MainThread]: 
[0m18:50:30.244245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:30.244245 [info ] [MainThread]: 
[0m18:50:30.245243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:30.246390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:50:30.325372 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:50:30.326370 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:50:30.326370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:30.363722 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.037 seconds
[0m18:50:30.364673 [debug] [ThreadPool]: On list_DBT: Close
[0m18:50:30.370107 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m18:50:30.376612 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:50:30.376612 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:50:30.377609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:30.414107 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m18:50:30.414107 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:50:30.415139 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:50:30.421595 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:50:30.423625 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:50:30.424232 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:50:30.424232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m18:50:30.427250 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:50:30.427664 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:50:30.427664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:30.459740 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m18:50:30.460422 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:50:30.460422 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:50:30.467375 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m18:50:30.469401 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:50:30.469957 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:50:30.477347 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:30.477347 [debug] [MainThread]: On master: BEGIN
[0m18:50:30.478345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:30.653100 [debug] [MainThread]: SQL status: BEGIN in 0.175 seconds
[0m18:50:30.653985 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:30.653985 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:30.665123 [debug] [MainThread]: SQL status: SELECT 3 in 0.010 seconds
[0m18:50:30.667145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd06d2ff7-33a7-4b14-b007-0f2b5403fd0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B2532A80>]}
[0m18:50:30.667145 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:30.668346 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:30.668346 [debug] [MainThread]: On master: BEGIN
[0m18:50:30.669145 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:50:30.669145 [debug] [MainThread]: On master: COMMIT
[0m18:50:30.670142 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:30.670142 [debug] [MainThread]: On master: COMMIT
[0m18:50:30.670142 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:30.671107 [debug] [MainThread]: On master: Close
[0m18:50:30.673121 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m18:50:30.674130 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.src_reviews ................................... [RUN]
[0m18:50:30.675097 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_reviews'
[0m18:50:30.675097 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m18:50:30.684072 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m18:50:30.686069 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m18:50:30.727986 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m18:50:30.729950 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m18:50:30.729950 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: BEGIN
[0m18:50:30.729950 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:50:30.889208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m18:50:30.890113 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m18:50:30.890113 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */

  
    

  create  table "DBT"."raw"."src_reviews__dbt_tmp"
  
  
    as
  
  (
    WITH raw_reviews AS (
    SELECT
        *
    FROM
        "DBT"."raw"."raw_reviews"
)
SELECT
    listing_id,
    DATE AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
  
[0m18:50:30.892113 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "date" does not exist
LINE 20:     DATE AS review_date,
             ^

[0m18:50:30.892113 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: ROLLBACK
[0m18:50:30.893675 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m18:50:30.900085 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  column "date" does not exist
  LINE 20:     DATE AS review_date,
               ^
  compiled code at target\run\dbtlearn\models\src\src_reviews.sql
[0m18:50:30.903066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06d2ff7-33a7-4b14-b007-0f2b5403fd0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B6E64470>]}
[0m18:50:30.904073 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model raw.src_reviews .......................... [[31mERROR[0m in 0.23s]
[0m18:50:30.905043 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m18:50:30.906067 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.src_reviews' to be skipped because of status 'error'.  Reason: Database Error in model src_reviews (models\src\src_reviews.sql)
  column "date" does not exist
  LINE 20:     DATE AS review_date,
               ^
  compiled code at target\run\dbtlearn\models\src\src_reviews.sql.
[0m18:50:30.908035 [info ] [MainThread]: 
[0m18:50:30.909112 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:30.909112 [debug] [MainThread]: On master: BEGIN
[0m18:50:30.910030 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:30.945934 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m18:50:30.946618 [debug] [MainThread]: On master: COMMIT
[0m18:50:30.946618 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:30.947622 [debug] [MainThread]: On master: COMMIT
[0m18:50:30.947981 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:30.958562 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:50:30.961547 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:30.962570 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.src_reviews', 'table',
'2025-01-22 17:50:29.064823+00:00',
'2025-01-22 17:50:30.675097',
'2025-01-22 17:50:30.893675'
,'error','0.22637319564819336',
'd06d2ff7-33a7-4b14-b007-0f2b5403fd0b','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m18:50:30.983979 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.021 seconds
[0m18:50:30.985858 [info ] [MainThread]: 
     
[0m18:50:30.986538 [info ] [MainThread]: ========== End Summary ==========
[0m18:50:30.987338 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:50:30.994411 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:50:30.995399 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.05s]
[0m18:50:30.997312 [debug] [MainThread]: On master: Close
[0m18:50:30.998309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:30.998309 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:50:30.998309 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m18:50:30.999306 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m18:50:30.999306 [info ] [MainThread]: 
[0m18:50:31.000304 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m18:50:31.001302 [debug] [MainThread]: Command end result
[0m18:50:31.052382 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:50:31.055126 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:50:31.063527 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:50:31.063527 [info ] [MainThread]: 
[0m18:50:31.064350 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:50:31.065351 [info ] [MainThread]: 
[0m18:50:31.065351 [error] [MainThread]:   Database Error in model src_reviews (models\src\src_reviews.sql)
  column "date" does not exist
  LINE 20:     DATE AS review_date,
               ^
  compiled code at target\run\dbtlearn\models\src\src_reviews.sql
[0m18:50:31.067340 [info ] [MainThread]: 
[0m18:50:31.067340 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:50:31.068620 [debug] [MainThread]: Command `dbt run` failed at 18:50:31.068620 after 2.10 seconds
[0m18:50:31.069335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B68F1A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B1A9EC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B1A9D8B0>]}
[0m18:50:31.069335 [debug] [MainThread]: Flushing usage events
[0m18:50:31.604278 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:27.131194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CEDF142F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CEDF17440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CEDF14140>]}


============================== 18:51:27.136180 | 0736deff-37c2-4c6d-b77b-5b9f3d26f722 ==============================
[0m18:51:27.136180 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:51:27.137178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m src_reviews', 'send_anonymous_usage_stats': 'True'}
[0m18:51:27.345511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0736deff-37c2-4c6d-b77b-5b9f3d26f722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CEDAB3470>]}
[0m18:51:27.409340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0736deff-37c2-4c6d-b77b-5b9f3d26f722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CED4790A0>]}
[0m18:51:27.411054 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:51:27.632142 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:51:27.959632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:51:27.960630 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models\src\src_reviews.sql
[0m18:51:28.301747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0736deff-37c2-4c6d-b77b-5b9f3d26f722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CEF7FD220>]}
[0m18:51:28.470794 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:51:28.474564 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:51:28.509253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0736deff-37c2-4c6d-b77b-5b9f3d26f722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CEF7AC830>]}
[0m18:51:28.509253 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:51:28.510756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0736deff-37c2-4c6d-b77b-5b9f3d26f722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CEF405C10>]}
[0m18:51:28.512250 [info ] [MainThread]: 
[0m18:51:28.513242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:28.514219 [info ] [MainThread]: 
[0m18:51:28.514669 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:51:28.516209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:51:28.591786 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:51:28.592781 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:51:28.592781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:28.777620 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.185 seconds
[0m18:51:28.780574 [debug] [ThreadPool]: On list_DBT: Close
[0m18:51:28.790191 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m18:51:28.800152 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:51:28.801159 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:51:28.802148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:28.973872 [debug] [ThreadPool]: SQL status: BEGIN in 0.172 seconds
[0m18:51:28.974758 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:51:28.974758 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:51:28.986519 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m18:51:28.988549 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:51:28.990040 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:51:28.990617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m18:51:28.997528 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:51:28.997528 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:51:28.998523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:29.042373 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m18:51:29.042373 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:51:29.043401 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:51:29.049386 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m18:51:29.051383 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:51:29.051901 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:51:29.059365 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:29.059365 [debug] [MainThread]: On master: BEGIN
[0m18:51:29.059365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:51:29.099043 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m18:51:29.099043 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:29.099043 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:51:29.108539 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m18:51:29.109539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0736deff-37c2-4c6d-b77b-5b9f3d26f722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CEF4E1C70>]}
[0m18:51:29.110536 [debug] [MainThread]: On master: ROLLBACK
[0m18:51:29.110977 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:29.110977 [debug] [MainThread]: On master: BEGIN
[0m18:51:29.111801 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:51:29.111801 [debug] [MainThread]: On master: COMMIT
[0m18:51:29.111801 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:29.112786 [debug] [MainThread]: On master: COMMIT
[0m18:51:29.113443 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:51:29.113786 [debug] [MainThread]: On master: Close
[0m18:51:29.115748 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m18:51:29.115748 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.src_reviews ................................... [RUN]
[0m18:51:29.117773 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_reviews'
[0m18:51:29.117773 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m18:51:29.125752 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m18:51:29.126750 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m18:51:29.169637 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m18:51:29.170603 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m18:51:29.170603 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: BEGIN
[0m18:51:29.170603 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:51:29.208539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m18:51:29.209328 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m18:51:29.209328 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */

  
    

  create  table "DBT"."raw"."src_reviews__dbt_tmp"
  
  
    as
  
  (
    WITH raw_reviews AS (
    SELECT
        *
    FROM
        "DBT"."raw"."raw_reviews"
)
SELECT
    listing_id,
    review_date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
  
[0m18:51:31.354001 [debug] [Thread-1 (]: SQL status: SELECT 410284 in 2.144 seconds
[0m18:51:31.360963 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m18:51:31.361956 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
alter table "DBT"."raw"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m18:51:31.362923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:51:31.380906 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: COMMIT
[0m18:51:31.380906 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m18:51:31.381907 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: COMMIT
[0m18:51:31.390085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m18:51:31.399063 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."src_reviews__dbt_backup"
[0m18:51:31.404050 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m18:51:31.405047 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
drop table if exists "DBT"."raw"."src_reviews__dbt_backup" cascade
[0m18:51:31.406164 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:51:31.409068 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m18:51:31.411033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0736deff-37c2-4c6d-b77b-5b9f3d26f722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CEB2CC5C0>]}
[0m18:51:31.412028 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.src_reviews .............................. [[32mSELECT 410284[0m in 2.29s]
[0m18:51:31.413027 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m18:51:31.414086 [info ] [MainThread]: 
[0m18:51:31.415056 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:31.416049 [debug] [MainThread]: On master: BEGIN
[0m18:51:31.416049 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:51:31.453230 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m18:51:31.454147 [debug] [MainThread]: On master: COMMIT
[0m18:51:31.454147 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:31.454147 [debug] [MainThread]: On master: COMMIT
[0m18:51:31.455142 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:51:31.467112 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:51:31.470105 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:31.470105 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.src_reviews', 'table',
'2025-01-22 17:51:27.060351+00:00',
'2025-01-22 17:51:29.118739',
'2025-01-22 17:51:31.408071'
,'success','2.2919862270355225',
'0736deff-37c2-4c6d-b77b-5b9f3d26f722','1.9.1',CURRENT_TIMESTAMP(0),'410284');
           
      
  
[0m18:51:31.476023 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.005 seconds
[0m18:51:31.477642 [info ] [MainThread]: 
     
[0m18:51:31.478609 [info ] [MainThread]: ========== End Summary ==========
[0m18:51:31.479605 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:51:31.485590 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:51:31.487587 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m18:51:31.488584 [debug] [MainThread]: On master: Close
[0m18:51:31.488584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:31.489583 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:51:31.489583 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m18:51:31.489583 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m18:51:31.490579 [info ] [MainThread]: 
[0m18:51:31.491579 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m18:51:31.493601 [debug] [MainThread]: Command end result
[0m18:51:31.618235 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:51:31.620264 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:51:31.626741 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:51:31.627210 [info ] [MainThread]: 
[0m18:51:31.627210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:51:31.628208 [info ] [MainThread]: 
[0m18:51:31.629206 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:51:31.630299 [debug] [MainThread]: Command `dbt run` succeeded at 18:51:31.630299 after 4.66 seconds
[0m18:51:31.630299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CEBCD9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CEBCD9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CEBCD91F0>]}
[0m18:51:31.631233 [debug] [MainThread]: Flushing usage events
[0m18:51:32.205215 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:55.272160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B3225A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B3226FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B3225E50>]}


============================== 18:51:55.277381 | b8ab9e99-a94d-4da0-a402-faaf2ac56c8c ==============================
[0m18:51:55.277381 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:51:55.277381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m fct_reviews', 'send_anonymous_usage_stats': 'True'}
[0m18:51:55.491420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8ab9e99-a94d-4da0-a402-faaf2ac56c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B3225DC0>]}
[0m18:51:55.557866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8ab9e99-a94d-4da0-a402-faaf2ac56c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B26DE600>]}
[0m18:51:55.559179 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:51:55.779668 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:51:56.123989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:51:56.123989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:51:56.221899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8ab9e99-a94d-4da0-a402-faaf2ac56c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B3566210>]}
[0m18:51:56.392523 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:51:56.396437 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:51:56.430981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8ab9e99-a94d-4da0-a402-faaf2ac56c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B37128A0>]}
[0m18:51:56.430981 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:51:56.431975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ab9e99-a94d-4da0-a402-faaf2ac56c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B35D2F60>]}
[0m18:51:56.433975 [info ] [MainThread]: 
[0m18:51:56.435043 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:56.435940 [info ] [MainThread]: 
[0m18:51:56.436469 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:51:56.436969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:51:56.518987 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:51:56.518987 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:51:56.518987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:56.555490 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.036 seconds
[0m18:51:56.557442 [debug] [ThreadPool]: On list_DBT: Close
[0m18:51:56.562698 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m18:51:56.568415 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:51:56.569642 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:51:56.569699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:56.749009 [debug] [ThreadPool]: SQL status: BEGIN in 0.180 seconds
[0m18:51:56.749974 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:51:56.749974 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:51:56.756988 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:51:56.757953 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:51:56.759008 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:51:56.759253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m18:51:56.761974 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:51:56.762584 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:51:56.762584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:56.969106 [debug] [ThreadPool]: SQL status: BEGIN in 0.206 seconds
[0m18:51:56.969106 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:51:56.970144 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:51:56.983283 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m18:51:56.985236 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:51:56.986813 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:51:56.998231 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:56.999231 [debug] [MainThread]: On master: BEGIN
[0m18:51:57.000229 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:51:57.038397 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m18:51:57.038397 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:57.038397 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:51:57.047542 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m18:51:57.049535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ab9e99-a94d-4da0-a402-faaf2ac56c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B350D850>]}
[0m18:51:57.049535 [debug] [MainThread]: On master: ROLLBACK
[0m18:51:57.050503 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:57.050503 [debug] [MainThread]: On master: BEGIN
[0m18:51:57.051355 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:51:57.051355 [debug] [MainThread]: On master: COMMIT
[0m18:51:57.052336 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:57.052336 [debug] [MainThread]: On master: COMMIT
[0m18:51:57.053091 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:51:57.053334 [debug] [MainThread]: On master: Close
[0m18:51:57.055298 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m18:51:57.056330 [info ] [Thread-1 (]: 1 of 1 START sql incremental model raw.fct_reviews ............................. [RUN]
[0m18:51:57.057323 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.fct_reviews'
[0m18:51:57.057323 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m18:51:57.084252 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m18:51:57.105508 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m18:51:57.163958 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m18:51:57.167828 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m18:51:57.167828 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: BEGIN
[0m18:51:57.168824 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:51:57.321483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.152 seconds
[0m18:51:57.321483 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m18:51:57.322480 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */

      
  
    

  create  table "DBT"."raw"."fct_reviews"
  
  
    as
  
  (
    

WITH src_reviews AS (
  SELECT * FROM "DBT"."raw"."src_reviews"
)
SELECT 
  md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
  *
FROM src_reviews
WHERE review_text is not null

  );
  
  
[0m18:52:03.398561 [debug] [Thread-1 (]: SQL status: SELECT 409697 in 6.076 seconds
[0m18:52:03.430507 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: COMMIT
[0m18:52:03.431510 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m18:52:03.431510 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: COMMIT
[0m18:52:03.445013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m18:52:03.448040 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m18:52:03.450037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ab9e99-a94d-4da0-a402-faaf2ac56c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B05EC920>]}
[0m18:52:03.451031 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model raw.fct_reviews ........................ [[32mSELECT 409697[0m in 6.39s]
[0m18:52:03.452236 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m18:52:03.453178 [info ] [MainThread]: 
[0m18:52:03.454172 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:03.455177 [debug] [MainThread]: On master: BEGIN
[0m18:52:03.455177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:52:03.496028 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m18:52:03.496356 [debug] [MainThread]: On master: COMMIT
[0m18:52:03.496356 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:03.497056 [debug] [MainThread]: On master: COMMIT
[0m18:52:03.498024 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:52:03.508996 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:52:03.513073 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:03.514010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.fct_reviews', 'incremental',
'2025-01-22 17:51:55.214744+00:00',
'2025-01-22 17:51:57.057323',
'2025-01-22 17:52:03.447043'
,'success','6.39133620262146',
'b8ab9e99-a94d-4da0-a402-faaf2ac56c8c','1.9.1',CURRENT_TIMESTAMP(0),'409697');
           
      
  
[0m18:52:03.517007 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m18:52:03.518000 [info ] [MainThread]: 
     
[0m18:52:03.519202 [info ] [MainThread]: ========== End Summary ==========
[0m18:52:03.519994 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:52:03.526945 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:52:03.529493 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m18:52:03.530495 [debug] [MainThread]: On master: Close
[0m18:52:03.530495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:03.531482 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:52:03.531482 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m18:52:03.531482 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m18:52:03.531482 [info ] [MainThread]: 
[0m18:52:03.532921 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 7.10 seconds (7.10s).
[0m18:52:03.533476 [debug] [MainThread]: Command end result
[0m18:52:03.585971 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:52:03.588467 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:52:03.596423 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:52:03.596423 [info ] [MainThread]: 
[0m18:52:03.597307 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:52:03.598304 [info ] [MainThread]: 
[0m18:52:03.598304 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:52:03.599301 [debug] [MainThread]: Command `dbt run` succeeded at 18:52:03.599301 after 8.48 seconds
[0m18:52:03.600299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B0FF9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B0FF94F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B0FF9550>]}
[0m18:52:03.600299 [debug] [MainThread]: Flushing usage events
[0m18:52:04.085350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:52:37.282959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002597FB190A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002597E7C3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002597FB18F50>]}


============================== 18:52:37.286992 | 97e0a28e-f8b9-43c5-b91d-a252c38e698c ==============================
[0m18:52:37.286992 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:52:37.287990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m dim_hosts_cleansed', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:37.492805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97e0a28e-f8b9-43c5-b91d-a252c38e698c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025901F9D670>]}
[0m18:52:37.555636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97e0a28e-f8b9-43c5-b91d-a252c38e698c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025901E14BF0>]}
[0m18:52:37.557781 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:52:37.792981 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:52:38.122698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:38.122698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:38.217429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97e0a28e-f8b9-43c5-b91d-a252c38e698c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025901769460>]}
[0m18:52:38.387140 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:52:38.391129 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:52:38.426039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97e0a28e-f8b9-43c5-b91d-a252c38e698c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259032A3C20>]}
[0m18:52:38.427043 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:52:38.428010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e0a28e-f8b9-43c5-b91d-a252c38e698c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025901F73710>]}
[0m18:52:38.429037 [info ] [MainThread]: 
[0m18:52:38.430318 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:52:38.431001 [info ] [MainThread]: 
[0m18:52:38.431999 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:52:38.432997 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:52:38.513998 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:52:38.514081 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:52:38.514081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:38.555287 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.041 seconds
[0m18:52:38.557282 [debug] [ThreadPool]: On list_DBT: Close
[0m18:52:38.562237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m18:52:38.568252 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:52:38.569249 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:52:38.569249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:38.603848 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m18:52:38.603848 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:52:38.604841 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:52:38.611887 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m18:52:38.612471 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:52:38.613848 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:52:38.614434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m18:52:38.616429 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:52:38.617426 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:52:38.617499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:38.650888 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m18:52:38.650888 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:52:38.651916 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:52:38.658816 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m18:52:38.659601 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:52:38.660931 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:52:38.668573 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:38.668573 [debug] [MainThread]: On master: BEGIN
[0m18:52:38.669573 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:38.700612 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m18:52:38.700612 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:38.701639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:52:38.710618 [debug] [MainThread]: SQL status: SELECT 3 in 0.009 seconds
[0m18:52:38.711617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e0a28e-f8b9-43c5-b91d-a252c38e698c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025901F705F0>]}
[0m18:52:38.712614 [debug] [MainThread]: On master: ROLLBACK
[0m18:52:38.713113 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:38.713113 [debug] [MainThread]: On master: BEGIN
[0m18:52:38.713970 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:52:38.713970 [debug] [MainThread]: On master: COMMIT
[0m18:52:38.713970 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:38.714960 [debug] [MainThread]: On master: COMMIT
[0m18:52:38.715640 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:52:38.715953 [debug] [MainThread]: On master: Close
[0m18:52:38.718175 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m18:52:38.718914 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.dim_hosts_cleansed ............................. [RUN]
[0m18:52:38.719910 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.dim_hosts_cleansed'
[0m18:52:38.719910 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m18:52:38.727919 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:52:38.736080 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m18:52:38.775972 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:52:38.777969 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m18:52:38.778965 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: BEGIN
[0m18:52:38.778965 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:52:38.810998 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m18:52:38.810998 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m18:52:38.812163 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */

  create view "DBT"."raw"."dim_hosts_cleansed__dbt_tmp"
    
    
  as (
     
WITH src_hosts AS (
    SELECT
        *
    FROM
        "DBT"."raw"."src_hosts"
)
SELECT
    host_id,
    NVL(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m18:52:38.818001 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function nvl(character varying, unknown) does not exist
LINE 16:     NVL(
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:52:38.819008 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: ROLLBACK
[0m18:52:38.819658 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m18:52:38.824990 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  function nvl(character varying, unknown) does not exist
  LINE 16:     NVL(
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbtlearn\models\dim\dim_hosts_cleansed.sql
[0m18:52:38.826967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97e0a28e-f8b9-43c5-b91d-a252c38e698c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025903AF86B0>]}
[0m18:52:38.827982 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.dim_hosts_cleansed .................... [[31mERROR[0m in 0.11s]
[0m18:52:38.828953 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m18:52:38.829976 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.dim_hosts_cleansed' to be skipped because of status 'error'.  Reason: Database Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  function nvl(character varying, unknown) does not exist
  LINE 16:     NVL(
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbtlearn\models\dim\dim_hosts_cleansed.sql.
[0m18:52:38.831012 [info ] [MainThread]: 
[0m18:52:38.831939 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:38.832967 [debug] [MainThread]: On master: BEGIN
[0m18:52:38.832967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:52:38.873039 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m18:52:38.873835 [debug] [MainThread]: On master: COMMIT
[0m18:52:38.873835 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:38.874943 [debug] [MainThread]: On master: COMMIT
[0m18:52:38.875295 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:52:38.885804 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:52:38.888760 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:38.889758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.dim_hosts_cleansed', 'view',
'2025-01-22 17:52:37.215107+00:00',
'2025-01-22 17:52:38.719910',
'2025-01-22 17:52:38.819658'
,'error','0.10595417022705078',
'97e0a28e-f8b9-43c5-b91d-a252c38e698c','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m18:52:38.892751 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m18:52:38.894745 [info ] [MainThread]: 
     
[0m18:52:38.896740 [info ] [MainThread]: ========== End Summary ==========
[0m18:52:38.896740 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:52:38.901757 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:52:38.903116 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m18:52:38.904011 [debug] [MainThread]: On master: Close
[0m18:52:38.904011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:38.905153 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:52:38.905153 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m18:52:38.905153 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m18:52:38.906005 [info ] [MainThread]: 
[0m18:52:38.907004 [info ] [MainThread]: Finished running 1 project hook, 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m18:52:38.908032 [debug] [MainThread]: Command end result
[0m18:52:38.956457 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:52:38.958894 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:52:38.967014 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:52:38.967014 [info ] [MainThread]: 
[0m18:52:38.968027 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:52:38.969023 [info ] [MainThread]: 
[0m18:52:38.969990 [error] [MainThread]:   Database Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  function nvl(character varying, unknown) does not exist
  LINE 16:     NVL(
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbtlearn\models\dim\dim_hosts_cleansed.sql
[0m18:52:38.970986 [info ] [MainThread]: 
[0m18:52:38.971984 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:52:38.973013 [debug] [MainThread]: Command `dbt run` failed at 18:52:38.971984 after 1.85 seconds
[0m18:52:38.973013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025901DFB7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025901293860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025901290A10>]}
[0m18:52:38.973013 [debug] [MainThread]: Flushing usage events
[0m18:52:39.540101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:36.376623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27A84E060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27A2CF9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27A84DAC0>]}


============================== 18:53:36.381394 | 3362c878-4bd8-4b11-a3de-6da395a70d1d ==============================
[0m18:53:36.381394 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:53:36.382668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m dim_hosts_cleansed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:53:36.595720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3362c878-4bd8-4b11-a3de-6da395a70d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27A81DE50>]}
[0m18:53:36.661547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3362c878-4bd8-4b11-a3de-6da395a70d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27A89D220>]}
[0m18:53:36.663384 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:53:36.882192 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:53:37.223188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:53:37.224146 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models\dim\dim_hosts_cleansed.sql
[0m18:53:37.762656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3362c878-4bd8-4b11-a3de-6da395a70d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27C143FE0>]}
[0m18:53:37.934243 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:53:37.938185 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:53:37.973232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3362c878-4bd8-4b11-a3de-6da395a70d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27C02AAB0>]}
[0m18:53:37.973232 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:53:37.974325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3362c878-4bd8-4b11-a3de-6da395a70d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27BE0C9B0>]}
[0m18:53:37.976248 [info ] [MainThread]: 
[0m18:53:37.977230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:37.978217 [info ] [MainThread]: 
[0m18:53:37.979240 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:53:37.980222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:53:38.058578 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:53:38.059569 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:53:38.059569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:38.098516 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.039 seconds
[0m18:53:38.100501 [debug] [ThreadPool]: On list_DBT: Close
[0m18:53:38.105970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m18:53:38.111853 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:53:38.112851 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:53:38.112851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:38.146174 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m18:53:38.146174 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:53:38.146174 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:53:38.152795 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:53:38.154789 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:53:38.155493 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:53:38.155820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m18:53:38.158779 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:53:38.159128 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:53:38.159128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:38.192855 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m18:53:38.194155 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:53:38.194850 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:53:38.202827 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m18:53:38.204821 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:53:38.205437 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:53:38.211837 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:38.212837 [debug] [MainThread]: On master: BEGIN
[0m18:53:38.212837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:38.251890 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m18:53:38.252885 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:38.252885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:53:38.262876 [debug] [MainThread]: SQL status: SELECT 3 in 0.009 seconds
[0m18:53:38.263909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3362c878-4bd8-4b11-a3de-6da395a70d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27BD29130>]}
[0m18:53:38.264896 [debug] [MainThread]: On master: ROLLBACK
[0m18:53:38.265853 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:38.265853 [debug] [MainThread]: On master: BEGIN
[0m18:53:38.266944 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:53:38.266944 [debug] [MainThread]: On master: COMMIT
[0m18:53:38.267850 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:38.267850 [debug] [MainThread]: On master: COMMIT
[0m18:53:38.267850 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:53:38.268848 [debug] [MainThread]: On master: Close
[0m18:53:38.271868 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m18:53:38.271868 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.dim_hosts_cleansed ............................ [RUN]
[0m18:53:38.272863 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.dim_hosts_cleansed'
[0m18:53:38.273835 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m18:53:38.282812 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:53:38.283809 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m18:53:38.400497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:53:38.401495 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m18:53:38.402784 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: BEGIN
[0m18:53:38.402784 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:53:38.438875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m18:53:38.439825 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m18:53:38.439825 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */

  
    

  create  table "DBT"."raw"."dim_hosts_cleansed__dbt_tmp"
  
  
    as
  
  (
    WITH src_hosts AS (
    SELECT * FROM "DBT"."raw"."src_hosts"
)
SELECT 
    host_id,
    COALESCE(host_name, 'Anonymous') AS name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
  
[0m18:53:38.456455 [debug] [Thread-1 (]: SQL status: SELECT 14111 in 0.016 seconds
[0m18:53:38.464436 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m18:53:38.464436 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
alter table "DBT"."raw"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m18:53:38.465770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:53:38.487356 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: COMMIT
[0m18:53:38.487356 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m18:53:38.487356 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: COMMIT
[0m18:53:38.639755 [debug] [Thread-1 (]: SQL status: COMMIT in 0.151 seconds
[0m18:53:38.663701 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."dim_hosts_cleansed__dbt_backup"
[0m18:53:38.674668 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m18:53:38.675664 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop table if exists "DBT"."raw"."dim_hosts_cleansed__dbt_backup" cascade
[0m18:53:38.677619 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:53:38.681636 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m18:53:38.684601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3362c878-4bd8-4b11-a3de-6da395a70d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C279CF5CA0>]}
[0m18:53:38.686594 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.dim_hosts_cleansed ....................... [[32mSELECT 14111[0m in 0.41s]
[0m18:53:38.687592 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m18:53:38.689585 [info ] [MainThread]: 
[0m18:53:38.690613 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:38.690613 [debug] [MainThread]: On master: BEGIN
[0m18:53:38.691607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:53:38.729568 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m18:53:38.729568 [debug] [MainThread]: On master: COMMIT
[0m18:53:38.730564 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:38.730564 [debug] [MainThread]: On master: COMMIT
[0m18:53:38.731561 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:53:38.741535 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:53:38.746523 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:38.747555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.dim_hosts_cleansed', 'table',
'2025-01-22 17:53:36.323786+00:00',
'2025-01-22 17:53:38.273835',
'2025-01-22 17:53:38.680713'
,'success','0.40877294540405273',
'3362c878-4bd8-4b11-a3de-6da395a70d1d','1.9.1',CURRENT_TIMESTAMP(0),'14111');
           
      
  
[0m18:53:38.750511 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m18:53:38.752507 [info ] [MainThread]: 
     
[0m18:53:38.753503 [info ] [MainThread]: ========== End Summary ==========
[0m18:53:38.754765 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:53:38.760588 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:53:38.762577 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m18:53:38.763576 [debug] [MainThread]: On master: Close
[0m18:53:38.764573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:38.764716 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:53:38.765569 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m18:53:38.765569 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m18:53:38.766567 [info ] [MainThread]: 
[0m18:53:38.767565 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m18:53:38.770557 [debug] [MainThread]: Command end result
[0m18:53:38.819426 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:53:38.822254 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:53:38.829948 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:53:38.830396 [info ] [MainThread]: 
[0m18:53:38.831394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:38.831394 [info ] [MainThread]: 
[0m18:53:38.832570 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:53:38.833514 [debug] [MainThread]: Command `dbt run` succeeded at 18:53:38.833514 after 2.61 seconds
[0m18:53:38.833514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27A5B0BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27BFECF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27BFEE420>]}
[0m18:53:38.834511 [debug] [MainThread]: Flushing usage events
[0m18:53:39.339436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:54:03.951817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF613ABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF5E30920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF6139CA0>]}


============================== 18:54:03.956803 | d6dd6866-f7ad-4bea-b054-b9594fb7cebe ==============================
[0m18:54:03.956803 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:54:03.957199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_listings_cleansed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:54:04.161850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6dd6866-f7ad-4bea-b054-b9594fb7cebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF6280E30>]}
[0m18:54:04.224805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6dd6866-f7ad-4bea-b054-b9594fb7cebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF618C860>]}
[0m18:54:04.226244 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:54:04.454390 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:54:04.788497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:04.788497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:04.887591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6dd6866-f7ad-4bea-b054-b9594fb7cebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF63E7410>]}
[0m18:54:05.058737 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:54:05.062238 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:54:05.096071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6dd6866-f7ad-4bea-b054-b9594fb7cebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF75D03B0>]}
[0m18:54:05.096071 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:54:05.097067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6dd6866-f7ad-4bea-b054-b9594fb7cebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF3E0DB80>]}
[0m18:54:05.099036 [info ] [MainThread]: 
[0m18:54:05.100280 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:54:05.101095 [info ] [MainThread]: 
[0m18:54:05.102082 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:54:05.103294 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:54:05.182015 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:54:05.183007 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:54:05.183007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:05.219060 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.036 seconds
[0m18:54:05.220907 [debug] [ThreadPool]: On list_DBT: Close
[0m18:54:05.226337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m18:54:05.232203 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:54:05.233200 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:54:05.233200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:05.424678 [debug] [ThreadPool]: SQL status: BEGIN in 0.191 seconds
[0m18:54:05.425706 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:54:05.425706 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:54:05.435929 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m18:54:05.437953 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:54:05.439218 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:54:05.440025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_raw, now list_DBT_DEV)
[0m18:54:05.444932 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:54:05.444932 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:54:05.445931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:05.480189 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m18:54:05.480189 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:54:05.481058 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:54:05.487242 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:54:05.488238 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:54:05.489298 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:54:05.496216 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:05.496216 [debug] [MainThread]: On master: BEGIN
[0m18:54:05.496216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:54:05.532778 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m18:54:05.532778 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:05.533674 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:54:05.541618 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m18:54:05.543612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6dd6866-f7ad-4bea-b054-b9594fb7cebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF7E1D820>]}
[0m18:54:05.543612 [debug] [MainThread]: On master: ROLLBACK
[0m18:54:05.544819 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:05.544819 [debug] [MainThread]: On master: BEGIN
[0m18:54:05.545889 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:54:05.545889 [debug] [MainThread]: On master: COMMIT
[0m18:54:05.545889 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:05.546851 [debug] [MainThread]: On master: COMMIT
[0m18:54:05.547459 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:54:05.547845 [debug] [MainThread]: On master: Close
[0m18:54:05.549839 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m18:54:05.549839 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.dim_listings_cleansed .......................... [RUN]
[0m18:54:05.550807 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.dim_listings_cleansed'
[0m18:54:05.551803 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m18:54:05.559783 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m18:54:05.560972 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m18:54:05.601688 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m18:54:05.609625 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m18:54:05.610202 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: BEGIN
[0m18:54:05.611198 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:54:05.782001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.171 seconds
[0m18:54:05.782925 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m18:54:05.782925 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */

  create view "DBT"."raw"."dim_listings_cleansed__dbt_tmp"
    
    
  as (
     
WITH src_listings AS (
    SELECT * FROM "DBT"."raw"."src_listings"
)
SELECT 
  listing_id,
  listing_name,
  room_type,
  CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
  END AS minimum_nights,
  host_id,
  REPLACE(
    price_str,
    '$'
  ) :: NUMBER(
    10,
    2
  ) AS price,
  created_at,
  updated_at
FROM
  src_listings
  );
[0m18:54:05.784892 [debug] [Thread-1 (]: Postgres adapter: Postgres error: type "number" does not exist
LINE 23:   ) :: NUMBER(
                ^

[0m18:54:05.784892 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: ROLLBACK
[0m18:54:05.785918 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m18:54:05.792898 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  type "number" does not exist
  LINE 23:   ) :: NUMBER(
                  ^
  compiled code at target\run\dbtlearn\models\dim\dim_listings_cleansed.sql
[0m18:54:05.795617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6dd6866-f7ad-4bea-b054-b9594fb7cebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF7DDC320>]}
[0m18:54:05.796601 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.dim_listings_cleansed ................. [[31mERROR[0m in 0.24s]
[0m18:54:05.797598 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m18:54:05.798596 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.dim_listings_cleansed' to be skipped because of status 'error'.  Reason: Database Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  type "number" does not exist
  LINE 23:   ) :: NUMBER(
                  ^
  compiled code at target\run\dbtlearn\models\dim\dim_listings_cleansed.sql.
[0m18:54:05.800592 [info ] [MainThread]: 
[0m18:54:05.801616 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:05.801616 [debug] [MainThread]: On master: BEGIN
[0m18:54:05.802585 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:54:05.836699 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m18:54:05.836699 [debug] [MainThread]: On master: COMMIT
[0m18:54:05.837727 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:05.837727 [debug] [MainThread]: On master: COMMIT
[0m18:54:05.838542 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:54:05.848668 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:54:05.852687 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:05.852687 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.dim_listings_cleansed', 'view',
'2025-01-22 17:54:03.896577+00:00',
'2025-01-22 17:54:05.551803',
'2025-01-22 17:54:05.785918'
,'error','0.24209165573120117',
'd6dd6866-f7ad-4bea-b054-b9594fb7cebe','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m18:54:05.861632 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.008 seconds
[0m18:54:05.864662 [info ] [MainThread]: 
     
[0m18:54:05.865834 [info ] [MainThread]: ========== End Summary ==========
[0m18:54:05.866760 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:54:05.871777 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:54:05.873206 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m18:54:05.873741 [debug] [MainThread]: On master: Close
[0m18:54:05.874769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:05.875233 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:54:05.875735 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m18:54:05.875735 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m18:54:05.875735 [info ] [MainThread]: 
[0m18:54:05.876734 [info ] [MainThread]: Finished running 1 project hook, 1 view model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m18:54:05.878732 [debug] [MainThread]: Command end result
[0m18:54:05.931758 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:54:05.934575 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:54:05.940664 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:54:05.940664 [info ] [MainThread]: 
[0m18:54:05.941659 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:54:05.942658 [info ] [MainThread]: 
[0m18:54:05.943205 [error] [MainThread]:   Database Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  type "number" does not exist
  LINE 23:   ) :: NUMBER(
                  ^
  compiled code at target\run\dbtlearn\models\dim\dim_listings_cleansed.sql
[0m18:54:05.944652 [info ] [MainThread]: 
[0m18:54:05.945652 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:54:05.946647 [debug] [MainThread]: Command `dbt run` failed at 18:54:05.946647 after 2.15 seconds
[0m18:54:05.947645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF5EA22A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF610F7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF610F740>]}
[0m18:54:05.947645 [debug] [MainThread]: Flushing usage events
[0m18:54:06.496052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:54:43.220405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D410CB3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D410C8B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D410CB950>]}


============================== 18:54:43.224428 | a99d5efa-0023-4524-9d91-7d443773b833 ==============================
[0m18:54:43.224428 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:54:43.225797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m dim_listings_cleansed', 'send_anonymous_usage_stats': 'True'}
[0m18:54:43.432092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a99d5efa-0023-4524-9d91-7d443773b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D4111D0D0>]}
[0m18:54:43.497748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a99d5efa-0023-4524-9d91-7d443773b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D408FBA40>]}
[0m18:54:43.499671 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:54:43.730564 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:54:44.048040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:54:44.048040 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models\dim\dim_listings_cleansed.sql
[0m18:54:44.585199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a99d5efa-0023-4524-9d91-7d443773b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D42AA4EC0>]}
[0m18:54:44.755056 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:54:44.758824 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:54:44.792904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a99d5efa-0023-4524-9d91-7d443773b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D42BD9220>]}
[0m18:54:44.792904 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:54:44.794143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a99d5efa-0023-4524-9d91-7d443773b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D42BDE9C0>]}
[0m18:54:44.795809 [info ] [MainThread]: 
[0m18:54:44.796930 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:54:44.797804 [info ] [MainThread]: 
[0m18:54:44.798544 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:54:44.799453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:54:44.878548 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:54:44.878548 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:54:44.879576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:45.056954 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.178 seconds
[0m18:54:45.058949 [debug] [ThreadPool]: On list_DBT: Close
[0m18:54:45.065463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m18:54:45.071448 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:54:45.072447 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:54:45.072447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:45.104361 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m18:54:45.104361 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:54:45.105389 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:54:45.112373 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:54:45.113372 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:54:45.114375 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:54:45.114375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m18:54:45.117369 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:54:45.117799 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:54:45.117799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:45.150747 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m18:54:45.151512 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:54:45.151512 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:54:45.158527 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m18:54:45.159523 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:54:45.160841 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:54:45.167501 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:45.167501 [debug] [MainThread]: On master: BEGIN
[0m18:54:45.167501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:54:45.201312 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m18:54:45.201312 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:45.202309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:54:45.210646 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m18:54:45.211645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a99d5efa-0023-4524-9d91-7d443773b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D431013A0>]}
[0m18:54:45.212642 [debug] [MainThread]: On master: ROLLBACK
[0m18:54:45.212642 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:45.212642 [debug] [MainThread]: On master: BEGIN
[0m18:54:45.213722 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:54:45.213722 [debug] [MainThread]: On master: COMMIT
[0m18:54:45.214671 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:45.214671 [debug] [MainThread]: On master: COMMIT
[0m18:54:45.215636 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:54:45.215636 [debug] [MainThread]: On master: Close
[0m18:54:45.217629 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m18:54:45.218627 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.dim_listings_cleansed ......................... [RUN]
[0m18:54:45.219625 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.dim_listings_cleansed'
[0m18:54:45.219625 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m18:54:45.227637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m18:54:45.228600 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m18:54:45.339342 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m18:54:45.340975 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m18:54:45.341300 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: BEGIN
[0m18:54:45.341300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:54:45.376194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m18:54:45.376194 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m18:54:45.377224 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */

  
    

  create  table "DBT"."raw"."dim_listings_cleansed__dbt_tmp"
  
  
    as
  
  (
    WITH src_listings AS (
    SELECT * FROM "DBT"."raw"."src_listings"
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights 
    END AS minimum_nights,
    host_id,
    ROUND(REPLACE(price_str, '$', '')::NUMERIC, 2) as price_str,
    created_at,
    updated_at
FROM src_listings
  );
  
[0m18:54:45.440655 [debug] [Thread-1 (]: SQL status: SELECT 17499 in 0.064 seconds
[0m18:54:45.448634 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m18:54:45.448634 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
alter table "DBT"."raw"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m18:54:45.450071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:54:45.469582 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: COMMIT
[0m18:54:45.470574 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m18:54:45.470574 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: COMMIT
[0m18:54:45.480909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m18:54:45.488886 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."dim_listings_cleansed__dbt_backup"
[0m18:54:45.494870 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m18:54:45.495998 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop table if exists "DBT"."raw"."dim_listings_cleansed__dbt_backup" cascade
[0m18:54:45.496863 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:54:45.498889 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m18:54:45.501850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99d5efa-0023-4524-9d91-7d443773b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D42B2B3B0>]}
[0m18:54:45.502880 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.dim_listings_cleansed .................... [[32mSELECT 17499[0m in 0.28s]
[0m18:54:45.503844 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m18:54:45.504842 [info ] [MainThread]: 
[0m18:54:45.506292 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:45.506292 [debug] [MainThread]: On master: BEGIN
[0m18:54:45.506863 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:54:45.656372 [debug] [MainThread]: SQL status: BEGIN in 0.150 seconds
[0m18:54:45.656372 [debug] [MainThread]: On master: COMMIT
[0m18:54:45.657368 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:45.657368 [debug] [MainThread]: On master: COMMIT
[0m18:54:45.658365 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:54:45.666343 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:54:45.669368 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:45.670479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.dim_listings_cleansed', 'table',
'2025-01-22 17:54:43.149261+00:00',
'2025-01-22 17:54:45.219625',
'2025-01-22 17:54:45.498889'
,'success','0.28057074546813965',
'a99d5efa-0023-4524-9d91-7d443773b833','1.9.1',CURRENT_TIMESTAMP(0),'17499');
           
      
  
[0m18:54:45.680207 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.009 seconds
[0m18:54:45.682204 [info ] [MainThread]: 
     
[0m18:54:45.682853 [info ] [MainThread]: ========== End Summary ==========
[0m18:54:45.683689 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:54:45.689673 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:54:45.691698 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m18:54:45.692665 [debug] [MainThread]: On master: Close
[0m18:54:45.692665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:45.693662 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:54:45.693662 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m18:54:45.693662 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m18:54:45.694690 [info ] [MainThread]: 
[0m18:54:45.695656 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m18:54:45.696655 [debug] [MainThread]: Command end result
[0m18:54:45.747519 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:54:45.750509 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:54:45.756525 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:54:45.757122 [info ] [MainThread]: 
[0m18:54:45.757523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:54:45.758518 [info ] [MainThread]: 
[0m18:54:45.759354 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:54:45.760295 [debug] [MainThread]: Command `dbt run` succeeded at 18:54:45.760295 after 2.71 seconds
[0m18:54:45.760295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D40A757F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D3E388410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D3B012090>]}
[0m18:54:45.761505 [debug] [MainThread]: Flushing usage events
[0m18:54:46.253337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:25.063842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7BC5E060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7BCFEA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7BCFE9F0>]}


============================== 18:55:25.067740 | 3fdeeaae-9b99-4735-a0c8-7e027529f81d ==============================
[0m18:55:25.067740 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:55:25.069087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m dim_listings_w_hosts', 'send_anonymous_usage_stats': 'True'}
[0m18:55:25.278453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fdeeaae-9b99-4735-a0c8-7e027529f81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7977D6D0>]}
[0m18:55:25.344061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fdeeaae-9b99-4735-a0c8-7e027529f81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7B8CDC40>]}
[0m18:55:25.345974 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:55:25.573735 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:55:25.906085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:55:25.907083 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models\dim\dim_listings_w_hosts.sql
[0m18:55:26.479249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fdeeaae-9b99-4735-a0c8-7e027529f81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7DED8F80>]}
[0m18:55:26.646154 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:55:26.649695 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:55:26.685157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fdeeaae-9b99-4735-a0c8-7e027529f81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7DB3BA40>]}
[0m18:55:26.685157 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:55:26.686203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fdeeaae-9b99-4735-a0c8-7e027529f81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7DDE0140>]}
[0m18:55:26.688447 [info ] [MainThread]: 
[0m18:55:26.689175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:26.690113 [info ] [MainThread]: 
[0m18:55:26.691110 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:55:26.692450 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:55:26.771179 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:55:26.771179 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:55:26.772176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:26.945167 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.173 seconds
[0m18:55:26.946167 [debug] [ThreadPool]: On list_DBT: Close
[0m18:55:26.952996 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m18:55:26.960862 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:55:26.960862 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:55:26.960862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:26.995430 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m18:55:26.995430 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:55:26.996369 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:55:27.002353 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:55:27.003351 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:55:27.004667 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:55:27.005350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m18:55:27.007373 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:55:27.008077 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:55:27.008368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:27.039707 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m18:55:27.039707 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:55:27.040738 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:55:27.047945 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m18:55:27.048975 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:55:27.049939 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:55:27.055923 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.056920 [debug] [MainThread]: On master: BEGIN
[0m18:55:27.056920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:27.090378 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m18:55:27.091298 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.091298 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:55:27.100236 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m18:55:27.101233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fdeeaae-9b99-4735-a0c8-7e027529f81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7DCFD880>]}
[0m18:55:27.101233 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:27.102518 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.102518 [debug] [MainThread]: On master: BEGIN
[0m18:55:27.103334 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:55:27.103334 [debug] [MainThread]: On master: COMMIT
[0m18:55:27.103334 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.104319 [debug] [MainThread]: On master: COMMIT
[0m18:55:27.104950 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:27.105316 [debug] [MainThread]: On master: Close
[0m18:55:27.107281 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m18:55:27.107281 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.dim_listings_w_hosts ........................... [RUN]
[0m18:55:27.108359 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.dim_listings_w_hosts'
[0m18:55:27.109306 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m18:55:27.180639 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:55:27.190775 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m18:55:27.241668 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:55:27.243845 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m18:55:27.244552 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: BEGIN
[0m18:55:27.244552 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:55:27.278721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m18:55:27.278721 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m18:55:27.279729 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */

  create view "DBT"."raw"."dim_listings_w_hosts__dbt_tmp"
    
    
  as (
    

WITH    
l As (
    select * from "DBT"."raw"."dim_listings_cleansed"
),
h as (select * from "DBT"."raw"."dim_hosts_cleansed")

select 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price_str,
    l.host_id,
    h.NAME,
    h.IS_SUPERHOST as host_is_superhost,
    l.created_at,
    GREATEST (l.updated_at,h.updated_at) as update_at
    from l   
    left join h on (h.host_id = l.host_id)
  );
[0m18:55:27.292137 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m18:55:27.300116 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m18:55:27.300116 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
alter table "DBT"."raw"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m18:55:27.301564 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:27.317072 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: COMMIT
[0m18:55:27.317072 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m18:55:27.317072 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: COMMIT
[0m18:55:27.319589 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:55:27.326512 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."dim_listings_w_hosts__dbt_backup"
[0m18:55:27.330502 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m18:55:27.331499 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
drop view if exists "DBT"."raw"."dim_listings_w_hosts__dbt_backup" cascade
[0m18:55:27.332495 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m18:55:27.334490 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m18:55:27.336485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdeeaae-9b99-4735-a0c8-7e027529f81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7C41D070>]}
[0m18:55:27.337497 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.dim_listings_w_hosts ...................... [[32mCREATE VIEW[0m in 0.23s]
[0m18:55:27.338482 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m18:55:27.340475 [info ] [MainThread]: 
[0m18:55:27.341473 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.341473 [debug] [MainThread]: On master: BEGIN
[0m18:55:27.341473 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:27.377113 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m18:55:27.377113 [debug] [MainThread]: On master: COMMIT
[0m18:55:27.378069 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.378069 [debug] [MainThread]: On master: COMMIT
[0m18:55:27.379065 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:27.390036 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:55:27.393026 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.394023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.dim_listings_w_hosts', 'view',
'2025-01-22 17:55:25.011810+00:00',
'2025-01-22 17:55:27.109306',
'2025-01-22 17:55:27.334490'
,'success','0.22613048553466797',
'3fdeeaae-9b99-4735-a0c8-7e027529f81d','1.9.1',CURRENT_TIMESTAMP(0),'-1');
           
      
  
[0m18:55:27.397045 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m18:55:27.399014 [info ] [MainThread]: 
     
[0m18:55:27.400008 [info ] [MainThread]: ========== End Summary ==========
[0m18:55:27.401021 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:55:27.406024 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:55:27.407134 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m18:55:27.407989 [debug] [MainThread]: On master: Close
[0m18:55:27.408984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:27.408984 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:55:27.409981 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m18:55:27.409981 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m18:55:27.409981 [info ] [MainThread]: 
[0m18:55:27.411074 [info ] [MainThread]: Finished running 1 project hook, 1 view model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m18:55:27.411976 [debug] [MainThread]: Command end result
[0m18:55:27.460846 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:55:27.464005 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:55:27.471465 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:55:27.471465 [info ] [MainThread]: 
[0m18:55:27.472707 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:27.473494 [info ] [MainThread]: 
[0m18:55:27.474460 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:55:27.475458 [debug] [MainThread]: Command `dbt run` succeeded at 18:55:27.475458 after 2.56 seconds
[0m18:55:27.475458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7A189340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7A189220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7A1892B0>]}
[0m18:55:27.476480 [debug] [MainThread]: Flushing usage events
[0m18:55:27.959918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:56:48.143008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA241066F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA241045C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA24107920>]}


============================== 18:56:48.148057 | b348b436-eec6-4df0-b96b-44fab9102896 ==============================
[0m18:56:48.148057 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:56:48.148992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_fullmoon_reviews', 'send_anonymous_usage_stats': 'True'}
[0m18:56:48.362553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b348b436-eec6-4df0-b96b-44fab9102896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2430CBC0>]}
[0m18:56:48.430037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b348b436-eec6-4df0-b96b-44fab9102896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA23E90740>]}
[0m18:56:48.431995 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:56:48.662601 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:56:48.994761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:56:48.994761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:56:49.091497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b348b436-eec6-4df0-b96b-44fab9102896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA24510CE0>]}
[0m18:56:49.263420 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:56:49.267005 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:56:49.301909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b348b436-eec6-4df0-b96b-44fab9102896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA255B7BC0>]}
[0m18:56:49.302907 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:56:49.303905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b348b436-eec6-4df0-b96b-44fab9102896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA256061E0>]}
[0m18:56:49.304902 [info ] [MainThread]: 
[0m18:56:49.306135 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:56:49.306896 [info ] [MainThread]: 
[0m18:56:49.307542 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:56:49.307924 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:56:49.387962 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:56:49.388959 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:56:49.388959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:49.426447 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.038 seconds
[0m18:56:49.428478 [debug] [ThreadPool]: On list_DBT: Close
[0m18:56:49.433790 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m18:56:49.439742 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:56:49.440739 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:56:49.440739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:49.621248 [debug] [ThreadPool]: SQL status: BEGIN in 0.180 seconds
[0m18:56:49.621639 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:56:49.622636 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:56:49.632978 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m18:56:49.635006 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:56:49.636001 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:56:49.637507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_raw, now list_DBT_DEV)
[0m18:56:49.643979 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:56:49.643979 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:56:49.644977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:56:49.688021 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m18:56:49.688831 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:56:49.688831 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:56:49.695365 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:56:49.697359 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:56:49.698127 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:56:49.704343 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:49.704343 [debug] [MainThread]: On master: BEGIN
[0m18:56:49.705340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:56:49.737253 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m18:56:49.737253 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:49.738284 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:56:49.746261 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m18:56:49.748225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b348b436-eec6-4df0-b96b-44fab9102896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA24106A20>]}
[0m18:56:49.749222 [debug] [MainThread]: On master: ROLLBACK
[0m18:56:49.749222 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:49.750220 [debug] [MainThread]: On master: BEGIN
[0m18:56:49.750959 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:56:49.750959 [debug] [MainThread]: On master: COMMIT
[0m18:56:49.750959 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:49.751944 [debug] [MainThread]: On master: COMMIT
[0m18:56:49.751944 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:56:49.752908 [debug] [MainThread]: On master: Close
[0m18:56:49.754902 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m18:56:49.754902 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.mart_fullmoon_reviews ......................... [RUN]
[0m18:56:49.755964 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m18:56:49.756928 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m18:56:49.764907 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:56:49.766871 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m18:56:49.809337 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:56:49.831290 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:56:49.831290 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: BEGIN
[0m18:56:49.832284 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:56:50.002777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.170 seconds
[0m18:56:50.003690 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:56:50.003690 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */

  
    

  create  table "DBT"."raw"."mart_fullmoon_reviews__dbt_tmp"
  
  
    as
  
  (
    

WITH fct_reviews AS (
    SELECT * FROM "DBT"."raw"."fct_reviews"
),
full_moon_dates AS (
    SELECT * FROM "DBT"."raw"."seed_full_moon_dates"
)

SELECT
  r.*,
  CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
  END AS is_full_moon
FROM
  fct_reviews
  r
  LEFT JOIN full_moon_dates
  fm
  ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
  );
  
[0m18:56:50.005653 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.seed_full_moon_dates" does not exist
LINE 18:     SELECT * FROM "DBT"."raw"."seed_full_moon_dates"
                           ^

[0m18:56:50.006681 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: ROLLBACK
[0m18:56:50.007648 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m18:56:50.014628 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "raw.seed_full_moon_dates" does not exist
  LINE 18:     SELECT * FROM "DBT"."raw"."seed_full_moon_dates"
                             ^
  compiled code at target\run\dbtlearn\models\mart\mart_fullmoon_reviews.sql
[0m18:56:50.017299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b348b436-eec6-4df0-b96b-44fab9102896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA25E25C70>]}
[0m18:56:50.018122 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model raw.mart_fullmoon_reviews ................ [[31mERROR[0m in 0.26s]
[0m18:56:50.019091 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m18:56:50.020090 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.mart_fullmoon_reviews' to be skipped because of status 'error'.  Reason: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "raw.seed_full_moon_dates" does not exist
  LINE 18:     SELECT * FROM "DBT"."raw"."seed_full_moon_dates"
                             ^
  compiled code at target\run\dbtlearn\models\mart\mart_fullmoon_reviews.sql.
[0m18:56:50.022268 [info ] [MainThread]: 
[0m18:56:50.023084 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:50.024079 [debug] [MainThread]: On master: BEGIN
[0m18:56:50.024079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:56:50.062098 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m18:56:50.063127 [debug] [MainThread]: On master: COMMIT
[0m18:56:50.063127 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:50.063127 [debug] [MainThread]: On master: COMMIT
[0m18:56:50.064339 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:56:50.075094 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:56:50.079084 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:50.079084 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.mart_fullmoon_reviews', 'table',
'2025-01-22 17:56:48.054376+00:00',
'2025-01-22 17:56:49.756928',
'2025-01-22 17:56:50.006757'
,'error','0.2586641311645508',
'b348b436-eec6-4df0-b96b-44fab9102896','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m18:56:50.101915 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.022 seconds
[0m18:56:50.104005 [info ] [MainThread]: 
     
[0m18:56:50.104911 [info ] [MainThread]: ========== End Summary ==========
[0m18:56:50.105907 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:56:50.112913 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:56:50.114117 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.05s]
[0m18:56:50.114882 [debug] [MainThread]: On master: Close
[0m18:56:50.115902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:56:50.117001 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:56:50.117001 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m18:56:50.117874 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m18:56:50.117874 [info ] [MainThread]: 
[0m18:56:50.118874 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m18:56:50.120865 [debug] [MainThread]: Command end result
[0m18:56:50.169735 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:56:50.171730 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:56:50.178061 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:56:50.178735 [info ] [MainThread]: 
[0m18:56:50.179716 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:56:50.180656 [info ] [MainThread]: 
[0m18:56:50.180656 [error] [MainThread]:   Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "raw.seed_full_moon_dates" does not exist
  LINE 18:     SELECT * FROM "DBT"."raw"."seed_full_moon_dates"
                             ^
  compiled code at target\run\dbtlearn\models\mart\mart_fullmoon_reviews.sql
[0m18:56:50.182654 [info ] [MainThread]: 
[0m18:56:50.183651 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:56:50.184683 [debug] [MainThread]: Command `dbt run` failed at 18:56:50.184683 after 2.23 seconds
[0m18:56:50.184683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA21EC93D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA21EC9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA21EC8230>]}
[0m18:56:50.185676 [debug] [MainThread]: Flushing usage events
[0m18:56:50.889670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:33.879049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216E5082F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216E509D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216D4CD490>]}


============================== 18:57:33.883822 | aafbbde5-6970-4f71-96f1-1927523c6cc0 ==============================
[0m18:57:33.883822 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:57:33.885113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:34.093796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aafbbde5-6970-4f71-96f1-1927523c6cc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216AECD670>]}
[0m18:57:34.156759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aafbbde5-6970-4f71-96f1-1927523c6cc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216E643AA0>]}
[0m18:57:34.158287 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:57:34.389598 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:57:34.708738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:57:34.709734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:57:34.806474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aafbbde5-6970-4f71-96f1-1927523c6cc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216E791280>]}
[0m18:57:34.980993 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:57:34.984982 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:57:35.017730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aafbbde5-6970-4f71-96f1-1927523c6cc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216F9F6B10>]}
[0m18:57:35.018752 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:57:35.019725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aafbbde5-6970-4f71-96f1-1927523c6cc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216E6877D0>]}
[0m18:57:35.021746 [info ] [MainThread]: 
[0m18:57:35.022393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:57:35.022718 [info ] [MainThread]: 
[0m18:57:35.023715 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:57:35.024904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:57:35.139470 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:57:35.140467 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:57:35.140467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:35.341490 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.201 seconds
[0m18:57:35.343515 [debug] [ThreadPool]: On list_DBT: Close
[0m18:57:35.352397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m18:57:35.362373 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:57:35.362373 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:57:35.363370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:35.518016 [debug] [ThreadPool]: SQL status: BEGIN in 0.154 seconds
[0m18:57:35.518016 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:57:35.519013 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:57:35.528460 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m18:57:35.531485 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:57:35.532498 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:57:35.533446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_raw, now list_DBT_DEV)
[0m18:57:35.539879 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:57:35.539879 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:57:35.540876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:35.721510 [debug] [ThreadPool]: SQL status: BEGIN in 0.181 seconds
[0m18:57:35.722465 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:57:35.722465 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:57:35.731003 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m18:57:35.732437 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:57:35.733016 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:57:35.739962 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:35.739962 [debug] [MainThread]: On master: BEGIN
[0m18:57:35.740962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:35.773945 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m18:57:35.773945 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:35.774943 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:57:35.782920 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m18:57:35.784947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aafbbde5-6970-4f71-96f1-1927523c6cc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216FADFD40>]}
[0m18:57:35.784947 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:35.786043 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:35.786043 [debug] [MainThread]: On master: BEGIN
[0m18:57:35.787043 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:57:35.787043 [debug] [MainThread]: On master: COMMIT
[0m18:57:35.787043 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:35.788077 [debug] [MainThread]: On master: COMMIT
[0m18:57:35.788572 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:35.788572 [debug] [MainThread]: On master: Close
[0m18:57:35.791032 [debug] [Thread-1 (]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m18:57:35.791032 [info ] [Thread-1 (]: 1 of 1 START seed file raw.seed_full_moon_dates ................................ [RUN]
[0m18:57:35.792170 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.dbtlearn.seed_full_moon_dates'
[0m18:57:35.793027 [debug] [Thread-1 (]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m18:57:35.793027 [debug] [Thread-1 (]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m18:57:35.851962 [debug] [Thread-1 (]: Using postgres connection "seed.dbtlearn.seed_full_moon_dates"
[0m18:57:35.852959 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: BEGIN
[0m18:57:35.852959 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:57:35.892638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m18:57:35.893439 [debug] [Thread-1 (]: Using postgres connection "seed.dbtlearn.seed_full_moon_dates"
[0m18:57:35.893439 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */

    create table "DBT"."raw"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m18:57:35.901606 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.008 seconds
[0m18:57:35.936512 [debug] [Thread-1 (]: Using postgres connection "seed.dbtlearn.seed_full_moon_dates"
[0m18:57:35.937509 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: 
          insert into "DBT"."raw"."seed_full_moon_dates" ("full_moon_date") values
          (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s...
[0m18:57:35.940131 [debug] [Thread-1 (]: SQL status: INSERT 0 272 in 0.002 seconds
[0m18:57:35.945521 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m18:57:35.967429 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: COMMIT
[0m18:57:35.967429 [debug] [Thread-1 (]: Using postgres connection "seed.dbtlearn.seed_full_moon_dates"
[0m18:57:35.968427 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: COMMIT
[0m18:57:35.969511 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:57:35.971455 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: Close
[0m18:57:35.974534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aafbbde5-6970-4f71-96f1-1927523c6cc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216FD03A40>]}
[0m18:57:35.974534 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file raw.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 0.18s]
[0m18:57:35.976431 [debug] [Thread-1 (]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m18:57:35.977438 [info ] [MainThread]: 
[0m18:57:35.978651 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:35.978651 [debug] [MainThread]: On master: BEGIN
[0m18:57:35.979437 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:36.013330 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m18:57:36.013330 [debug] [MainThread]: On master: COMMIT
[0m18:57:36.014306 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:36.014306 [debug] [MainThread]: On master: COMMIT
[0m18:57:36.015203 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:36.030150 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:57:36.034272 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:36.035107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'seed.dbtlearn.seed_full_moon_dates', 'seed',
'2025-01-22 17:57:33.825201+00:00',
'2025-01-22 17:57:35.793027',
'2025-01-22 17:57:35.971455'
,'success','0.1802809238433838',
'aafbbde5-6970-4f71-96f1-1927523c6cc0','1.9.1',CURRENT_TIMESTAMP(0),'272');
           
      
  
[0m18:57:36.038097 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.003 seconds
[0m18:57:36.040123 [info ] [MainThread]: 
     
[0m18:57:36.041091 [info ] [MainThread]: ========== End Summary ==========
[0m18:57:36.041091 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:57:36.046107 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:57:36.047570 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m18:57:36.048482 [debug] [MainThread]: On master: Close
[0m18:57:36.049479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:36.049479 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:57:36.050479 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m18:57:36.050479 [debug] [MainThread]: Connection 'seed.dbtlearn.seed_full_moon_dates' was properly closed.
[0m18:57:36.051472 [info ] [MainThread]: 
[0m18:57:36.051886 [info ] [MainThread]: Finished running 1 project hook, 1 seed in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m18:57:36.053505 [debug] [MainThread]: Command end result
[0m18:57:36.104332 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:57:36.107173 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:57:36.113806 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:57:36.114340 [info ] [MainThread]: 
[0m18:57:36.115301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:57:36.115301 [info ] [MainThread]: 
[0m18:57:36.117296 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:57:36.119323 [debug] [MainThread]: Command `dbt seed` succeeded at 18:57:36.118294 after 2.39 seconds
[0m18:57:36.119323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216B89E030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216E3BC350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216BC28FB0>]}
[0m18:57:36.119323 [debug] [MainThread]: Flushing usage events
[0m18:57:36.633292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:45.911594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025253D18B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025253D1B830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025253D1B8F0>]}


============================== 18:57:45.916606 | 91d0ab96-ddef-445e-8088-6fdf537ad886 ==============================
[0m18:57:45.916606 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:57:45.917578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_fullmoon_reviews', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:46.129874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91d0ab96-ddef-445e-8088-6fdf537ad886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252510CD7F0>]}
[0m18:57:46.198272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91d0ab96-ddef-445e-8088-6fdf537ad886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252512B7E00>]}
[0m18:57:46.199645 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:57:46.422595 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:57:46.744727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:57:46.745726 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:57:46.840311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91d0ab96-ddef-445e-8088-6fdf537ad886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025253F3F410>]}
[0m18:57:47.012739 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:57:47.017150 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:57:47.052219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91d0ab96-ddef-445e-8088-6fdf537ad886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002525411E780>]}
[0m18:57:47.052219 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:57:47.053515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d0ab96-ddef-445e-8088-6fdf537ad886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252534FD2B0>]}
[0m18:57:47.055243 [info ] [MainThread]: 
[0m18:57:47.056252 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:57:47.057208 [info ] [MainThread]: 
[0m18:57:47.058235 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:57:47.059202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:57:47.142802 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:57:47.143799 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:57:47.143799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:47.183024 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.039 seconds
[0m18:57:47.184533 [debug] [ThreadPool]: On list_DBT: Close
[0m18:57:47.189806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m18:57:47.195691 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:57:47.196688 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:57:47.196688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:47.228747 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m18:57:47.228747 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:57:47.229737 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:57:47.235620 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:57:47.237646 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:57:47.238185 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:57:47.238185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m18:57:47.240214 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:57:47.241501 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:57:47.241501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:47.274998 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m18:57:47.274998 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:57:47.275965 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:57:47.282916 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m18:57:47.283944 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:57:47.284919 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:57:47.292932 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:47.292932 [debug] [MainThread]: On master: BEGIN
[0m18:57:47.293929 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:47.325476 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m18:57:47.325476 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:47.326507 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:57:47.335310 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m18:57:47.337306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d0ab96-ddef-445e-8088-6fdf537ad886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252511627E0>]}
[0m18:57:47.337306 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:47.338303 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:47.338303 [debug] [MainThread]: On master: BEGIN
[0m18:57:47.339002 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:57:47.339002 [debug] [MainThread]: On master: COMMIT
[0m18:57:47.339002 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:47.340035 [debug] [MainThread]: On master: COMMIT
[0m18:57:47.340035 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:47.341034 [debug] [MainThread]: On master: Close
[0m18:57:47.342994 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m18:57:47.344023 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.mart_fullmoon_reviews ......................... [RUN]
[0m18:57:47.344988 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m18:57:47.344988 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m18:57:47.353996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:57:47.354961 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m18:57:47.397878 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:57:47.399843 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:57:47.401114 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: BEGIN
[0m18:57:47.401114 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:57:47.567089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.165 seconds
[0m18:57:47.567089 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:57:47.568113 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */

  
    

  create  table "DBT"."raw"."mart_fullmoon_reviews__dbt_tmp"
  
  
    as
  
  (
    

WITH fct_reviews AS (
    SELECT * FROM "DBT"."raw"."fct_reviews"
),
full_moon_dates AS (
    SELECT * FROM "DBT"."raw"."seed_full_moon_dates"
)

SELECT
  r.*,
  CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
  END AS is_full_moon
FROM
  fct_reviews
  r
  LEFT JOIN full_moon_dates
  fm
  ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
  );
  
[0m18:57:47.588335 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function to_date(timestamp without time zone) does not exist
LINE 32:   ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_...
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:57:47.589367 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: ROLLBACK
[0m18:57:47.590717 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m18:57:47.598343 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  function to_date(timestamp without time zone) does not exist
  LINE 32:   ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_...
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbtlearn\models\mart\mart_fullmoon_reviews.sql
[0m18:57:47.601487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d0ab96-ddef-445e-8088-6fdf537ad886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252559F8710>]}
[0m18:57:47.602468 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model raw.mart_fullmoon_reviews ................ [[31mERROR[0m in 0.25s]
[0m18:57:47.603845 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m18:57:47.605754 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.mart_fullmoon_reviews' to be skipped because of status 'error'.  Reason: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  function to_date(timestamp without time zone) does not exist
  LINE 32:   ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_...
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbtlearn\models\mart\mart_fullmoon_reviews.sql.
[0m18:57:47.607720 [info ] [MainThread]: 
[0m18:57:47.609006 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:47.609714 [debug] [MainThread]: On master: BEGIN
[0m18:57:47.610822 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:47.801881 [debug] [MainThread]: SQL status: BEGIN in 0.191 seconds
[0m18:57:47.801881 [debug] [MainThread]: On master: COMMIT
[0m18:57:47.802879 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:47.803906 [debug] [MainThread]: On master: COMMIT
[0m18:57:47.803906 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:47.817866 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:57:47.821826 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:47.822823 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.mart_fullmoon_reviews', 'table',
'2025-01-22 17:57:45.859158+00:00',
'2025-01-22 17:57:47.344988',
'2025-01-22 17:57:47.590717'
,'error','0.25470471382141113',
'91d0ab96-ddef-445e-8088-6fdf537ad886','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m18:57:47.845079 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.022 seconds
[0m18:57:47.847103 [info ] [MainThread]: 
     
[0m18:57:47.847736 [info ] [MainThread]: ========== End Summary ==========
[0m18:57:47.849579 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:57:47.855564 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:57:47.857558 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.05s]
[0m18:57:47.858555 [debug] [MainThread]: On master: Close
[0m18:57:47.858555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:47.859552 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:57:47.859552 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m18:57:47.859552 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m18:57:47.860642 [info ] [MainThread]: 
[0m18:57:47.860642 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m18:57:47.862575 [debug] [MainThread]: Command end result
[0m18:57:47.908529 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:57:47.911735 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:57:47.918532 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:57:47.919404 [info ] [MainThread]: 
[0m18:57:47.920389 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:57:47.920389 [info ] [MainThread]: 
[0m18:57:47.921399 [error] [MainThread]:   Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  function to_date(timestamp without time zone) does not exist
  LINE 32:   ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_...
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbtlearn\models\mart\mart_fullmoon_reviews.sql
[0m18:57:47.922384 [info ] [MainThread]: 
[0m18:57:47.923380 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:57:47.924406 [debug] [MainThread]: Command `dbt run` failed at 18:57:47.924406 after 2.16 seconds
[0m18:57:47.924406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002524DC22090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002525109D430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002524F88ECC0>]}
[0m18:57:47.924406 [debug] [MainThread]: Flushing usage events
[0m18:57:48.379334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:58:20.922981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F804D273E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F804BB1D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F804BB2F90>]}


============================== 18:58:20.928191 | 6c52cc3a-0c9e-49dc-a574-ad6ce9b21dc0 ==============================
[0m18:58:20.928191 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:58:20.929155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_fullmoon_reviews', 'send_anonymous_usage_stats': 'True'}
[0m18:58:21.146248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c52cc3a-0c9e-49dc-a574-ad6ce9b21dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F804EAD670>]}
[0m18:58:21.214061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c52cc3a-0c9e-49dc-a574-ad6ce9b21dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F804E60260>]}
[0m18:58:21.215607 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:58:21.442996 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:58:21.764623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:58:21.764623 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models\mart\mart_fullmoon_reviews.sql
[0m18:58:22.108388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c52cc3a-0c9e-49dc-a574-ad6ce9b21dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F806679280>]}
[0m18:58:22.278405 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:58:22.282860 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:58:22.318372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c52cc3a-0c9e-49dc-a574-ad6ce9b21dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F80626C290>]}
[0m18:58:22.319238 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m18:58:22.320234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c52cc3a-0c9e-49dc-a574-ad6ce9b21dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F805042150>]}
[0m18:58:22.322254 [info ] [MainThread]: 
[0m18:58:22.322799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:58:22.323257 [info ] [MainThread]: 
[0m18:58:22.324233 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:58:22.325325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m18:58:22.405013 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m18:58:22.405013 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m18:58:22.406010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:22.444720 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.039 seconds
[0m18:58:22.445749 [debug] [ThreadPool]: On list_DBT: Close
[0m18:58:22.451025 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m18:58:22.458008 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:58:22.458008 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m18:58:22.458008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:22.491301 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m18:58:22.491301 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m18:58:22.491301 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:58:22.498394 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m18:58:22.499395 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m18:58:22.500580 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m18:58:22.500580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_raw, now list_DBT_DEV)
[0m18:58:22.506377 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:58:22.506377 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m18:58:22.507374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:22.546388 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m18:58:22.546388 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m18:58:22.547416 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m18:58:22.553448 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:58:22.555442 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m18:58:22.556042 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m18:58:22.560999 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:22.560999 [debug] [MainThread]: On master: BEGIN
[0m18:58:22.561994 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:22.592974 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m18:58:22.592974 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:22.593907 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:58:22.601779 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m18:58:22.603742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c52cc3a-0c9e-49dc-a574-ad6ce9b21dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F806C21B50>]}
[0m18:58:22.604739 [debug] [MainThread]: On master: ROLLBACK
[0m18:58:22.605398 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:22.605398 [debug] [MainThread]: On master: BEGIN
[0m18:58:22.606283 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:58:22.606283 [debug] [MainThread]: On master: COMMIT
[0m18:58:22.606283 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:22.607281 [debug] [MainThread]: On master: COMMIT
[0m18:58:22.607874 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:58:22.608283 [debug] [MainThread]: On master: Close
[0m18:58:22.610243 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m18:58:22.610243 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.mart_fullmoon_reviews ......................... [RUN]
[0m18:58:22.611308 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m18:58:22.612269 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m18:58:22.620248 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:58:22.621248 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m18:58:22.664134 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:58:22.665128 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:58:22.665128 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: BEGIN
[0m18:58:22.666128 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:58:22.851590 [debug] [Thread-1 (]: SQL status: BEGIN in 0.185 seconds
[0m18:58:22.852323 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:58:22.853321 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */

  
    

  create  table "DBT"."raw"."mart_fullmoon_reviews__dbt_tmp"
  
  
    as
  
  (
    
WITH fct_reviews AS (
    select * from "DBT"."raw"."fct_reviews"
),
full_moon_dates AS (
    select * from "DBT"."raw"."seed_full_moon_dates"
)
select r.*,
case
when fm.full_moon_date IS NULL THEN 'not full moon'
else 'full moon'
END AS is_full_moon
from
fct_reviews r
left join full_moon_dates fm 
--on (TO_DATE(r.review_date) = DATEADD(DAY,1, fm.full_moon_date))
ON (r.review_date::date = fm.full_moon_date + INTERVAL '1 day')
  );
  
[0m18:58:27.064906 [debug] [Thread-1 (]: SQL status: SELECT 409697 in 4.211 seconds
[0m18:58:27.075902 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:58:27.076897 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
alter table "DBT"."raw"."mart_fullmoon_reviews__dbt_tmp" rename to "mart_fullmoon_reviews"
[0m18:58:27.077895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:58:27.097844 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: COMMIT
[0m18:58:27.098842 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:58:27.098842 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: COMMIT
[0m18:58:27.107098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m18:58:27.114104 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."mart_fullmoon_reviews__dbt_backup"
[0m18:58:27.119099 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:58:27.119099 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
drop table if exists "DBT"."raw"."mart_fullmoon_reviews__dbt_backup" cascade
[0m18:58:27.120200 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:58:27.123091 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m18:58:27.125383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c52cc3a-0c9e-49dc-a574-ad6ce9b21dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F80651BF80>]}
[0m18:58:27.126046 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.mart_fullmoon_reviews .................... [[32mSELECT 409697[0m in 4.51s]
[0m18:58:27.127079 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m18:58:27.128051 [info ] [MainThread]: 
[0m18:58:27.129061 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:27.129061 [debug] [MainThread]: On master: BEGIN
[0m18:58:27.129061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:27.164073 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m18:58:27.164073 [debug] [MainThread]: On master: COMMIT
[0m18:58:27.164073 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:27.165102 [debug] [MainThread]: On master: COMMIT
[0m18:58:27.165799 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:58:27.177077 [info ] [MainThread]: ========== Begin Summary ==========
[0m18:58:27.181028 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:27.181028 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.mart_fullmoon_reviews', 'table',
'2025-01-22 17:58:20.853727+00:00',
'2025-01-22 17:58:22.612269',
'2025-01-22 17:58:27.123091'
,'success','4.511782884597778',
'6c52cc3a-0c9e-49dc-a574-ad6ce9b21dc0','1.9.1',CURRENT_TIMESTAMP(0),'409697');
           
      
  
[0m18:58:27.184020 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m18:58:27.186046 [info ] [MainThread]: 
     
[0m18:58:27.186833 [info ] [MainThread]: ========== End Summary ==========
[0m18:58:27.187709 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m18:58:27.193720 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m18:58:27.194847 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m18:58:27.195728 [debug] [MainThread]: On master: Close
[0m18:58:27.196726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:27.196726 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m18:58:27.196726 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m18:58:27.197758 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m18:58:27.197758 [info ] [MainThread]: 
[0m18:58:27.198720 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m18:58:27.200715 [debug] [MainThread]: Command end result
[0m18:58:27.324468 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m18:58:27.327527 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m18:58:27.333812 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m18:58:27.334357 [info ] [MainThread]: 
[0m18:58:27.335369 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:27.335369 [info ] [MainThread]: 
[0m18:58:27.336353 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:58:27.337349 [debug] [MainThread]: Command `dbt run` succeeded at 18:58:27.337349 after 6.58 seconds
[0m18:58:27.338377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F802AABE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F802AABFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F804AEB8F0>]}
[0m18:58:27.338377 [debug] [MainThread]: Flushing usage events
[0m18:58:27.896824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:25.982575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002228FC26DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002228FC24380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002228FC25B80>]}


============================== 12:41:26.012896 | 0329a008-73fe-4d78-a1f6-f7a8c5e3821e ==============================
[0m12:41:26.012896 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:41:26.015394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:26.085902 [info ] [MainThread]: dbt version: 1.9.1
[0m12:41:26.086872 [info ] [MainThread]: python version: 3.12.6
[0m12:41:26.087880 [info ] [MainThread]: python path: C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\env\Scripts\python.exe
[0m12:41:26.088859 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m12:41:26.304691 [info ] [MainThread]: Using profiles dir at C:\Users\admin\.dbt
[0m12:41:26.306100 [info ] [MainThread]: Using profiles.yml file at C:\Users\admin\.dbt\profiles.yml
[0m12:41:26.306646 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\dbt_project.yml
[0m12:41:26.308877 [info ] [MainThread]: adapter type: postgres
[0m12:41:26.309639 [info ] [MainThread]: adapter version: 1.9.0
[0m12:41:26.425334 [info ] [MainThread]: Configuration:
[0m12:41:26.426538 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:41:26.427345 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:41:26.428070 [info ] [MainThread]: Required dependencies:
[0m12:41:26.428320 [debug] [MainThread]: Executing "git --help"
[0m12:41:26.476606 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:41:26.477635 [debug] [MainThread]: STDERR: "b''"
[0m12:41:26.477635 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:41:26.478895 [info ] [MainThread]: Connection:
[0m12:41:26.479598 [info ] [MainThread]:   host: localhost
[0m12:41:26.480595 [info ] [MainThread]:   port: 5432
[0m12:41:26.480595 [info ] [MainThread]:   user: postgres
[0m12:41:26.481642 [info ] [MainThread]:   database: DBT
[0m12:41:26.482621 [info ] [MainThread]:   schema: raw
[0m12:41:26.482621 [info ] [MainThread]:   connect_timeout: 10
[0m12:41:26.483587 [info ] [MainThread]:   role: None
[0m12:41:26.484585 [info ] [MainThread]:   search_path: None
[0m12:41:26.485582 [info ] [MainThread]:   keepalives_idle: 0
[0m12:41:26.486580 [info ] [MainThread]:   sslmode: None
[0m12:41:26.486580 [info ] [MainThread]:   sslcert: None
[0m12:41:26.487576 [info ] [MainThread]:   sslkey: None
[0m12:41:26.488575 [info ] [MainThread]:   sslrootcert: None
[0m12:41:26.489573 [info ] [MainThread]:   application_name: dbt
[0m12:41:26.490569 [info ] [MainThread]:   retries: 1
[0m12:41:26.492687 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:41:26.924481 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:41:31.202596 [debug] [MainThread]: Using postgres connection "debug"
[0m12:41:31.204591 [debug] [MainThread]: On debug: select 1 as id
[0m12:41:31.205589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:31.416758 [debug] [MainThread]: SQL status: SELECT 1 in 0.211 seconds
[0m12:41:31.419801 [debug] [MainThread]: On debug: Close
[0m12:41:31.420799 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:41:31.422742 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:41:31.424737 [debug] [MainThread]: Command `dbt debug` succeeded at 12:41:31.424737 after 5.79 seconds
[0m12:41:31.425733 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:41:31.426730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002228D9E9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002228D9E9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002228D9E9370>]}
[0m12:41:31.427780 [debug] [MainThread]: Flushing usage events
[0m12:41:32.276600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:09.237032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F994095820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F993A88980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F994097F80>]}


============================== 12:42:09.247994 | 7e349a0c-a934-4807-8f19-19f9d925c5f8 ==============================
[0m12:42:09.247994 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:42:09.249937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m src_hosts', 'send_anonymous_usage_stats': 'True'}
[0m12:42:09.474735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e349a0c-a934-4807-8f19-19f9d925c5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F99144D520>]}
[0m12:42:09.540560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e349a0c-a934-4807-8f19-19f9d925c5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9935ACAA0>]}
[0m12:42:09.542533 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:42:09.952433 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:42:14.899385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:42:14.899385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:42:15.002149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e349a0c-a934-4807-8f19-19f9d925c5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F994381130>]}
[0m12:42:15.173834 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:42:15.222359 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:42:15.285128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e349a0c-a934-4807-8f19-19f9d925c5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9955C9A00>]}
[0m12:42:15.285128 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:42:15.286389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e349a0c-a934-4807-8f19-19f9d925c5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F994228050>]}
[0m12:42:15.288296 [info ] [MainThread]: 
[0m12:42:15.289801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:15.290289 [info ] [MainThread]: 
[0m12:42:15.291295 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:42:15.292614 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m12:42:15.373916 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:42:15.374916 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:42:15.374916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:15.419492 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.044 seconds
[0m12:42:15.420492 [debug] [ThreadPool]: On list_DBT: Close
[0m12:42:15.428052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m12:42:15.436033 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:42:15.437031 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:42:15.437031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:15.644259 [debug] [ThreadPool]: SQL status: BEGIN in 0.207 seconds
[0m12:42:15.645295 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:42:15.647293 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:42:15.667423 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.019 seconds
[0m12:42:15.672410 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:42:15.673928 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:42:15.675703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_raw, now list_DBT_DEV)
[0m12:42:15.693357 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:42:15.697444 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:42:15.698446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:15.763068 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m12:42:15.763068 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:42:15.763939 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:42:15.778917 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m12:42:15.780902 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:42:15.782235 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:42:15.791874 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:15.791874 [debug] [MainThread]: On master: BEGIN
[0m12:42:15.792869 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:15.857829 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m12:42:15.857829 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:15.859868 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:42:15.878179 [debug] [MainThread]: SQL status: SELECT 5 in 0.018 seconds
[0m12:42:15.883214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e349a0c-a934-4807-8f19-19f9d925c5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F993C337D0>]}
[0m12:42:15.884212 [debug] [MainThread]: On master: ROLLBACK
[0m12:42:15.885209 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:15.886208 [debug] [MainThread]: On master: BEGIN
[0m12:42:15.887483 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:42:15.888199 [debug] [MainThread]: On master: COMMIT
[0m12:42:15.889196 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:15.890197 [debug] [MainThread]: On master: COMMIT
[0m12:42:15.892143 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:42:15.892143 [debug] [MainThread]: On master: Close
[0m12:42:15.897381 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:42:15.898379 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.src_hosts ..................................... [RUN]
[0m12:42:15.900861 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_hosts'
[0m12:42:15.901811 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:42:15.922825 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:42:15.924747 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m12:42:15.972654 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m12:42:15.973882 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m12:42:15.974615 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: BEGIN
[0m12:42:15.974615 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:16.029546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m12:42:16.030463 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m12:42:16.031590 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */

  
    

  create  table "DBT"."raw"."src_hosts__dbt_tmp"
  
  
    as
  
  (
    WITH raw_hosts AS (
    SELECT
        *
    FROM
       "DBT"."raw"."raw_hosts"
)
SELECT
    id AS host_id,
    NAME AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
  
[0m12:42:16.096103 [debug] [Thread-1 (]: SQL status: SELECT 14111 in 0.063 seconds
[0m12:42:16.113006 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m12:42:16.114055 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
alter table "DBT"."raw"."src_hosts" rename to "src_hosts__dbt_backup"
[0m12:42:16.115557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:16.123027 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m12:42:16.124024 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
alter table "DBT"."raw"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m12:42:16.126333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:16.152934 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: COMMIT
[0m12:42:16.153933 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m12:42:16.153933 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: COMMIT
[0m12:42:16.161299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m12:42:16.169889 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."src_hosts__dbt_backup"
[0m12:42:16.174878 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m12:42:16.175836 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
drop table if exists "DBT"."raw"."src_hosts__dbt_backup" cascade
[0m12:42:16.182154 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:42:16.184846 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m12:42:16.187804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e349a0c-a934-4807-8f19-19f9d925c5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9961F7AA0>]}
[0m12:42:16.187804 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.src_hosts ................................ [[32mSELECT 14111[0m in 0.28s]
[0m12:42:16.189010 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:42:16.190795 [info ] [MainThread]: 
[0m12:42:16.190795 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:16.191794 [debug] [MainThread]: On master: BEGIN
[0m12:42:16.191794 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:16.227222 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m12:42:16.227727 [debug] [MainThread]: On master: COMMIT
[0m12:42:16.227727 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:16.227727 [debug] [MainThread]: On master: COMMIT
[0m12:42:16.229054 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:42:16.237780 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:42:16.242661 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:16.243281 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.src_hosts', 'table',
'2025-02-02 11:42:09.134023+00:00',
'2025-02-02 11:42:15.901811',
'2025-02-02 11:42:16.184846'
,'success','0.28487348556518555',
'7e349a0c-a934-4807-8f19-19f9d925c5f8','1.9.1',CURRENT_TIMESTAMP(0),'14111');
           
      
  
[0m12:42:16.248699 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.005 seconds
[0m12:42:16.249710 [info ] [MainThread]: 
     
[0m12:42:16.251113 [info ] [MainThread]: ========== End Summary ==========
[0m12:42:16.251702 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m12:42:16.258652 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m12:42:16.260649 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m12:42:16.261645 [debug] [MainThread]: On master: Close
[0m12:42:16.263639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:16.263774 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m12:42:16.263774 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m12:42:16.264663 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m12:42:16.264663 [info ] [MainThread]: 
[0m12:42:16.265827 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m12:42:16.267628 [debug] [MainThread]: Command end result
[0m12:42:16.317494 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:42:16.320531 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:42:16.327468 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m12:42:16.327864 [info ] [MainThread]: 
[0m12:42:16.328486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:16.329463 [info ] [MainThread]: 
[0m12:42:16.330460 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:42:16.331488 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:16.331488 after 7.29 seconds
[0m12:42:16.331488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F993BFB350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F990A9C440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F993807FB0>]}
[0m12:42:16.332489 [debug] [MainThread]: Flushing usage events
[0m12:42:17.128187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:27.644747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F95770890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F98286EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F98CF7B90>]}


============================== 12:42:27.654821 | 3d7d8515-fcb7-4ca6-95f1-e346d671daee ==============================
[0m12:42:27.654821 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:42:27.656910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m src_listings', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:42:27.905741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d7d8515-fcb7-4ca6-95f1-e346d671daee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9820C800>]}
[0m12:42:27.968866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d7d8515-fcb7-4ca6-95f1-e346d671daee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F97BF3A40>]}
[0m12:42:27.970820 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:42:28.205775 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:42:28.525957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:42:28.526951 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:42:28.620157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d7d8515-fcb7-4ca6-95f1-e346d671daee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F98F3F5C0>]}
[0m12:42:28.787315 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:42:28.792287 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:42:28.832137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d7d8515-fcb7-4ca6-95f1-e346d671daee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F99129160>]}
[0m12:42:28.833135 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:42:28.834133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d7d8515-fcb7-4ca6-95f1-e346d671daee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F98E33D10>]}
[0m12:42:28.836126 [info ] [MainThread]: 
[0m12:42:28.836761 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:28.837125 [info ] [MainThread]: 
[0m12:42:28.838150 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:42:28.839150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m12:42:28.930577 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:42:28.930577 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:42:28.930577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:29.146107 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.215 seconds
[0m12:42:29.150145 [debug] [ThreadPool]: On list_DBT: Close
[0m12:42:29.162114 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m12:42:29.177073 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:42:29.178070 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:42:29.179070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:29.241842 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m12:42:29.242950 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:42:29.243868 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:42:29.256244 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.012 seconds
[0m12:42:29.258795 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:42:29.259792 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:42:29.259792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_raw, now list_DBT_DEV)
[0m12:42:29.267771 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:42:29.267771 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:42:29.268769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:29.306887 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m12:42:29.308391 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:42:29.308391 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:42:29.316133 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m12:42:29.320078 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:42:29.321322 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:42:29.329083 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:29.330084 [debug] [MainThread]: On master: BEGIN
[0m12:42:29.330084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:29.380427 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m12:42:29.381460 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:29.382459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:42:29.394425 [debug] [MainThread]: SQL status: SELECT 5 in 0.012 seconds
[0m12:42:29.397382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d7d8515-fcb7-4ca6-95f1-e346d671daee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F98EEE990>]}
[0m12:42:29.398379 [debug] [MainThread]: On master: ROLLBACK
[0m12:42:29.398379 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:29.399501 [debug] [MainThread]: On master: BEGIN
[0m12:42:29.400412 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:42:29.400412 [debug] [MainThread]: On master: COMMIT
[0m12:42:29.401408 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:29.401408 [debug] [MainThread]: On master: COMMIT
[0m12:42:29.402404 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:42:29.403366 [debug] [MainThread]: On master: Close
[0m12:42:29.406390 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:42:29.406390 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.src_listings .................................. [RUN]
[0m12:42:29.408260 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_listings'
[0m12:42:29.408260 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:42:29.421257 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:42:29.423237 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m12:42:29.467105 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m12:42:29.468104 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_listings"
[0m12:42:29.469100 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: BEGIN
[0m12:42:29.469100 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:29.523907 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m12:42:29.524865 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_listings"
[0m12:42:29.525866 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */

  
    

  create  table "DBT"."raw"."src_listings__dbt_tmp"
  
  
    as
  
  (
    -- import raw_listings
WITH raw_listings AS (
        SELECT * FROM "DBT"."raw"."raw_listings"
)
SELECT 
   id AS listing_id,
   listing_url,
   name AS listing_name,
   room_type,
   minimum_nights,
   host_id,
   price AS price_str,
   created_at,
   updated_at
FROM raw_listings
  );
  
[0m12:42:29.578118 [debug] [Thread-1 (]: SQL status: SELECT 17499 in 0.051 seconds
[0m12:42:29.595043 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_listings"
[0m12:42:29.596040 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
alter table "DBT"."raw"."src_listings" rename to "src_listings__dbt_backup"
[0m12:42:29.598038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:29.606460 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_listings"
[0m12:42:29.607007 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
alter table "DBT"."raw"."src_listings__dbt_tmp" rename to "src_listings"
[0m12:42:29.609027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:29.633951 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: COMMIT
[0m12:42:29.634949 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_listings"
[0m12:42:29.634949 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: COMMIT
[0m12:42:29.646355 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m12:42:29.661355 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."src_listings__dbt_backup"
[0m12:42:29.668331 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_listings"
[0m12:42:29.669332 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
drop table if exists "DBT"."raw"."src_listings__dbt_backup" cascade
[0m12:42:29.677276 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:42:29.680298 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m12:42:29.683264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7d8515-fcb7-4ca6-95f1-e346d671daee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F960BC740>]}
[0m12:42:29.684257 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.src_listings ............................. [[32mSELECT 17499[0m in 0.27s]
[0m12:42:29.685433 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:42:29.687249 [info ] [MainThread]: 
[0m12:42:29.687249 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:29.688247 [debug] [MainThread]: On master: BEGIN
[0m12:42:29.688247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:29.729182 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m12:42:29.730213 [debug] [MainThread]: On master: COMMIT
[0m12:42:29.730213 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:29.731210 [debug] [MainThread]: On master: COMMIT
[0m12:42:29.731753 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:42:29.744170 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:42:29.748165 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:29.749157 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.src_listings', 'table',
'2025-02-02 11:42:27.537137+00:00',
'2025-02-02 11:42:29.409294',
'2025-02-02 11:42:29.680298'
,'success','0.27353692054748535',
'3d7d8515-fcb7-4ca6-95f1-e346d671daee','1.9.1',CURRENT_TIMESTAMP(0),'17499');
           
      
  
[0m12:42:29.752216 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.003 seconds
[0m12:42:29.754239 [info ] [MainThread]: 
     
[0m12:42:29.755255 [info ] [MainThread]: ========== End Summary ==========
[0m12:42:29.756049 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m12:42:29.765052 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m12:42:29.766021 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m12:42:29.767046 [debug] [MainThread]: On master: Close
[0m12:42:29.768044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:29.768044 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m12:42:29.769015 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m12:42:29.769015 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m12:42:29.770012 [info ] [MainThread]: 
[0m12:42:29.770725 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m12:42:29.772009 [debug] [MainThread]: Command end result
[0m12:42:29.818911 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:42:29.822869 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:42:29.829850 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m12:42:29.830291 [info ] [MainThread]: 
[0m12:42:29.830884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:29.831876 [info ] [MainThread]: 
[0m12:42:29.832854 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:42:29.833841 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:29.833841 after 2.40 seconds
[0m12:42:29.833841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F98B838F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F96AC91C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F96AC90D0>]}
[0m12:42:29.834837 [debug] [MainThread]: Flushing usage events
[0m12:42:30.541859 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:40.931514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CFA76C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CFA740E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CFA74590>]}


============================== 12:42:40.942487 | 2ec7c296-8ca4-4d83-b680-3cd17306b014 ==============================
[0m12:42:40.942487 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:42:40.944492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m src_reviews', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:42:41.162121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ec7c296-8ca4-4d83-b680-3cd17306b014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CFA4EB40>]}
[0m12:42:41.224137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ec7c296-8ca4-4d83-b680-3cd17306b014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CEF00560>]}
[0m12:42:41.225183 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:42:41.454244 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:42:41.780036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:42:41.780036 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:42:41.876789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ec7c296-8ca4-4d83-b680-3cd17306b014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CFDCD790>]}
[0m12:42:42.049570 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:42:42.053558 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:42:42.092025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ec7c296-8ca4-4d83-b680-3cd17306b014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235D0FC3F20>]}
[0m12:42:42.093062 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:42:42.094020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec7c296-8ca4-4d83-b680-3cd17306b014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235D10D6D20>]}
[0m12:42:42.096014 [info ] [MainThread]: 
[0m12:42:42.096859 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:42.097759 [info ] [MainThread]: 
[0m12:42:42.097759 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:42:42.099767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m12:42:42.182863 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:42:42.183894 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:42:42.183894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:42.232556 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.049 seconds
[0m12:42:42.235424 [debug] [ThreadPool]: On list_DBT: Close
[0m12:42:42.245284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m12:42:42.260265 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:42:42.261263 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:42:42.261263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:42.309315 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m12:42:42.309315 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:42:42.310345 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:42:42.319182 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m12:42:42.321222 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:42:42.322429 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:42:42.323289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m12:42:42.327163 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:42:42.327163 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:42:42.328207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:42.392979 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m12:42:42.394023 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:42:42.395017 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:42:42.409987 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.015 seconds
[0m12:42:42.414973 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:42:42.416303 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:42:42.440054 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:42.440904 [debug] [MainThread]: On master: BEGIN
[0m12:42:42.440904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:42.479302 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m12:42:42.480088 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:42.480088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:42:42.490724 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m12:42:42.492721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec7c296-8ca4-4d83-b680-3cd17306b014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CCEC2C30>]}
[0m12:42:42.492721 [debug] [MainThread]: On master: ROLLBACK
[0m12:42:42.494106 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:42.494106 [debug] [MainThread]: On master: BEGIN
[0m12:42:42.495194 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:42:42.495194 [debug] [MainThread]: On master: COMMIT
[0m12:42:42.496137 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:42.496137 [debug] [MainThread]: On master: COMMIT
[0m12:42:42.497066 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:42:42.497066 [debug] [MainThread]: On master: Close
[0m12:42:42.500060 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:42:42.500060 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.src_reviews ................................... [RUN]
[0m12:42:42.501259 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_reviews'
[0m12:42:42.502081 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:42:42.512059 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:42:42.532577 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m12:42:42.597391 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m12:42:42.598748 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m12:42:42.599383 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: BEGIN
[0m12:42:42.599383 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:42.785411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.186 seconds
[0m12:42:42.786458 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m12:42:42.787454 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */

  
    

  create  table "DBT"."raw"."src_reviews__dbt_tmp"
  
  
    as
  
  (
    WITH raw_reviews AS (
    SELECT
        *
    FROM
        "DBT"."raw"."raw_reviews"
)
SELECT
    listing_id,
    review_date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
  
[0m12:42:47.658979 [debug] [Thread-1 (]: SQL status: SELECT 410284 in 4.870 seconds
[0m12:42:47.668840 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m12:42:47.669837 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
alter table "DBT"."raw"."src_reviews" rename to "src_reviews__dbt_backup"
[0m12:42:47.670980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:47.673758 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m12:42:47.674758 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
alter table "DBT"."raw"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m12:42:47.675719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:42:47.694703 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: COMMIT
[0m12:42:47.695703 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m12:42:47.695703 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: COMMIT
[0m12:42:47.708414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m12:42:47.727412 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."src_reviews__dbt_backup"
[0m12:42:47.735377 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m12:42:47.735377 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
drop table if exists "DBT"."raw"."src_reviews__dbt_backup" cascade
[0m12:42:47.749995 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m12:42:47.755871 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m12:42:47.760497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec7c296-8ca4-4d83-b680-3cd17306b014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CEF25C40>]}
[0m12:42:47.762448 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.src_reviews .............................. [[32mSELECT 410284[0m in 5.26s]
[0m12:42:47.764485 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:42:47.766478 [info ] [MainThread]: 
[0m12:42:47.767618 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:47.768474 [debug] [MainThread]: On master: BEGIN
[0m12:42:47.768474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:47.826038 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m12:42:47.826038 [debug] [MainThread]: On master: COMMIT
[0m12:42:47.827036 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:47.827036 [debug] [MainThread]: On master: COMMIT
[0m12:42:47.828122 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:42:47.840091 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:42:47.844083 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:47.845081 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.src_reviews', 'table',
'2025-02-02 11:42:40.827736+00:00',
'2025-02-02 11:42:42.502081',
'2025-02-02 11:42:47.755871'
,'success','5.255653381347656',
'2ec7c296-8ca4-4d83-b680-3cd17306b014','1.9.1',CURRENT_TIMESTAMP(0),'410284');
           
      
  
[0m12:42:47.850221 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.005 seconds
[0m12:42:47.852249 [info ] [MainThread]: 
     
[0m12:42:47.853217 [info ] [MainThread]: ========== End Summary ==========
[0m12:42:47.854216 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m12:42:47.860199 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m12:42:47.861688 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m12:42:47.862584 [debug] [MainThread]: On master: Close
[0m12:42:47.864702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:47.865542 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m12:42:47.865542 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m12:42:47.866539 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m12:42:47.866539 [info ] [MainThread]: 
[0m12:42:47.868014 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m12:42:47.869532 [debug] [MainThread]: Command end result
[0m12:42:47.922389 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:42:47.925436 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:42:47.933027 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m12:42:47.933359 [info ] [MainThread]: 
[0m12:42:47.934383 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:47.935471 [info ] [MainThread]: 
[0m12:42:47.935471 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:42:47.937399 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:47.937399 after 7.21 seconds
[0m12:42:47.937399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CD0632C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CF7E0D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CEE98F50>]}
[0m12:42:47.938379 [debug] [MainThread]: Flushing usage events
[0m12:42:48.710778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:29.281850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E247774140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E247777170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E247777BC0>]}


============================== 12:43:29.289868 | b25c571e-5e22-4946-bda0-63626b17aed3 ==============================
[0m12:43:29.289868 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:43:29.291982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_hosts_cleansed', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:43:29.512872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b25c571e-5e22-4946-bda0-63626b17aed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24796F8F0>]}
[0m12:43:29.579957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b25c571e-5e22-4946-bda0-63626b17aed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2477CCFB0>]}
[0m12:43:29.581087 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:43:29.810828 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:43:30.129490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:30.130487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:30.224762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b25c571e-5e22-4946-bda0-63626b17aed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E247BBCC80>]}
[0m12:43:30.390473 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:43:30.394264 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:43:30.426544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b25c571e-5e22-4946-bda0-63626b17aed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E248FA2AE0>]}
[0m12:43:30.426544 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:43:30.427540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b25c571e-5e22-4946-bda0-63626b17aed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E248F548F0>]}
[0m12:43:30.429534 [info ] [MainThread]: 
[0m12:43:30.430502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:30.430502 [info ] [MainThread]: 
[0m12:43:30.431531 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:30.432894 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m12:43:30.511309 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:43:30.511309 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:43:30.512308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:30.574187 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.062 seconds
[0m12:43:30.580170 [debug] [ThreadPool]: On list_DBT: Close
[0m12:43:30.599460 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m12:43:30.616419 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:43:30.616419 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:43:30.617416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:30.666187 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m12:43:30.667116 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:43:30.667116 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:43:30.679710 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m12:43:30.682743 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:43:30.683890 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:43:30.684729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m12:43:30.688719 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:43:30.689894 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:43:30.690719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:30.747352 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m12:43:30.747352 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:43:30.748310 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:43:30.756285 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.008 seconds
[0m12:43:30.758312 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:43:30.759067 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:43:30.769251 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:30.769251 [debug] [MainThread]: On master: BEGIN
[0m12:43:30.769251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:30.802163 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m12:43:30.803197 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:30.803197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:43:30.813133 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m12:43:30.815164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b25c571e-5e22-4946-bda0-63626b17aed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E244BC2B40>]}
[0m12:43:30.816162 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:30.816162 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:30.817160 [debug] [MainThread]: On master: BEGIN
[0m12:43:30.818121 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:43:30.818121 [debug] [MainThread]: On master: COMMIT
[0m12:43:30.818121 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:30.819154 [debug] [MainThread]: On master: COMMIT
[0m12:43:30.819718 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:30.820150 [debug] [MainThread]: On master: Close
[0m12:43:30.822111 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:43:30.823166 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.dim_hosts_cleansed ............................ [RUN]
[0m12:43:30.824106 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.dim_hosts_cleansed'
[0m12:43:30.824106 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:43:30.833121 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:43:30.841026 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:43:30.885666 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:43:30.890786 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:43:30.891783 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: BEGIN
[0m12:43:30.892780 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:43:31.077956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.185 seconds
[0m12:43:31.078990 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:43:31.079991 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */

  
    

  create  table "DBT"."raw"."dim_hosts_cleansed__dbt_tmp"
  
  
    as
  
  (
    WITH src_hosts AS (
    SELECT * FROM "DBT"."raw"."src_hosts"
)
SELECT 
    host_id,
    COALESCE(host_name, 'Anonymous') AS name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
  
[0m12:43:31.121541 [debug] [Thread-1 (]: SQL status: SELECT 14111 in 0.041 seconds
[0m12:43:31.134552 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:43:31.135548 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
alter table "DBT"."raw"."dim_hosts_cleansed" rename to "dim_hosts_cleansed__dbt_backup"
[0m12:43:31.137496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:31.144524 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:43:31.145522 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
alter table "DBT"."raw"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m12:43:31.147507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:31.178423 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: COMMIT
[0m12:43:31.178423 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:43:31.179421 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: COMMIT
[0m12:43:31.181378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:43:31.192349 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."dim_hosts_cleansed__dbt_backup"
[0m12:43:31.198332 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:43:31.199330 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop table if exists "DBT"."raw"."dim_hosts_cleansed__dbt_backup" cascade
[0m12:43:31.210318 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m12:43:31.214307 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m12:43:31.217684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b25c571e-5e22-4946-bda0-63626b17aed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E244B2C9B0>]}
[0m12:43:31.218718 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.dim_hosts_cleansed ....................... [[32mSELECT 14111[0m in 0.39s]
[0m12:43:31.220708 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:43:31.221820 [info ] [MainThread]: 
[0m12:43:31.222670 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:31.223702 [debug] [MainThread]: On master: BEGIN
[0m12:43:31.223702 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:31.269248 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m12:43:31.269248 [debug] [MainThread]: On master: COMMIT
[0m12:43:31.270177 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:31.270177 [debug] [MainThread]: On master: COMMIT
[0m12:43:31.271187 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:31.281119 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:43:31.285162 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:31.285162 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.dim_hosts_cleansed', 'table',
'2025-02-02 11:43:29.176305+00:00',
'2025-02-02 11:43:30.824106',
'2025-02-02 11:43:31.213321'
,'success','0.39054274559020996',
'b25c571e-5e22-4946-bda0-63626b17aed3','1.9.1',CURRENT_TIMESTAMP(0),'14111');
           
      
  
[0m12:43:31.288329 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m12:43:31.289326 [info ] [MainThread]: 
     
[0m12:43:31.290878 [info ] [MainThread]: ========== End Summary ==========
[0m12:43:31.291556 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m12:43:31.299535 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m12:43:31.300553 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m12:43:31.301596 [debug] [MainThread]: On master: Close
[0m12:43:31.301596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:31.302563 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m12:43:31.302563 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m12:43:31.303557 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m12:43:31.303557 [info ] [MainThread]: 
[0m12:43:31.304721 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m12:43:31.306519 [debug] [MainThread]: Command end result
[0m12:43:31.354599 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:43:31.357117 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:43:31.364362 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m12:43:31.364362 [info ] [MainThread]: 
[0m12:43:31.365362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:31.366357 [info ] [MainThread]: 
[0m12:43:31.367356 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:43:31.368396 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:31.368396 after 2.28 seconds
[0m12:43:31.368396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E246EE4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E245539550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E245539610>]}
[0m12:43:31.369383 [debug] [MainThread]: Flushing usage events
[0m12:43:32.187683 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:50.050124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022019785D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022018F28980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022019785760>]}


============================== 12:43:50.060323 | caa64bf9-f827-4928-99a0-90281933682e ==============================
[0m12:43:50.060323 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:43:50.062446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_listings_cleansed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:43:50.287545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caa64bf9-f827-4928-99a0-90281933682e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022019786AE0>]}
[0m12:43:50.351023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caa64bf9-f827-4928-99a0-90281933682e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220175490A0>]}
[0m12:43:50.353018 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:43:50.579501 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:43:50.908476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:50.908476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:51.000230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caa64bf9-f827-4928-99a0-90281933682e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022019A44080>]}
[0m12:43:51.167159 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:43:51.171149 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:43:51.206631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caa64bf9-f827-4928-99a0-90281933682e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201AD882C0>]}
[0m12:43:51.207519 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:43:51.208569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa64bf9-f827-4928-99a0-90281933682e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220198E1F40>]}
[0m12:43:51.210548 [info ] [MainThread]: 
[0m12:43:51.211582 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:51.212506 [info ] [MainThread]: 
[0m12:43:51.212506 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:51.213539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m12:43:51.298312 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:43:51.299310 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:43:51.299310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:51.339311 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.040 seconds
[0m12:43:51.341333 [debug] [ThreadPool]: On list_DBT: Close
[0m12:43:51.347043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m12:43:51.354009 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:43:51.354009 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:43:51.355008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:51.390220 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m12:43:51.390220 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:43:51.390220 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:43:51.398724 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.007 seconds
[0m12:43:51.400665 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:43:51.401328 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:43:51.401659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_raw, now list_DBT_DEV)
[0m12:43:51.404651 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:43:51.411626 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:43:51.412621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:51.451969 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m12:43:51.451969 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:43:51.453005 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:43:51.461608 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m12:43:51.463570 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:43:51.463570 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:43:51.471581 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:51.471581 [debug] [MainThread]: On master: BEGIN
[0m12:43:51.472579 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:51.518108 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m12:43:51.518108 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:51.519139 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:43:51.536541 [debug] [MainThread]: SQL status: SELECT 3 in 0.016 seconds
[0m12:43:51.539502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa64bf9-f827-4928-99a0-90281933682e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201995EB70>]}
[0m12:43:51.540500 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:51.542494 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:51.542494 [debug] [MainThread]: On master: BEGIN
[0m12:43:51.544385 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:43:51.545324 [debug] [MainThread]: On master: COMMIT
[0m12:43:51.546316 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:51.547314 [debug] [MainThread]: On master: COMMIT
[0m12:43:51.548357 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:51.549261 [debug] [MainThread]: On master: Close
[0m12:43:51.553251 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:43:51.555292 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.dim_listings_cleansed ......................... [RUN]
[0m12:43:51.557287 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.dim_listings_cleansed'
[0m12:43:51.558287 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:43:51.578188 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:43:51.584173 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:43:51.644577 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m12:43:51.645849 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m12:43:51.646577 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: BEGIN
[0m12:43:51.646577 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:43:51.690693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m12:43:51.691747 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m12:43:51.692736 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */

  
    

  create  table "DBT"."raw"."dim_listings_cleansed__dbt_tmp"
  
  
    as
  
  (
    WITH src_listings AS (
    SELECT * FROM "DBT"."raw"."src_listings"
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights 
    END AS minimum_nights,
    host_id,
    ROUND(REPLACE(price_str, '$', '')::NUMERIC, 2) as price_str,
    created_at,
    updated_at
FROM src_listings
  );
  
[0m12:43:51.756753 [debug] [Thread-1 (]: SQL status: SELECT 17499 in 0.063 seconds
[0m12:43:51.767717 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m12:43:51.767717 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
alter table "DBT"."raw"."dim_listings_cleansed" rename to "dim_listings_cleansed__dbt_backup"
[0m12:43:51.769678 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:51.772708 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m12:43:51.773710 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
alter table "DBT"."raw"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m12:43:51.774664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:51.794647 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: COMMIT
[0m12:43:51.794647 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m12:43:51.795633 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: COMMIT
[0m12:43:51.805703 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m12:43:51.822671 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."dim_listings_cleansed__dbt_backup"
[0m12:43:51.833626 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m12:43:51.834625 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop table if exists "DBT"."raw"."dim_listings_cleansed__dbt_backup" cascade
[0m12:43:51.847829 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m12:43:51.851818 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:43:51.856805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa64bf9-f827-4928-99a0-90281933682e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022018C35EE0>]}
[0m12:43:51.857834 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.dim_listings_cleansed .................... [[32mSELECT 17499[0m in 0.30s]
[0m12:43:51.859798 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:43:51.861793 [info ] [MainThread]: 
[0m12:43:51.862825 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:51.863826 [debug] [MainThread]: On master: BEGIN
[0m12:43:51.863826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:51.916996 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m12:43:51.917760 [debug] [MainThread]: On master: COMMIT
[0m12:43:51.917760 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:51.918761 [debug] [MainThread]: On master: COMMIT
[0m12:43:51.918761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:51.929732 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:43:51.933686 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:51.933686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.dim_listings_cleansed', 'table',
'2025-02-02 11:43:49.942869+00:00',
'2025-02-02 11:43:51.558287',
'2025-02-02 11:43:51.851818'
,'success','0.296572208404541',
'caa64bf9-f827-4928-99a0-90281933682e','1.9.1',CURRENT_TIMESTAMP(0),'17499');
           
      
  
[0m12:43:51.936831 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.003 seconds
[0m12:43:51.938861 [info ] [MainThread]: 
     
[0m12:43:51.939824 [info ] [MainThread]: ========== End Summary ==========
[0m12:43:51.940822 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m12:43:51.946807 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m12:43:51.947801 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m12:43:51.949361 [debug] [MainThread]: On master: Close
[0m12:43:51.949797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:51.950794 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m12:43:51.950794 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m12:43:51.951793 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m12:43:51.952789 [info ] [MainThread]: 
[0m12:43:51.954818 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m12:43:51.956779 [debug] [MainThread]: Command end result
[0m12:43:52.004807 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:43:52.007298 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:43:52.014624 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m12:43:52.014624 [info ] [MainThread]: 
[0m12:43:52.015621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:52.016619 [info ] [MainThread]: 
[0m12:43:52.017410 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:43:52.018320 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:52.018320 after 2.17 seconds
[0m12:43:52.018320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022019453CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201975E120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220194F1D00>]}
[0m12:43:52.019316 [debug] [MainThread]: Flushing usage events
[0m12:43:52.872698 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:44:11.228554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020938034FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209380350D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209380340E0>]}


============================== 12:44:11.239568 | 4672ef33-5c37-4e01-b0d5-3a98773f4935 ==============================
[0m12:44:11.239568 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:44:11.241678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m dim_listings_w_hosts', 'send_anonymous_usage_stats': 'True'}
[0m12:44:11.476543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4672ef33-5c37-4e01-b0d5-3a98773f4935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020938056E70>]}
[0m12:44:11.540696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4672ef33-5c37-4e01-b0d5-3a98773f4935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020938055040>]}
[0m12:44:11.542054 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:44:11.764261 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:44:12.088740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:44:12.088740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:44:12.185636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4672ef33-5c37-4e01-b0d5-3a98773f4935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020938429460>]}
[0m12:44:12.358770 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:44:12.362657 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:44:12.404144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4672ef33-5c37-4e01-b0d5-3a98773f4935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209397B5700>]}
[0m12:44:12.405142 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:44:12.406157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4672ef33-5c37-4e01-b0d5-3a98773f4935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093781CC20>]}
[0m12:44:12.409066 [info ] [MainThread]: 
[0m12:44:12.410027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:12.410027 [info ] [MainThread]: 
[0m12:44:12.412022 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:44:12.413139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m12:44:12.501781 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:44:12.501781 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:44:12.502778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:12.706166 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.203 seconds
[0m12:44:12.709207 [debug] [ThreadPool]: On list_DBT: Close
[0m12:44:12.722173 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m12:44:12.737129 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:44:12.738114 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:44:12.739127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:12.814766 [debug] [ThreadPool]: SQL status: BEGIN in 0.075 seconds
[0m12:44:12.815816 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:44:12.816810 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:44:12.832217 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m12:44:12.835160 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:44:12.836934 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:44:12.838191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m12:44:12.844140 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:44:12.845172 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:44:12.845172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:12.922596 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m12:44:12.923642 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:44:12.924640 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:44:12.940230 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.014 seconds
[0m12:44:12.944230 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:44:12.945753 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:44:12.973093 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:12.974089 [debug] [MainThread]: On master: BEGIN
[0m12:44:12.974089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:44:13.022180 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m12:44:13.022180 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:13.022180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:44:13.031949 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m12:44:13.032947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4672ef33-5c37-4e01-b0d5-3a98773f4935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209381A0C20>]}
[0m12:44:13.033944 [debug] [MainThread]: On master: ROLLBACK
[0m12:44:13.034473 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:13.034473 [debug] [MainThread]: On master: BEGIN
[0m12:44:13.035485 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:44:13.035485 [debug] [MainThread]: On master: COMMIT
[0m12:44:13.035485 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:13.036505 [debug] [MainThread]: On master: COMMIT
[0m12:44:13.037048 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:44:13.037048 [debug] [MainThread]: On master: Close
[0m12:44:13.039044 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m12:44:13.040072 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.dim_listings_w_hosts ........................... [RUN]
[0m12:44:13.041039 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.dim_listings_w_hosts'
[0m12:44:13.041039 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m12:44:13.049057 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m12:44:13.058312 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m12:44:13.099235 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m12:44:13.100216 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m12:44:13.100216 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: BEGIN
[0m12:44:13.101226 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:44:13.138152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m12:44:13.139184 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m12:44:13.139184 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */

  create view "DBT"."raw"."dim_listings_w_hosts__dbt_tmp"
    
    
  as (
    

WITH    
l As (
    select * from "DBT"."raw"."dim_listings_cleansed"
),
h as (select * from "DBT"."raw"."dim_hosts_cleansed")

select 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price_str,
    l.host_id,
    h.NAME,
    h.IS_SUPERHOST as host_is_superhost,
    l.created_at,
    GREATEST (l.updated_at,h.updated_at) as update_at
    from l   
    left join h on (h.host_id = l.host_id)
  );
[0m12:44:13.155477 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m12:44:13.166453 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m12:44:13.166453 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
alter table "DBT"."raw"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m12:44:13.169621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:44:13.201327 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: COMMIT
[0m12:44:13.201327 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m12:44:13.202324 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: COMMIT
[0m12:44:13.205061 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:44:13.214039 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."dim_listings_w_hosts__dbt_backup"
[0m12:44:13.220025 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m12:44:13.220025 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
drop view if exists "DBT"."raw"."dim_listings_w_hosts__dbt_backup" cascade
[0m12:44:13.221030 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:44:13.224011 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m12:44:13.226591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672ef33-5c37-4e01-b0d5-3a98773f4935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020939DB0770>]}
[0m12:44:13.227005 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.dim_listings_w_hosts ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m12:44:13.228110 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m12:44:13.229961 [info ] [MainThread]: 
[0m12:44:13.229961 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:13.230958 [debug] [MainThread]: On master: BEGIN
[0m12:44:13.230958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:44:13.268878 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m12:44:13.268878 [debug] [MainThread]: On master: COMMIT
[0m12:44:13.269908 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:13.269908 [debug] [MainThread]: On master: COMMIT
[0m12:44:13.270908 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:44:13.282841 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:44:13.286831 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:13.286831 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.dim_listings_w_hosts', 'view',
'2025-02-02 11:44:11.118826+00:00',
'2025-02-02 11:44:13.041039',
'2025-02-02 11:44:13.224011'
,'success','0.18393874168395996',
'4672ef33-5c37-4e01-b0d5-3a98773f4935','1.9.1',CURRENT_TIMESTAMP(0),'-1');
           
      
  
[0m12:44:13.290032 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m12:44:13.292055 [info ] [MainThread]: 
     
[0m12:44:13.292722 [info ] [MainThread]: ========== End Summary ==========
[0m12:44:13.293557 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m12:44:13.299546 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m12:44:13.300648 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m12:44:13.302507 [debug] [MainThread]: On master: Close
[0m12:44:13.303537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:13.303804 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m12:44:13.304529 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m12:44:13.305531 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m12:44:13.305531 [info ] [MainThread]: 
[0m12:44:13.306789 [info ] [MainThread]: Finished running 1 project hook, 1 view model in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m12:44:13.308494 [debug] [MainThread]: Command end result
[0m12:44:13.358356 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:44:13.361348 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:44:13.368913 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m12:44:13.369327 [info ] [MainThread]: 
[0m12:44:13.370409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:44:13.371322 [info ] [MainThread]: 
[0m12:44:13.371322 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:44:13.372319 [debug] [MainThread]: Command `dbt run` succeeded at 12:44:13.372319 after 2.35 seconds
[0m12:44:13.373316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209397B7E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093A19FF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093808C200>]}
[0m12:44:13.373316 [debug] [MainThread]: Flushing usage events
[0m12:44:14.069107 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:31.750374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC384FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC384DD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC384DF10>]}


============================== 12:45:31.760962 | 5afb5b5e-106f-4339-ab46-f66b8ce55bd4 ==============================
[0m12:45:31.760962 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:45:31.762956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m fct_reviews', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:45:32.009202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5afb5b5e-106f-4339-ab46-f66b8ce55bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC38AD580>]}
[0m12:45:32.075617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5afb5b5e-106f-4339-ab46-f66b8ce55bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC2FA7860>]}
[0m12:45:32.076903 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:45:32.298267 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:45:32.618764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:45:32.619761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:45:32.711873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5afb5b5e-106f-4339-ab46-f66b8ce55bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC3B03320>]}
[0m12:45:32.876504 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:45:32.880864 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:45:32.912559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5afb5b5e-106f-4339-ab46-f66b8ce55bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC4CFFDD0>]}
[0m12:45:32.913359 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:45:32.914381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5afb5b5e-106f-4339-ab46-f66b8ce55bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC4FE7B90>]}
[0m12:45:32.916350 [info ] [MainThread]: 
[0m12:45:32.917026 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:32.917347 [info ] [MainThread]: 
[0m12:45:32.918345 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:45:32.919421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m12:45:32.998133 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:45:32.998133 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:45:32.999130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:33.152714 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.154 seconds
[0m12:45:33.155647 [debug] [ThreadPool]: On list_DBT: Close
[0m12:45:33.164672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m12:45:33.179636 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:45:33.180633 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:45:33.181630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:33.234923 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m12:45:33.235955 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:45:33.235955 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:45:33.247537 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m12:45:33.250563 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:45:33.251527 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:45:33.252524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m12:45:33.257544 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:45:33.258507 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:45:33.258507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:33.311709 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m12:45:33.311709 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:45:33.312749 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:45:33.324476 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.011 seconds
[0m12:45:33.327470 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:45:33.328378 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:45:33.348167 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:33.349164 [debug] [MainThread]: On master: BEGIN
[0m12:45:33.350162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:33.418087 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m12:45:33.419039 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:33.420036 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:45:33.439410 [debug] [MainThread]: SQL status: SELECT 5 in 0.018 seconds
[0m12:45:33.443403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5afb5b5e-106f-4339-ab46-f66b8ce55bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC157C9E0>]}
[0m12:45:33.444400 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:33.445394 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:33.446396 [debug] [MainThread]: On master: BEGIN
[0m12:45:33.448482 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:45:33.449386 [debug] [MainThread]: On master: COMMIT
[0m12:45:33.450381 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:33.450381 [debug] [MainThread]: On master: COMMIT
[0m12:45:33.452327 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:45:33.452327 [debug] [MainThread]: On master: Close
[0m12:45:33.457314 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m12:45:33.459310 [info ] [Thread-1 (]: 1 of 1 START sql incremental model raw.fct_reviews ............................. [RUN]
[0m12:45:33.462302 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.fct_reviews'
[0m12:45:33.463297 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m12:45:33.505216 [info ] [Thread-1 (]: Loading "DBT"."raw"."fct_reviews" incrementally (all missing dates)
[0m12:45:33.506183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m12:45:33.512351 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m12:45:33.580203 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:45:33.580203 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */

    
  
    

  create temporary table "fct_reviews__dbt_tmp124533554269"
  
  
    as
  
  (
    

WITH src_reviews AS (
  SELECT * FROM "DBT"."raw"."src_reviews"
)
SELECT 
  md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
  *
FROM src_reviews
WHERE review_text is not null

  
    AND review_date > (select max(review_date) from "DBT"."raw"."fct_reviews")
    
  

  );
  
  
[0m12:45:33.581204 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:45:34.568183 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.987 seconds
[0m12:45:34.584177 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:45:34.585173 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: BEGIN
[0m12:45:34.586135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m12:45:34.586135 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:45:34.587170 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp124533554269'
        
      order by ordinal_position

  
[0m12:45:34.619070 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.031 seconds
[0m12:45:34.633063 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:45:34.634029 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m12:45:34.640011 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m12:45:34.660956 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:45:34.661955 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp124533554269'
        
      order by ordinal_position

  
[0m12:45:34.664945 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m12:45:34.668934 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:45:34.669931 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m12:45:34.672923 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m12:45:34.686887 [debug] [Thread-1 (]: 
    In "DBT"."raw"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:45:34.703843 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m12:45:34.704839 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:45:34.705836 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */

      insert into "DBT"."raw"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp124533554269"
    )


  
[0m12:45:34.707832 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m12:45:34.729771 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: COMMIT
[0m12:45:34.730769 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:45:34.730769 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: COMMIT
[0m12:45:34.732763 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:45:34.734758 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m12:45:34.737753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5afb5b5e-106f-4339-ab46-f66b8ce55bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC55D4BF0>]}
[0m12:45:34.738823 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model raw.fct_reviews ........................ [[32mINSERT 0 0[0m in 1.27s]
[0m12:45:34.740744 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m12:45:34.741740 [info ] [MainThread]: 
[0m12:45:34.743736 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:34.743736 [debug] [MainThread]: On master: BEGIN
[0m12:45:34.744735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:34.786159 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m12:45:34.786159 [debug] [MainThread]: On master: COMMIT
[0m12:45:34.787184 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:34.787184 [debug] [MainThread]: On master: COMMIT
[0m12:45:34.788150 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:45:34.799152 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:45:34.799811 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:34.800814 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.fct_reviews', 'incremental',
'2025-02-02 11:45:31.545779+00:00',
'2025-02-02 11:45:33.464295',
'2025-02-02 11:45:34.734758'
,'success','1.2733631134033203',
'5afb5b5e-106f-4339-ab46-f66b8ce55bd4','1.9.1',CURRENT_TIMESTAMP(0),'0');
           
      
  
[0m12:45:34.805831 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.004 seconds
[0m12:45:34.807825 [info ] [MainThread]: 
     
[0m12:45:34.808791 [info ] [MainThread]: ========== End Summary ==========
[0m12:45:34.809788 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m12:45:34.815973 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m12:45:34.816769 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m12:45:34.817815 [debug] [MainThread]: On master: Close
[0m12:45:34.817815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:34.819068 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m12:45:34.819068 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m12:45:34.819805 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m12:45:34.819805 [info ] [MainThread]: 
[0m12:45:34.820759 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m12:45:34.822755 [debug] [MainThread]: Command end result
[0m12:45:34.876607 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:45:34.879599 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:45:34.888576 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m12:45:34.888576 [info ] [MainThread]: 
[0m12:45:34.889786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:34.890572 [info ] [MainThread]: 
[0m12:45:34.891337 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:45:34.892592 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:34.892592 after 3.44 seconds
[0m12:45:34.892592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC16294C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC1629610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC1629520>]}
[0m12:45:34.893591 [debug] [MainThread]: Flushing usage events
[0m12:45:35.684095 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:09.834908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BF8F2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BF8F36B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BF8F29F0>]}


============================== 12:46:09.845147 | c36d6b87-2ab1-4951-ac93-2f7ae9898816 ==============================
[0m12:46:09.845147 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:46:09.847145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_fullmoon_reviews', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:46:10.068477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c36d6b87-2ab1-4951-ac93-2f7ae9898816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BD7CD580>]}
[0m12:46:10.133487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c36d6b87-2ab1-4951-ac93-2f7ae9898816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BF91C770>]}
[0m12:46:10.135108 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:46:10.365310 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:46:10.694772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:46:10.695766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:46:10.791516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c36d6b87-2ab1-4951-ac93-2f7ae9898816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C0713350>]}
[0m12:46:10.963340 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:46:10.967414 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:46:11.007498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c36d6b87-2ab1-4951-ac93-2f7ae9898816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C1CD2CF0>]}
[0m12:46:11.007498 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:46:11.008496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c36d6b87-2ab1-4951-ac93-2f7ae9898816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C06ECC50>]}
[0m12:46:11.011518 [info ] [MainThread]: 
[0m12:46:11.011518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:11.012454 [info ] [MainThread]: 
[0m12:46:11.013490 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:46:11.015446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m12:46:11.092864 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:46:11.093902 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:46:11.093902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:11.137085 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.043 seconds
[0m12:46:11.139051 [debug] [ThreadPool]: On list_DBT: Close
[0m12:46:11.144479 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m12:46:11.150319 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:46:11.151316 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:46:11.151791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:11.187840 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m12:46:11.187840 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:46:11.187840 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:46:11.195917 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.007 seconds
[0m12:46:11.198872 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:46:11.199524 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:46:11.200480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_raw, now list_DBT_DEV)
[0m12:46:11.208922 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:46:11.208922 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:46:11.209919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:11.259961 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m12:46:11.260791 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:46:11.260791 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:46:11.275098 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m12:46:11.278139 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:46:11.279231 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:46:11.294167 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:11.295165 [debug] [MainThread]: On master: BEGIN
[0m12:46:11.296167 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:46:11.371706 [debug] [MainThread]: SQL status: BEGIN in 0.076 seconds
[0m12:46:11.372749 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:11.373701 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:46:11.393352 [debug] [MainThread]: SQL status: SELECT 5 in 0.019 seconds
[0m12:46:11.398339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c36d6b87-2ab1-4951-ac93-2f7ae9898816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C21BDD90>]}
[0m12:46:11.399337 [debug] [MainThread]: On master: ROLLBACK
[0m12:46:11.400338 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:11.401332 [debug] [MainThread]: On master: BEGIN
[0m12:46:11.403339 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:46:11.403339 [debug] [MainThread]: On master: COMMIT
[0m12:46:11.404325 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:11.405442 [debug] [MainThread]: On master: COMMIT
[0m12:46:11.406319 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:46:11.407315 [debug] [MainThread]: On master: Close
[0m12:46:11.412303 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m12:46:11.413262 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.mart_fullmoon_reviews ......................... [RUN]
[0m12:46:11.415279 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m12:46:11.416295 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m12:46:11.445170 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m12:46:11.447160 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m12:46:11.493571 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m12:46:11.498921 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m12:46:11.499918 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: BEGIN
[0m12:46:11.501095 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:46:11.572978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m12:46:11.574020 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m12:46:11.575008 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */

  
    

  create  table "DBT"."raw"."mart_fullmoon_reviews__dbt_tmp"
  
  
    as
  
  (
    
WITH fct_reviews AS (
    select * from "DBT"."raw"."fct_reviews"
),
full_moon_dates AS (
    select * from "DBT"."raw"."seed_full_moon_dates"
)
select r.*,
case
when fm.full_moon_date IS NULL THEN 'not full moon'
else 'full moon'
END AS is_full_moon
from
fct_reviews r
left join full_moon_dates fm 
--on (TO_DATE(r.review_date) = DATEADD(DAY,1, fm.full_moon_date))
ON (r.review_date::date = fm.full_moon_date + INTERVAL '1 day')
  );
  
[0m12:46:16.779222 [debug] [Thread-1 (]: SQL status: SELECT 409697 in 5.203 seconds
[0m12:46:16.796192 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m12:46:16.797185 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
alter table "DBT"."raw"."mart_fullmoon_reviews" rename to "mart_fullmoon_reviews__dbt_backup"
[0m12:46:16.799519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:46:16.807285 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m12:46:16.809280 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
alter table "DBT"."raw"."mart_fullmoon_reviews__dbt_tmp" rename to "mart_fullmoon_reviews"
[0m12:46:16.811265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:46:16.856138 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: COMMIT
[0m12:46:16.856138 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m12:46:16.857144 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: COMMIT
[0m12:46:16.866997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m12:46:16.883970 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."mart_fullmoon_reviews__dbt_backup"
[0m12:46:16.896945 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m12:46:16.897935 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
drop table if exists "DBT"."raw"."mart_fullmoon_reviews__dbt_backup" cascade
[0m12:46:16.912412 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m12:46:16.919441 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m12:46:16.924380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c36d6b87-2ab1-4951-ac93-2f7ae9898816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BF8B9E50>]}
[0m12:46:16.926373 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.mart_fullmoon_reviews .................... [[32mSELECT 409697[0m in 5.51s]
[0m12:46:16.928367 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m12:46:16.930366 [info ] [MainThread]: 
[0m12:46:16.932358 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:16.932358 [debug] [MainThread]: On master: BEGIN
[0m12:46:16.933401 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:46:16.985855 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m12:46:16.985855 [debug] [MainThread]: On master: COMMIT
[0m12:46:16.986815 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:16.986815 [debug] [MainThread]: On master: COMMIT
[0m12:46:16.987816 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:46:17.000714 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:46:17.004220 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:17.005220 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.mart_fullmoon_reviews', 'table',
'2025-02-02 11:46:09.724606+00:00',
'2025-02-02 11:46:11.417293',
'2025-02-02 11:46:16.918443'
,'success','5.5051491260528564',
'c36d6b87-2ab1-4951-ac93-2f7ae9898816','1.9.1',CURRENT_TIMESTAMP(0),'409697');
           
      
  
[0m12:46:17.008221 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.003 seconds
[0m12:46:17.010216 [info ] [MainThread]: 
     
[0m12:46:17.012217 [info ] [MainThread]: ========== End Summary ==========
[0m12:46:17.013307 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m12:46:17.021185 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m12:46:17.022801 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m12:46:17.023926 [debug] [MainThread]: On master: Close
[0m12:46:17.024612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:17.024612 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m12:46:17.024612 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m12:46:17.025610 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m12:46:17.025610 [info ] [MainThread]: 
[0m12:46:17.026885 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 6.01 seconds (6.01s).
[0m12:46:17.028574 [debug] [MainThread]: Command end result
[0m12:46:17.078500 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:46:17.081206 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:46:17.087637 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m12:46:17.088414 [info ] [MainThread]: 
[0m12:46:17.088414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:17.089442 [info ] [MainThread]: 
[0m12:46:17.090408 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:46:17.091442 [debug] [MainThread]: Command `dbt run` succeeded at 12:46:17.091442 after 7.47 seconds
[0m12:46:17.091442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BF978CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BF978BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BF978C20>]}
[0m12:46:17.092436 [debug] [MainThread]: Flushing usage events
[0m12:46:17.874334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:29.633417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7ABAD7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7ABAD53A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7ABAD66C0>]}


============================== 12:46:29.644304 | dad7a258-6d0f-450d-b352-91aa67c6a705 ==============================
[0m12:46:29.644304 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:46:29.646334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:46:29.878519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dad7a258-6d0f-450d-b352-91aa67c6a705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7A8E8D790>]}
[0m12:46:29.944344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dad7a258-6d0f-450d-b352-91aa67c6a705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AAA8DB50>]}
[0m12:46:29.945908 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:46:30.168464 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:46:30.489300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:46:30.489300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:46:30.589683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dad7a258-6d0f-450d-b352-91aa67c6a705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7ABE16FC0>]}
[0m12:46:30.763708 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:46:30.768807 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:46:30.823517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dad7a258-6d0f-450d-b352-91aa67c6a705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AD2F6F90>]}
[0m12:46:30.823702 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:46:30.824526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dad7a258-6d0f-450d-b352-91aa67c6a705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AD13D820>]}
[0m12:46:30.827526 [info ] [MainThread]: 
[0m12:46:30.828488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:30.829485 [info ] [MainThread]: 
[0m12:46:30.830484 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:46:30.831482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m12:46:30.921787 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:46:30.921787 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:46:30.921787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:30.960844 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.038 seconds
[0m12:46:30.961802 [debug] [ThreadPool]: On list_DBT: Close
[0m12:46:30.967767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m12:46:30.974761 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:46:30.974761 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:46:30.974761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:31.181523 [debug] [ThreadPool]: SQL status: BEGIN in 0.206 seconds
[0m12:46:31.182528 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:46:31.183643 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:46:31.199992 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.015 seconds
[0m12:46:31.203937 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:46:31.205741 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:46:31.207372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_raw, now list_DBT_DEV)
[0m12:46:31.219758 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:46:31.228685 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:46:31.229733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:31.296040 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m12:46:31.297009 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:46:31.297996 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:46:31.312715 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m12:46:31.316752 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:46:31.317741 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:46:31.331666 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:31.332662 [debug] [MainThread]: On master: BEGIN
[0m12:46:31.333660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:46:31.524774 [debug] [MainThread]: SQL status: BEGIN in 0.192 seconds
[0m12:46:31.525825 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:31.526772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:46:31.547053 [debug] [MainThread]: SQL status: SELECT 5 in 0.019 seconds
[0m12:46:31.551047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dad7a258-6d0f-450d-b352-91aa67c6a705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7ABC34920>]}
[0m12:46:31.552044 [debug] [MainThread]: On master: ROLLBACK
[0m12:46:31.553821 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:31.554871 [debug] [MainThread]: On master: BEGIN
[0m12:46:31.556064 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:46:31.556864 [debug] [MainThread]: On master: COMMIT
[0m12:46:31.557859 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:31.558860 [debug] [MainThread]: On master: COMMIT
[0m12:46:31.559858 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:46:31.560857 [debug] [MainThread]: On master: Close
[0m12:46:31.564835 [debug] [Thread-1 (]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m12:46:31.566829 [info ] [Thread-1 (]: 1 of 1 START seed file raw.seed_full_moon_dates ................................ [RUN]
[0m12:46:31.568830 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.dbtlearn.seed_full_moon_dates'
[0m12:46:31.569833 [debug] [Thread-1 (]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m12:46:31.570819 [debug] [Thread-1 (]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m12:46:31.631252 [debug] [Thread-1 (]: Using postgres connection "seed.dbtlearn.seed_full_moon_dates"
[0m12:46:31.631252 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: BEGIN
[0m12:46:31.632250 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:46:31.668094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m12:46:31.668094 [debug] [Thread-1 (]: Using postgres connection "seed.dbtlearn.seed_full_moon_dates"
[0m12:46:31.669130 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
truncate table "DBT"."raw"."seed_full_moon_dates"
[0m12:46:31.682757 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.014 seconds
[0m12:46:31.735667 [debug] [Thread-1 (]: Using postgres connection "seed.dbtlearn.seed_full_moon_dates"
[0m12:46:31.735667 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: 
          insert into "DBT"."raw"."seed_full_moon_dates" ("full_moon_date") values
          (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s...
[0m12:46:31.740496 [debug] [Thread-1 (]: SQL status: INSERT 0 272 in 0.004 seconds
[0m12:46:31.745518 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m12:46:31.771332 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: COMMIT
[0m12:46:31.772329 [debug] [Thread-1 (]: Using postgres connection "seed.dbtlearn.seed_full_moon_dates"
[0m12:46:31.772329 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: COMMIT
[0m12:46:31.776321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:46:31.778315 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: Close
[0m12:46:31.780308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dad7a258-6d0f-450d-b352-91aa67c6a705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7A8E8C920>]}
[0m12:46:31.781306 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file raw.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 0.21s]
[0m12:46:31.782303 [debug] [Thread-1 (]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m12:46:31.783836 [info ] [MainThread]: 
[0m12:46:31.785347 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:31.785832 [debug] [MainThread]: On master: BEGIN
[0m12:46:31.785832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:46:31.992255 [debug] [MainThread]: SQL status: BEGIN in 0.206 seconds
[0m12:46:31.993298 [debug] [MainThread]: On master: COMMIT
[0m12:46:31.994299 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:31.995297 [debug] [MainThread]: On master: COMMIT
[0m12:46:31.996245 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:46:32.029204 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:46:32.035165 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:32.036164 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'seed.dbtlearn.seed_full_moon_dates', 'seed',
'2025-02-02 11:46:29.549370+00:00',
'2025-02-02 11:46:31.569833',
'2025-02-02 11:46:31.777318'
,'success','0.210524320602417',
'dad7a258-6d0f-450d-b352-91aa67c6a705','1.9.1',CURRENT_TIMESTAMP(0),'272');
           
      
  
[0m12:46:32.048409 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.010 seconds
[0m12:46:32.051837 [info ] [MainThread]: 
     
[0m12:46:32.054399 [info ] [MainThread]: ========== End Summary ==========
[0m12:46:32.056396 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m12:46:32.069406 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m12:46:32.071360 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.07s]
[0m12:46:32.072399 [debug] [MainThread]: On master: Close
[0m12:46:32.075347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:32.077373 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m12:46:32.078372 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m12:46:32.078372 [debug] [MainThread]: Connection 'seed.dbtlearn.seed_full_moon_dates' was properly closed.
[0m12:46:32.079369 [info ] [MainThread]: 
[0m12:46:32.081327 [info ] [MainThread]: Finished running 1 project hook, 1 seed in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m12:46:32.083351 [debug] [MainThread]: Command end result
[0m12:46:32.142182 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:46:32.145178 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:46:32.151603 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m12:46:32.152345 [info ] [MainThread]: 
[0m12:46:32.153133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:32.153133 [info ] [MainThread]: 
[0m12:46:32.154285 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:46:32.156127 [debug] [MainThread]: Command `dbt seed` succeeded at 12:46:32.155128 after 2.70 seconds
[0m12:46:32.157137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AB98EB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AAFB02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AAFB03E0>]}
[0m12:46:32.158263 [debug] [MainThread]: Flushing usage events
[0m12:46:32.923977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:37.690206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002478E568E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024790808440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024790808BF0>]}


============================== 12:47:37.700988 | 888a5bc4-6070-4878-8174-cf44f27c14e6 ==============================
[0m12:47:37.700988 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:47:37.703120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_listings_cleansed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:47:37.920469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '888a5bc4-6070-4878-8174-cf44f27c14e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002478E65DAC0>]}
[0m12:47:37.983393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '888a5bc4-6070-4878-8174-cf44f27c14e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024790F5E330>]}
[0m12:47:37.985002 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:47:38.210288 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:47:38.589415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:47:38.590412 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models\schema.yml
[0m12:47:39.121205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '888a5bc4-6070-4878-8174-cf44f27c14e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024792C628A0>]}
[0m12:47:39.297953 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:47:39.302048 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:47:39.345361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '888a5bc4-6070-4878-8174-cf44f27c14e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024792D9FFE0>]}
[0m12:47:39.345361 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:47:39.347354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888a5bc4-6070-4878-8174-cf44f27c14e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024792C61520>]}
[0m12:47:39.349348 [info ] [MainThread]: 
[0m12:47:39.350700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:39.351344 [info ] [MainThread]: 
[0m12:47:39.352369 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:39.354336 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m12:47:39.444135 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:47:39.445133 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:47:39.445133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:39.518922 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.073 seconds
[0m12:47:39.521960 [debug] [ThreadPool]: On list_DBT: Close
[0m12:47:39.533972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m12:47:39.549934 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:47:39.550931 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:47:39.550931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:39.614307 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m12:47:39.615242 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:47:39.615242 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:47:39.630751 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m12:47:39.633778 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:47:39.634959 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:47:39.635781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m12:47:39.641760 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:47:39.642755 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:47:39.642755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:39.853594 [debug] [ThreadPool]: SQL status: BEGIN in 0.210 seconds
[0m12:47:39.854575 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:47:39.856568 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:47:39.877265 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.020 seconds
[0m12:47:39.883287 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:47:39.884807 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:47:39.911855 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:39.912851 [debug] [MainThread]: On master: BEGIN
[0m12:47:39.912851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:39.953368 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m12:47:39.954184 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:39.954184 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:47:39.963158 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m12:47:39.965158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888a5bc4-6070-4878-8174-cf44f27c14e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002478E6F2C30>]}
[0m12:47:39.965158 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:39.966114 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:39.966114 [debug] [MainThread]: On master: BEGIN
[0m12:47:39.967171 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:47:39.967171 [debug] [MainThread]: On master: COMMIT
[0m12:47:39.968109 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:39.968109 [debug] [MainThread]: On master: COMMIT
[0m12:47:39.968109 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:47:39.969105 [debug] [MainThread]: On master: Close
[0m12:47:39.971101 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:47:39.972129 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.dim_listings_cleansed ......................... [RUN]
[0m12:47:39.973096 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.dim_listings_cleansed'
[0m12:47:39.973096 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:47:39.982073 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:47:39.984068 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:47:40.103745 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m12:47:40.104743 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m12:47:40.105412 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: BEGIN
[0m12:47:40.105740 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:47:40.144237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m12:47:40.144237 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m12:47:40.144237 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */

  
    

  create  table "DBT"."raw"."dim_listings_cleansed__dbt_tmp"
  
  
    as
  
  (
    WITH src_listings AS (
    SELECT * FROM "DBT"."raw"."src_listings"
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights 
    END AS minimum_nights,
    host_id,
    ROUND(REPLACE(price_str, '$', '')::NUMERIC, 2) as price_str,
    created_at,
    updated_at
FROM src_listings
  );
  
[0m12:47:40.181138 [debug] [Thread-1 (]: SQL status: SELECT 17499 in 0.036 seconds
[0m12:47:40.188120 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m12:47:40.188120 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
alter table "DBT"."raw"."dim_listings_cleansed" rename to "dim_listings_cleansed__dbt_backup"
[0m12:47:40.189295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:47:40.193147 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m12:47:40.193147 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
alter table "DBT"."raw"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m12:47:40.194493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:47:40.214092 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: COMMIT
[0m12:47:40.214092 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m12:47:40.215084 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: COMMIT
[0m12:47:40.229334 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m12:47:40.244294 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."dim_listings_cleansed__dbt_backup"
[0m12:47:40.256261 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_cleansed"
[0m12:47:40.256261 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop table if exists "DBT"."raw"."dim_listings_cleansed__dbt_backup" cascade
[0m12:47:40.266273 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:47:40.270260 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:47:40.274214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888a5bc4-6070-4878-8174-cf44f27c14e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002478E65CBF0>]}
[0m12:47:40.276254 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.dim_listings_cleansed .................... [[32mSELECT 17499[0m in 0.30s]
[0m12:47:40.278206 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:47:40.280199 [info ] [MainThread]: 
[0m12:47:40.281397 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:40.282228 [debug] [MainThread]: On master: BEGIN
[0m12:47:40.282228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:40.328149 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m12:47:40.328149 [debug] [MainThread]: On master: COMMIT
[0m12:47:40.328871 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:40.328871 [debug] [MainThread]: On master: COMMIT
[0m12:47:40.329869 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:47:40.338881 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:47:40.341939 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:40.343015 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.dim_listings_cleansed', 'table',
'2025-02-02 11:47:37.500978+00:00',
'2025-02-02 11:47:39.973096',
'2025-02-02 11:47:40.270260'
,'success','0.29856085777282715',
'888a5bc4-6070-4878-8174-cf44f27c14e6','1.9.1',CURRENT_TIMESTAMP(0),'17499');
           
      
  
[0m12:47:40.347908 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.004 seconds
[0m12:47:40.349900 [info ] [MainThread]: 
     
[0m12:47:40.350867 [info ] [MainThread]: ========== End Summary ==========
[0m12:47:40.351863 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m12:47:40.356881 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m12:47:40.358844 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m12:47:40.358844 [debug] [MainThread]: On master: Close
[0m12:47:40.359868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:40.359868 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m12:47:40.360839 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m12:47:40.360839 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m12:47:40.361837 [info ] [MainThread]: 
[0m12:47:40.361837 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m12:47:40.363855 [debug] [MainThread]: Command end result
[0m12:47:40.413698 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:47:40.416561 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:47:40.422714 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m12:47:40.422961 [info ] [MainThread]: 
[0m12:47:40.423670 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:40.424670 [info ] [MainThread]: 
[0m12:47:40.424670 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:47:40.426662 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:40.425665 after 3.02 seconds
[0m12:47:40.427660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024790F5F9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024790F5F3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247929183B0>]}
[0m12:47:40.427660 [debug] [MainThread]: Flushing usage events
[0m12:47:41.223822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:49.041510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EBED27440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EBED27200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EBED240E0>]}


============================== 12:47:49.051565 | eddeb7ec-9436-4bed-adf0-6992ae77dea2 ==============================
[0m12:47:49.051565 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:47:49.053560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:47:49.315036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eddeb7ec-9436-4bed-adf0-6992ae77dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EBED7C530>]}
[0m12:47:49.381204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eddeb7ec-9436-4bed-adf0-6992ae77dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EBE23C6B0>]}
[0m12:47:49.383009 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:47:49.621434 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:47:49.985328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:49.985328 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:50.077542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eddeb7ec-9436-4bed-adf0-6992ae77dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EBF04C4D0>]}
[0m12:47:50.244920 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:47:50.248659 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:47:50.393679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eddeb7ec-9436-4bed-adf0-6992ae77dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EC071A780>]}
[0m12:47:50.393679 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:47:50.394944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eddeb7ec-9436-4bed-adf0-6992ae77dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EBED44A40>]}
[0m12:47:50.397864 [info ] [MainThread]: 
[0m12:47:50.399120 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:50.399120 [info ] [MainThread]: 
[0m12:47:50.400033 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:50.407258 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m12:47:50.491774 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:47:50.491774 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:47:50.492772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:50.529939 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m12:47:50.530936 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:47:50.530936 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:47:50.538836 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.007 seconds
[0m12:47:50.540108 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:47:50.541429 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:47:50.541429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_raw, now list_DBT_DEV)
[0m12:47:50.548451 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:47:50.548451 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:47:50.549448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:50.584706 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m12:47:50.584706 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:47:50.585742 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:47:50.593457 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m12:47:50.594411 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:47:50.595716 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:47:50.602386 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:50.602386 [debug] [MainThread]: On master: BEGIN
[0m12:47:50.603383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:50.795664 [debug] [MainThread]: SQL status: BEGIN in 0.192 seconds
[0m12:47:50.796708 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:50.797705 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:47:50.817698 [debug] [MainThread]: SQL status: SELECT 3 in 0.019 seconds
[0m12:47:50.820689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eddeb7ec-9436-4bed-adf0-6992ae77dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EC06F3650>]}
[0m12:47:50.821684 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:50.823681 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:50.823681 [debug] [MainThread]: On master: BEGIN
[0m12:47:50.825840 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:47:50.826673 [debug] [MainThread]: On master: COMMIT
[0m12:47:50.827668 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:50.827668 [debug] [MainThread]: On master: COMMIT
[0m12:47:50.829616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:47:50.829616 [debug] [MainThread]: On master: Close
[0m12:47:50.835601 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:47:50.836636 [info ] [Thread-1 (]: 1 of 22 START test accepted_values_dim_hosts_cleansed_is_superhost__t__f ....... [RUN]
[0m12:47:50.838592 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4'
[0m12:47:50.839624 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:47:50.877162 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m12:47:50.878392 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:47:50.900075 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m12:47:50.902068 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m12:47:50.903803 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: BEGIN
[0m12:47:50.904094 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:47:50.938908 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m12:47:50.939840 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m12:47:50.939840 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_superhost as value_field,
        count(*) as n_records

    from "DBT"."raw"."dim_hosts_cleansed"
    group by is_superhost

)

select *
from all_values
where value_field not in (
    't','f'
)



      
    ) dbt_internal_test
[0m12:47:50.944351 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:47:50.948341 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: ROLLBACK
[0m12:47:50.949605 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: Close
[0m12:47:50.949605 [info ] [Thread-1 (]: 1 of 22 PASS accepted_values_dim_hosts_cleansed_is_superhost__t__f ............. [[32mPASS[0m in 0.11s]
[0m12:47:50.951603 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:47:50.951603 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385
[0m12:47:50.952633 [info ] [Thread-1 (]: 2 of 22 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room  [RUN]
[0m12:47:50.953596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4, now test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385)
[0m12:47:50.953596 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385
[0m12:47:50.961574 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385"
[0m12:47:50.962572 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385
[0m12:47:50.966594 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385"
[0m12:47:50.968557 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385"
[0m12:47:50.969563 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385: BEGIN
[0m12:47:50.969563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:51.006455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m12:47:51.006455 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385"
[0m12:47:51.006455 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from "DBT"."raw"."dim_listings_cleansed"
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared roo','Hotel room'
)



      
    ) dbt_internal_test
[0m12:47:51.013437 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:47:51.015463 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385: ROLLBACK
[0m12:47:51.016633 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385: Close
[0m12:47:51.016633 [error] [Thread-1 (]: 2 of 22 FAIL 1 accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room  [[31mFAIL 1[0m in 0.06s]
[0m12:47:51.018474 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385
[0m12:47:51.018474 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:47:51.019471 [info ] [Thread-1 (]: 3 of 22 START test accepted_values_fct_reviews_review_sentiment__positive__neutral__negative  [RUN]
[0m12:47:51.020468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room.b6cf8f4385, now test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef)
[0m12:47:51.020468 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:47:51.028449 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m12:47:51.039700 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:47:51.043688 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m12:47:51.044685 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m12:47:51.045684 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: BEGIN
[0m12:47:51.045684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:51.079174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m12:47:51.080172 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m12:47:51.081169 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        review_sentiment as value_field,
        count(*) as n_records

    from "DBT"."raw"."fct_reviews"
    group by review_sentiment

)

select *
from all_values
where value_field not in (
    'positive','neutral','negative'
)



      
    ) dbt_internal_test
[0m12:47:51.178817 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.098 seconds
[0m12:47:51.181758 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: ROLLBACK
[0m12:47:51.183324 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: Close
[0m12:47:51.184838 [info ] [Thread-1 (]: 3 of 22 PASS accepted_values_fct_reviews_review_sentiment__positive__neutral__negative  [[32mPASS[0m in 0.16s]
[0m12:47:51.186321 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:47:51.187519 [debug] [Thread-1 (]: Began running node test.dbtlearn.consistent_created_at
[0m12:47:51.188315 [info ] [Thread-1 (]: 4 of 22 START test consistent_created_at ....................................... [RUN]
[0m12:47:51.189312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef, now test.dbtlearn.consistent_created_at)
[0m12:47:51.190348 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.consistent_created_at
[0m12:47:51.197364 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m12:47:51.199286 [debug] [Thread-1 (]: Began executing node test.dbtlearn.consistent_created_at
[0m12:47:51.203302 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.consistent_created_at"
[0m12:47:51.204376 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.consistent_created_at"
[0m12:47:51.205269 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: BEGIN
[0m12:47:51.205269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:51.344406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.139 seconds
[0m12:47:51.345333 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.consistent_created_at"
[0m12:47:51.345333 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * FROM "DBT"."raw"."dim_listings_cleansed" l
INNER JOIN "DBT"."raw"."fct_reviews" r
USING (listing_id)
WHERE l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m12:47:51.615612 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.270 seconds
[0m12:47:51.618600 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: ROLLBACK
[0m12:47:51.619601 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: Close
[0m12:47:51.620599 [info ] [Thread-1 (]: 4 of 22 PASS consistent_created_at ............................................. [[32mPASS[0m in 0.43s]
[0m12:47:51.622592 [debug] [Thread-1 (]: Finished running node test.dbtlearn.consistent_created_at
[0m12:47:51.623857 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:47:51.624585 [info ] [Thread-1 (]: 5 of 22 START test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [RUN]
[0m12:47:51.625582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.consistent_created_at, now test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75)
[0m12:47:51.626587 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:47:51.647525 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m12:47:51.649519 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:47:51.653508 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m12:47:51.655513 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m12:47:51.657498 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: BEGIN
[0m12:47:51.658496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:51.698390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:47:51.699430 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m12:47:51.700382 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  
( 1=1 and max(price) <= 5000
)
 as expression


    from "DBT"."raw"."dim_listings_w_hosts"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m12:47:51.701380 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.dim_listings_w_hosts" does not exist
LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                  ^

[0m12:47:51.701380 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: ROLLBACK
[0m12:47:51.702377 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: Close
[0m12:47:51.891838 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m12:47:51.893834 [error] [Thread-1 (]: 5 of 22 ERROR dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [[31mERROR[0m in 0.27s]
[0m12:47:51.896190 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:47:51.897186 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:47:51.898187 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql.
[0m12:47:51.899476 [info ] [Thread-1 (]: 6 of 22 START test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [RUN]
[0m12:47:51.902140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75, now test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970)
[0m12:47:51.903150 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:47:51.919122 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m12:47:51.920463 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:47:51.928070 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m12:47:51.930066 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m12:47:51.931063 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: BEGIN
[0m12:47:51.932061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:51.975023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m12:47:51.975023 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m12:47:51.976047 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and percentile_cont(0.99) within group (order by price) >= 50 and percentile_cont(0.99) within group (order by price) <= 500
)
 as expression


    from "DBT"."raw"."dim_listings_w_hosts"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m12:47:51.977018 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.dim_listings_w_hosts" does not exist
LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                  ^

[0m12:47:51.977018 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: ROLLBACK
[0m12:47:51.978044 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: Close
[0m12:47:51.981040 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_39596d790161761077ff1592b68943f6.sql
[0m12:47:51.982037 [error] [Thread-1 (]: 6 of 22 ERROR dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [[31mERROR[0m in 0.08s]
[0m12:47:51.984094 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:47:51.984094 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:47:51.985619 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_39596d790161761077ff1592b68943f6.sql.
[0m12:47:51.985091 [info ] [Thread-1 (]: 7 of 22 START test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [RUN]
[0m12:47:51.986061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970, now test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a)
[0m12:47:51.987084 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:47:52.019969 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m12:47:52.020966 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: BEGIN
[0m12:47:52.021964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:52.068942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m12:47:52.069873 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m12:47:52.069873 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'dim_listings_w_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m12:47:52.088071 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.017 seconds
[0m12:47:52.092061 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m12:47:52.093107 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:47:52.096050 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m12:47:52.097794 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m12:47:52.098046 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PRICE'
            and
            relation_column_type not in ('NUMBER')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m12:47:52.099247 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 10:     ),
             ^

[0m12:47:52.099247 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: ROLLBACK
[0m12:47:52.100075 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: Close
[0m12:47:52.103032 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number (models\schema.yml)
  syntax error at or near ")"
  LINE 10:     ),
               ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_07e7a515218ef6e3a17e164c642c7d18.sql
[0m12:47:52.104162 [error] [Thread-1 (]: 7 of 22 ERROR dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [[31mERROR[0m in 0.12s]
[0m12:47:52.105033 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:47:52.106024 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:47:52.106360 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number (models\schema.yml)
  syntax error at or near ")"
  LINE 10:     ),
               ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_07e7a515218ef6e3a17e164c642c7d18.sql.
[0m12:47:52.106360 [info ] [Thread-1 (]: 8 of 22 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m12:47:52.107022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a, now test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da)
[0m12:47:52.108018 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:47:52.132951 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m12:47:52.133948 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:47:52.137939 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m12:47:52.139136 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m12:47:52.139933 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: BEGIN
[0m12:47:52.139933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:52.175941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m12:47:52.176925 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m12:47:52.177922 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        "DBT"."raw"."dim_listings_w_hosts"
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        "DBT"."raw"."raw_listings"
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m12:47:52.179380 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.dim_listings_w_hosts" does not exist
LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                 ^

[0m12:47:52.179948 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: ROLLBACK
[0m12:47:52.179948 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m12:47:52.183101 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_ (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                   ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_table__fbda7436ebe2ffe341acf0622c76d629.sql
[0m12:47:52.183937 [error] [Thread-1 (]: 8 of 22 ERROR dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[31mERROR[0m in 0.08s]
[0m12:47:52.184926 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:47:52.185932 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:47:52.186962 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_ (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                   ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_table__fbda7436ebe2ffe341acf0622c76d629.sql.
[0m12:47:52.185932 [info ] [Thread-1 (]: 9 of 22 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m12:47:52.187927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da, now test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65)
[0m12:47:52.187927 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:47:52.194915 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:47:52.196072 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:47:52.203852 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:47:52.204849 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:47:52.205847 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: BEGIN
[0m12:47:52.206844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:52.384710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.178 seconds
[0m12:47:52.385704 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:47:52.385704 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct room_type) = 4
 as expression


    from "DBT"."raw"."raw_listings"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m12:47:52.395693 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m12:47:52.398671 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: ROLLBACK
[0m12:47:52.399844 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: Close
[0m12:47:52.400721 [info ] [Thread-1 (]: 9 of 22 PASS dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[32mPASS[0m in 0.21s]
[0m12:47:52.402718 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:47:52.403714 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:47:52.404221 [info ] [Thread-1 (]: 10 of 22 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m12:47:52.405673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65, now test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9)
[0m12:47:52.405673 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:47:52.425649 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:47:52.427628 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:47:52.431635 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:47:52.433599 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:47:52.434596 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: BEGIN
[0m12:47:52.435199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:52.620942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.186 seconds
[0m12:47:52.622936 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:47:52.623933 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(price, '^\\$[0-9][0-9\\.]+$', '')), 1), 0)


 > 0
 as expression


    from "DBT"."raw"."raw_listings"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





      
    ) dbt_internal_test
[0m12:47:52.646872 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m12:47:52.650863 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: ROLLBACK
[0m12:47:52.652348 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: Close
[0m12:47:52.654392 [error] [Thread-1 (]: 10 of 22 FAIL 17499 dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[31mFAIL 17499[0m in 0.25s]
[0m12:47:52.655849 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:47:52.657384 [debug] [Thread-1 (]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m12:47:52.657843 [info ] [Thread-1 (]: 11 of 22 START test dim_listings_minimum_nights ................................ [RUN]
[0m12:47:52.659838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9, now test.dbtlearn.dim_listings_minimum_nights)
[0m12:47:52.659838 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m12:47:52.666818 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m12:47:52.668407 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m12:47:52.674800 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dim_listings_minimum_nights"
[0m12:47:52.677727 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dim_listings_minimum_nights"
[0m12:47:52.679722 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: BEGIN
[0m12:47:52.680718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:52.722618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m12:47:52.722618 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dim_listings_minimum_nights"
[0m12:47:52.723604 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM
    "DBT"."raw"."dim_listings_cleansed"
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m12:47:52.727593 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:47:52.728591 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: ROLLBACK
[0m12:47:52.729828 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m12:47:52.730587 [info ] [Thread-1 (]: 11 of 22 PASS dim_listings_minimum_nights ...................................... [[32mPASS[0m in 0.07s]
[0m12:47:52.731582 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m12:47:52.731582 [debug] [Thread-1 (]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m12:47:52.732579 [info ] [Thread-1 (]: 12 of 22 START test no_nulls_in_dim_listings ................................... [RUN]
[0m12:47:52.733085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dim_listings_minimum_nights, now test.dbtlearn.no_nulls_in_dim_listings)
[0m12:47:52.733577 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m12:47:52.740592 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m12:47:52.741588 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: BEGIN
[0m12:47:52.741588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:52.779455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m12:47:52.779455 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m12:47:52.780696 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'dim_listings_cleansed'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m12:47:52.799984 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.019 seconds
[0m12:47:52.801944 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m12:47:52.813682 [debug] [Thread-1 (]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m12:47:52.820679 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m12:47:52.824617 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m12:47:52.825660 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM "DBT"."raw"."dim_listings_cleansed" WHERE
    listing_id IS NULL OR
    listing_name IS NULL OR
    room_type IS NULL OR
    minimum_nights IS NULL OR
    host_id IS NULL OR
    price_str IS NULL OR
    created_at IS NULL OR
    updated_at IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m12:47:52.837633 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m12:47:52.841572 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: ROLLBACK
[0m12:47:52.842732 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m12:47:52.844606 [info ] [Thread-1 (]: 12 of 22 PASS no_nulls_in_dim_listings ......................................... [[32mPASS[0m in 0.11s]
[0m12:47:52.846561 [debug] [Thread-1 (]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m12:47:52.848168 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:47:52.849599 [info ] [Thread-1 (]: 13 of 22 START test not_null_dim_hosts_cleansed_host_id ........................ [RUN]
[0m12:47:52.850601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.no_nulls_in_dim_listings, now test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05)
[0m12:47:52.851552 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:47:52.940345 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m12:47:52.942305 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:47:52.947291 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m12:47:52.948325 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m12:47:52.949284 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: BEGIN
[0m12:47:52.950322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:53.018856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m12:47:53.019897 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m12:47:53.020895 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from "DBT"."raw"."dim_hosts_cleansed"
where host_id is null



      
    ) dbt_internal_test
[0m12:47:53.026757 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:47:53.030796 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: ROLLBACK
[0m12:47:53.031894 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m12:47:53.033739 [info ] [Thread-1 (]: 13 of 22 PASS not_null_dim_hosts_cleansed_host_id .............................. [[32mPASS[0m in 0.18s]
[0m12:47:53.036245 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:47:53.036730 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:47:53.038327 [info ] [Thread-1 (]: 14 of 22 START test not_null_dim_hosts_cleansed_host_name ...................... [RUN]
[0m12:47:53.039754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05, now test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830)
[0m12:47:53.040722 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:47:53.052941 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m12:47:53.055793 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:47:53.060695 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m12:47:53.062115 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m12:47:53.062663 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: BEGIN
[0m12:47:53.063689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:53.101840 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m12:47:53.102834 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m12:47:53.102834 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_name
from "DBT"."raw"."dim_hosts_cleansed"
where host_name is null



      
    ) dbt_internal_test
[0m12:47:53.104095 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "host_name" does not exist
LINE 13: select host_name
                ^

[0m12:47:53.104095 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: ROLLBACK
[0m12:47:53.104828 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: Close
[0m12:47:53.108819 [debug] [Thread-1 (]: Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql
[0m12:47:53.108819 [error] [Thread-1 (]: 14 of 22 ERROR not_null_dim_hosts_cleansed_host_name ........................... [[31mERROR[0m in 0.07s]
[0m12:47:53.110814 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:47:53.110814 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:47:53.112302 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql.
[0m12:47:53.111780 [info ] [Thread-1 (]: 15 of 22 START test not_null_dim_listings_cleansed_host_id ..................... [RUN]
[0m12:47:53.112807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830, now test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m12:47:53.113809 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:47:53.118788 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:47:53.120756 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:47:53.122784 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:47:53.124387 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:47:53.124745 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: BEGIN
[0m12:47:53.124745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:53.163308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m12:47:53.163308 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:47:53.164339 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from "DBT"."raw"."dim_listings_cleansed"
where host_id is null



      
    ) dbt_internal_test
[0m12:47:53.168164 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:47:53.169164 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: ROLLBACK
[0m12:47:53.170669 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m12:47:53.171539 [info ] [Thread-1 (]: 15 of 22 PASS not_null_dim_listings_cleansed_host_id ........................... [[32mPASS[0m in 0.06s]
[0m12:47:53.172496 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:47:53.173493 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:47:53.173493 [info ] [Thread-1 (]: 16 of 22 START test not_null_dim_listings_cleansed_listing_id .................. [RUN]
[0m12:47:53.174617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m12:47:53.175489 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:47:53.180707 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:47:53.182668 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:47:53.184696 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:47:53.186657 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:47:53.186657 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: BEGIN
[0m12:47:53.186657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:53.224027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m12:47:53.224027 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:47:53.224027 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from "DBT"."raw"."dim_listings_cleansed"
where listing_id is null



      
    ) dbt_internal_test
[0m12:47:53.228666 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:47:53.231659 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: ROLLBACK
[0m12:47:53.232843 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m12:47:53.233675 [info ] [Thread-1 (]: 16 of 22 PASS not_null_dim_listings_cleansed_listing_id ........................ [[32mPASS[0m in 0.06s]
[0m12:47:53.234652 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:47:53.234652 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:47:53.235649 [info ] [Thread-1 (]: 17 of 22 START test not_null_fct_reviews_reviewer_name ......................... [RUN]
[0m12:47:53.236646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88)
[0m12:47:53.236646 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:47:53.242630 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m12:47:53.243628 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:47:53.246619 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m12:47:53.247640 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m12:47:53.247640 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: BEGIN
[0m12:47:53.248694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:53.286800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m12:47:53.286800 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m12:47:53.287835 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reviewer_name
from "DBT"."raw"."fct_reviews"
where reviewer_name is null



      
    ) dbt_internal_test
[0m12:47:53.392968 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.105 seconds
[0m12:47:53.395940 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: ROLLBACK
[0m12:47:53.397208 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: Close
[0m12:47:53.397935 [info ] [Thread-1 (]: 17 of 22 PASS not_null_fct_reviews_reviewer_name ............................... [[32mPASS[0m in 0.16s]
[0m12:47:53.399892 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:47:53.401369 [debug] [Thread-1 (]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:47:53.401931 [info ] [Thread-1 (]: 18 of 22 START test positive_value_dim_listings_cleansed_minimum_nights ........ [RUN]
[0m12:47:53.402975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88, now test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313)
[0m12:47:53.403922 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:47:53.412901 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m12:47:53.414852 [debug] [Thread-1 (]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:47:53.419837 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m12:47:53.421832 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m12:47:53.422829 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: BEGIN
[0m12:47:53.424862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:53.465675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m12:47:53.466703 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m12:47:53.466703 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
    *
FROM
    "DBT"."raw"."dim_listings_cleansed"
WHERE
    minimum_nights < 1

      
    ) dbt_internal_test
[0m12:47:53.472698 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:47:53.475676 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: ROLLBACK
[0m12:47:53.476676 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m12:47:53.476676 [info ] [Thread-1 (]: 18 of 22 PASS positive_value_dim_listings_cleansed_minimum_nights .............. [[32mPASS[0m in 0.07s]
[0m12:47:53.478173 [debug] [Thread-1 (]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:47:53.479501 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:47:53.480172 [info ] [Thread-1 (]: 19 of 22 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m12:47:53.481198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313, now test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m12:47:53.481198 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:47:53.494168 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:47:53.501505 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:47:53.506515 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:47:53.507863 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:47:53.508597 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: BEGIN
[0m12:47:53.509594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:53.554258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m12:47:53.555255 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:47:53.555255 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from "DBT"."raw"."dim_listings_cleansed"
    where host_id is not null
),

parent as (
    select host_id as to_field
    from "DBT"."raw"."dim_hosts_cleansed"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:47:53.567634 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m12:47:53.569624 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: ROLLBACK
[0m12:47:53.570387 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m12:47:53.570622 [info ] [Thread-1 (]: 19 of 22 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.09s]
[0m12:47:53.572588 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:47:53.573595 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:47:53.574583 [info ] [Thread-1 (]: 20 of 22 START test relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_  [RUN]
[0m12:47:53.575580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe)
[0m12:47:53.575580 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:47:53.585582 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m12:47:53.587549 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:47:53.592810 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m12:47:53.594544 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m12:47:53.595528 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: BEGIN
[0m12:47:53.596525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:53.640537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m12:47:53.640537 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m12:47:53.641436 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select listing_id as from_field
    from "DBT"."raw"."fct_reviews"
    where listing_id is not null
),

parent as (
    select listing_id as to_field
    from "DBT"."raw"."dim_listings_cleansed"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:47:53.885363 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.244 seconds
[0m12:47:53.889401 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: ROLLBACK
[0m12:47:53.891346 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: Close
[0m12:47:53.892380 [info ] [Thread-1 (]: 20 of 22 PASS relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_  [[32mPASS[0m in 0.32s]
[0m12:47:53.895380 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:47:53.896385 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:47:53.897379 [info ] [Thread-1 (]: 21 of 22 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m12:47:53.899326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe, now test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347)
[0m12:47:53.900323 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:47:53.916307 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m12:47:53.917375 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:47:53.920930 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m12:47:53.921922 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m12:47:53.922895 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: BEGIN
[0m12:47:53.922895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:53.963593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:47:53.963593 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m12:47:53.964626 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from "DBT"."raw"."dim_hosts_cleansed"
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:47:53.973813 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m12:47:53.975810 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: ROLLBACK
[0m12:47:53.976661 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m12:47:53.977533 [info ] [Thread-1 (]: 21 of 22 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 0.08s]
[0m12:47:53.978499 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:47:53.979497 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:47:53.979497 [info ] [Thread-1 (]: 22 of 22 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m12:47:53.980495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347, now test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m12:47:53.980495 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:47:53.987476 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:47:53.989484 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:47:53.993494 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:47:53.995456 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:47:53.996487 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: BEGIN
[0m12:47:53.997477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:54.041363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m12:47:54.041363 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:47:54.042388 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from "DBT"."raw"."dim_listings_cleansed"
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:47:54.055324 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m12:47:54.058348 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: ROLLBACK
[0m12:47:54.059315 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m12:47:54.060312 [info ] [Thread-1 (]: 22 of 22 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.08s]
[0m12:47:54.061310 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:47:54.063305 [info ] [MainThread]: 
[0m12:47:54.064301 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:54.064301 [debug] [MainThread]: On master: BEGIN
[0m12:47:54.065300 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:54.276371 [debug] [MainThread]: SQL status: BEGIN in 0.211 seconds
[0m12:47:54.277377 [debug] [MainThread]: On master: COMMIT
[0m12:47:54.278376 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:54.279374 [debug] [MainThread]: On master: COMMIT
[0m12:47:54.280606 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:47:54.304259 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:47:54.310245 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:54.311241 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw_dbt_test__audit', 'test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4', 'test',
'2025-02-02 11:47:48.936493+00:00',
'2025-02-02 11:47:50.840623',
'2025-02-02 11:47:50.948341'
,'pass','0.11101317405700684',
'eddeb7ec-9436-4bed-adf0-6992ae77dea2','1.9.1',CURRENT_TIMESTAMP(0),'1');
           
      
  
[0m12:47:54.320214 [debug] [MainThread]: Postgres adapter: Postgres error: value too long for type character varying(50)

[0m12:47:54.324507 [debug] [MainThread]: On master: Close
[0m12:47:54.334511 [info ] [MainThread]: 
[0m12:47:54.335476 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m12:47:54.336533 [info ] [MainThread]: 
[0m12:47:54.337472 [error] [MainThread]: [31mFailure in test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_roo__Hotel_room (models\schema.yml)[0m
[0m12:47:54.338470 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:47:54.339466 [info ] [MainThread]: 
[0m12:47:54.340464 [info ] [MainThread]:   compiled code at target\compiled\dbtlearn\models\schema.yml\accepted_values_dim_listings_c_49d727b581d069fce87f6ed60d422549.sql
[0m12:47:54.341461 [info ] [MainThread]: 
[0m12:47:54.342459 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m12:47:54.344717 [info ] [MainThread]: 
[0m12:47:54.345451 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_39596d790161761077ff1592b68943f6.sql
[0m12:47:54.347446 [info ] [MainThread]: 
[0m12:47:54.348614 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number (models\schema.yml)
  syntax error at or near ")"
  LINE 10:     ),
               ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_07e7a515218ef6e3a17e164c642c7d18.sql
[0m12:47:54.350439 [info ] [MainThread]: 
[0m12:47:54.352433 [error] [MainThread]:   Database Error in test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_ (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                   ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_table__fbda7436ebe2ffe341acf0622c76d629.sql
[0m12:47:54.354447 [info ] [MainThread]: 
[0m12:47:54.356423 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models\sources.yml)[0m
[0m12:47:54.357475 [error] [MainThread]:   Got 17499 results, configured to fail if != 0
[0m12:47:54.358416 [info ] [MainThread]: 
[0m12:47:54.359467 [info ] [MainThread]:   compiled code at target\compiled\dbtlearn\models\sources.yml\dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb.sql
[0m12:47:54.360410 [info ] [MainThread]: 
[0m12:47:54.361409 [error] [MainThread]:   Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql
[0m12:47:54.365484 [info ] [MainThread]: 
[0m12:47:54.373376 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=7 SKIP=0 TOTAL=22
[0m12:47:54.376641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:54.377491 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m12:47:54.378705 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m12:47:54.379360 [info ] [MainThread]: 
[0m12:47:54.380357 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 3.98 seconds (3.98s).
[0m12:47:54.381355 [error] [MainThread]: Encountered an error:
Database Error
  value too long for type character varying(50)
[0m12:47:54.383349 [debug] [MainThread]: Command `dbt test` failed at 12:47:54.383349 after 5.55 seconds
[0m12:47:54.384346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EBEA90B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EC0D04D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EC0C2EA20>]}
[0m12:47:54.384346 [debug] [MainThread]: Flushing usage events
[0m12:47:55.134261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:15.250706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B834701850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B834700710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B833039460>]}


============================== 12:49:15.255700 | 63b2c65b-4b1c-4c89-a2ab-d82c045f5645 ==============================
[0m12:49:15.255700 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:49:15.256866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:49:15.493868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63b2c65b-4b1c-4c89-a2ab-d82c045f5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8347D90A0>]}
[0m12:49:15.563677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63b2c65b-4b1c-4c89-a2ab-d82c045f5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B834FE2660>]}
[0m12:49:15.565675 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:49:15.794485 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:49:16.121239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:49:16.122237 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models\schema.yml
[0m12:49:16.659697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63b2c65b-4b1c-4c89-a2ab-d82c045f5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B835690FB0>]}
[0m12:49:16.828237 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:49:16.831979 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:49:16.875481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63b2c65b-4b1c-4c89-a2ab-d82c045f5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8370F6FC0>]}
[0m12:49:16.877938 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:49:16.878698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b2c65b-4b1c-4c89-a2ab-d82c045f5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B836D936B0>]}
[0m12:49:16.880693 [info ] [MainThread]: 
[0m12:49:16.882211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:16.882688 [info ] [MainThread]: 
[0m12:49:16.883686 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:49:16.889733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m12:49:16.971634 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:49:16.971634 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:49:16.971634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:17.014121 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m12:49:17.015216 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:49:17.016117 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:49:17.033476 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m12:49:17.036112 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:49:17.038060 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:49:17.039058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m12:49:17.045680 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:49:17.046698 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:49:17.046698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:17.116076 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m12:49:17.116674 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:49:17.117648 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:49:17.129612 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.012 seconds
[0m12:49:17.132604 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:49:17.133602 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:49:17.149559 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:17.150557 [debug] [MainThread]: On master: BEGIN
[0m12:49:17.150557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:17.191446 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m12:49:17.191446 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:17.191446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:49:17.202417 [debug] [MainThread]: SQL status: SELECT 3 in 0.010 seconds
[0m12:49:17.204448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b2c65b-4b1c-4c89-a2ab-d82c045f5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8326C2A50>]}
[0m12:49:17.205411 [debug] [MainThread]: On master: ROLLBACK
[0m12:49:17.205411 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:17.205411 [debug] [MainThread]: On master: BEGIN
[0m12:49:17.206408 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:49:17.206408 [debug] [MainThread]: On master: COMMIT
[0m12:49:17.207405 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:17.207405 [debug] [MainThread]: On master: COMMIT
[0m12:49:17.208435 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:49:17.208435 [debug] [MainThread]: On master: Close
[0m12:49:17.273232 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:49:17.274531 [info ] [Thread-1 (]: 1 of 22 START test accepted_values_dim_hosts_cleansed_is_superhost__t__f ....... [RUN]
[0m12:49:17.276305 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4'
[0m12:49:17.277220 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:49:17.305143 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m12:49:17.307235 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:49:17.332072 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m12:49:17.333373 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m12:49:17.334068 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: BEGIN
[0m12:49:17.334068 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:17.373540 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m12:49:17.374578 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m12:49:17.374578 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_superhost as value_field,
        count(*) as n_records

    from "DBT"."raw"."dim_hosts_cleansed"
    group by is_superhost

)

select *
from all_values
where value_field not in (
    't','f'
)



      
    ) dbt_internal_test
[0m12:49:17.379821 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:49:17.384813 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: ROLLBACK
[0m12:49:17.385515 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: Close
[0m12:49:17.385843 [info ] [Thread-1 (]: 1 of 22 PASS accepted_values_dim_hosts_cleansed_is_superhost__t__f ............. [[32mPASS[0m in 0.11s]
[0m12:49:17.387802 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:49:17.388005 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:49:17.388799 [info ] [Thread-1 (]: 2 of 22 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m12:49:17.389798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4, now test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m12:49:17.389798 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:49:17.394785 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m12:49:17.396336 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:49:17.398774 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m12:49:17.400350 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m12:49:17.400769 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: BEGIN
[0m12:49:17.400769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:17.604396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.203 seconds
[0m12:49:17.605395 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m12:49:17.606389 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from "DBT"."raw"."dim_listings_cleansed"
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m12:49:17.618360 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m12:49:17.622394 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: ROLLBACK
[0m12:49:17.623539 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m12:49:17.625343 [info ] [Thread-1 (]: 2 of 22 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.23s]
[0m12:49:17.627333 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:49:17.629329 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:49:17.630319 [info ] [Thread-1 (]: 3 of 22 START test accepted_values_fct_reviews_review_sentiment__positive__neutral__negative  [RUN]
[0m12:49:17.631712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef)
[0m12:49:17.633605 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:49:17.650521 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m12:49:17.652517 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:49:17.660495 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m12:49:17.663489 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m12:49:17.664485 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: BEGIN
[0m12:49:17.665976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:17.705370 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:49:17.706368 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m12:49:17.706368 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        review_sentiment as value_field,
        count(*) as n_records

    from "DBT"."raw"."fct_reviews"
    group by review_sentiment

)

select *
from all_values
where value_field not in (
    'positive','neutral','negative'
)



      
    ) dbt_internal_test
[0m12:49:17.794636 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.087 seconds
[0m12:49:17.795633 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: ROLLBACK
[0m12:49:17.796688 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: Close
[0m12:49:17.797629 [info ] [Thread-1 (]: 3 of 22 PASS accepted_values_fct_reviews_review_sentiment__positive__neutral__negative  [[32mPASS[0m in 0.17s]
[0m12:49:17.799624 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:49:17.800652 [debug] [Thread-1 (]: Began running node test.dbtlearn.consistent_created_at
[0m12:49:17.801180 [info ] [Thread-1 (]: 4 of 22 START test consistent_created_at ....................................... [RUN]
[0m12:49:17.801648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef, now test.dbtlearn.consistent_created_at)
[0m12:49:17.802647 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.consistent_created_at
[0m12:49:17.805639 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m12:49:17.806605 [debug] [Thread-1 (]: Began executing node test.dbtlearn.consistent_created_at
[0m12:49:17.811592 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.consistent_created_at"
[0m12:49:17.813910 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.consistent_created_at"
[0m12:49:17.815583 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: BEGIN
[0m12:49:17.816579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:17.886440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m12:49:17.887429 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.consistent_created_at"
[0m12:49:17.887429 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * FROM "DBT"."raw"."dim_listings_cleansed" l
INNER JOIN "DBT"."raw"."fct_reviews" r
USING (listing_id)
WHERE l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m12:49:18.049112 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.161 seconds
[0m12:49:18.051127 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: ROLLBACK
[0m12:49:18.052108 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: Close
[0m12:49:18.053105 [info ] [Thread-1 (]: 4 of 22 PASS consistent_created_at ............................................. [[32mPASS[0m in 0.25s]
[0m12:49:18.054101 [debug] [Thread-1 (]: Finished running node test.dbtlearn.consistent_created_at
[0m12:49:18.055098 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:49:18.055705 [info ] [Thread-1 (]: 5 of 22 START test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [RUN]
[0m12:49:18.056094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.consistent_created_at, now test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75)
[0m12:49:18.056094 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:49:18.077038 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m12:49:18.078036 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:49:18.081027 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m12:49:18.082024 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m12:49:18.082024 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: BEGIN
[0m12:49:18.083053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:18.117863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m12:49:18.117863 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m12:49:18.118905 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  
( 1=1 and max(price) <= 5000
)
 as expression


    from "DBT"."raw"."dim_listings_w_hosts"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m12:49:18.119858 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.dim_listings_w_hosts" does not exist
LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                  ^

[0m12:49:18.120885 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: ROLLBACK
[0m12:49:18.121501 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: Close
[0m12:49:18.126871 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m12:49:18.126871 [error] [Thread-1 (]: 5 of 22 ERROR dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [[31mERROR[0m in 0.07s]
[0m12:49:18.128833 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:49:18.128833 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:49:18.130309 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql.
[0m12:49:18.129864 [info ] [Thread-1 (]: 6 of 22 START test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [RUN]
[0m12:49:18.131826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75, now test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970)
[0m12:49:18.131826 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:49:18.145821 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m12:49:18.146823 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:49:18.149809 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m12:49:18.150809 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m12:49:18.151559 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: BEGIN
[0m12:49:18.151809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:18.196652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m12:49:18.197649 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m12:49:18.197649 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and percentile_cont(0.99) within group (order by price) >= 50 and percentile_cont(0.99) within group (order by price) <= 500
)
 as expression


    from "DBT"."raw"."dim_listings_w_hosts"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m12:49:18.199644 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.dim_listings_w_hosts" does not exist
LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                  ^

[0m12:49:18.200641 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: ROLLBACK
[0m12:49:18.202051 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: Close
[0m12:49:18.206626 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_39596d790161761077ff1592b68943f6.sql
[0m12:49:18.207658 [error] [Thread-1 (]: 6 of 22 ERROR dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [[31mERROR[0m in 0.08s]
[0m12:49:18.210095 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:49:18.210095 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:49:18.211093 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_39596d790161761077ff1592b68943f6.sql.
[0m12:49:18.212569 [info ] [Thread-1 (]: 7 of 22 START test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [RUN]
[0m12:49:18.214057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970, now test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a)
[0m12:49:18.214057 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:49:18.253982 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m12:49:18.254975 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: BEGIN
[0m12:49:18.255983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:18.296852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m12:49:18.297768 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m12:49:18.297768 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'dim_listings_w_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m12:49:18.315684 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.017 seconds
[0m12:49:18.319673 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m12:49:18.320714 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:49:18.323663 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m12:49:18.324659 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m12:49:18.325657 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PRICE'
            and
            relation_column_type not in ('NUMBER')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m12:49:18.326654 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 10:     ),
             ^

[0m12:49:18.326654 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: ROLLBACK
[0m12:49:18.327651 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: Close
[0m12:49:18.333636 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number (models\schema.yml)
  syntax error at or near ")"
  LINE 10:     ),
               ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_07e7a515218ef6e3a17e164c642c7d18.sql
[0m12:49:18.335630 [error] [Thread-1 (]: 7 of 22 ERROR dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [[31mERROR[0m in 0.12s]
[0m12:49:18.336627 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:49:18.337625 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:49:18.338623 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number (models\schema.yml)
  syntax error at or near ")"
  LINE 10:     ),
               ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_07e7a515218ef6e3a17e164c642c7d18.sql.
[0m12:49:18.338623 [info ] [Thread-1 (]: 8 of 22 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m12:49:18.339621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a, now test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da)
[0m12:49:18.340617 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:49:18.373528 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m12:49:18.374525 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:49:18.377517 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m12:49:18.378586 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m12:49:18.379512 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: BEGIN
[0m12:49:18.379512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:18.416676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m12:49:18.417568 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m12:49:18.417568 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        "DBT"."raw"."dim_listings_w_hosts"
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        "DBT"."raw"."raw_listings"
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m12:49:18.419230 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.dim_listings_w_hosts" does not exist
LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                 ^

[0m12:49:18.419527 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: ROLLBACK
[0m12:49:18.420524 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m12:49:18.423516 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_ (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                   ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_table__fbda7436ebe2ffe341acf0622c76d629.sql
[0m12:49:18.423516 [error] [Thread-1 (]: 8 of 22 ERROR dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[31mERROR[0m in 0.08s]
[0m12:49:18.425546 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:49:18.425546 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:49:18.426653 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_ (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                   ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_table__fbda7436ebe2ffe341acf0622c76d629.sql.
[0m12:49:18.426653 [info ] [Thread-1 (]: 9 of 22 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m12:49:18.427506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da, now test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65)
[0m12:49:18.428538 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:49:18.435523 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:49:18.436489 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:49:18.439510 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:49:18.440682 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:49:18.442489 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: BEGIN
[0m12:49:18.443464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:18.481698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m12:49:18.482625 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:49:18.482625 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct room_type) = 4
 as expression


    from "DBT"."raw"."raw_listings"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m12:49:18.491567 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m12:49:18.493563 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: ROLLBACK
[0m12:49:18.494741 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: Close
[0m12:49:18.495622 [info ] [Thread-1 (]: 9 of 22 PASS dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[32mPASS[0m in 0.07s]
[0m12:49:18.496619 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:49:18.496619 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:49:18.497890 [info ] [Thread-1 (]: 10 of 22 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m12:49:18.498614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65, now test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9)
[0m12:49:18.498614 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:49:18.512577 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:49:18.514585 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:49:18.518595 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:49:18.520556 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:49:18.521944 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: BEGIN
[0m12:49:18.522550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:18.559662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m12:49:18.559662 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:49:18.560699 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(price, '^\\$[0-9][0-9\\.]+$', '')), 1), 0)


 > 0
 as expression


    from "DBT"."raw"."raw_listings"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





      
    ) dbt_internal_test
[0m12:49:18.571726 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m12:49:18.573745 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: ROLLBACK
[0m12:49:18.574916 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: Close
[0m12:49:18.575719 [error] [Thread-1 (]: 10 of 22 FAIL 17499 dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[31mFAIL 17499[0m in 0.08s]
[0m12:49:18.577713 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:49:18.577713 [debug] [Thread-1 (]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m12:49:18.578886 [info ] [Thread-1 (]: 11 of 22 START test dim_listings_minimum_nights ................................ [RUN]
[0m12:49:18.579709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9, now test.dbtlearn.dim_listings_minimum_nights)
[0m12:49:18.579709 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m12:49:18.583698 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m12:49:18.584696 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m12:49:18.587687 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dim_listings_minimum_nights"
[0m12:49:18.588685 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dim_listings_minimum_nights"
[0m12:49:18.588685 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: BEGIN
[0m12:49:18.589682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:18.628792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:49:18.629649 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dim_listings_minimum_nights"
[0m12:49:18.629649 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM
    "DBT"."raw"."dim_listings_cleansed"
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m12:49:18.634648 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:49:18.637595 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: ROLLBACK
[0m12:49:18.638632 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m12:49:18.639617 [info ] [Thread-1 (]: 11 of 22 PASS dim_listings_minimum_nights ...................................... [[32mPASS[0m in 0.06s]
[0m12:49:18.640587 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m12:49:18.641851 [debug] [Thread-1 (]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m12:49:18.641851 [info ] [Thread-1 (]: 12 of 22 START test no_nulls_in_dim_listings ................................... [RUN]
[0m12:49:18.642615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dim_listings_minimum_nights, now test.dbtlearn.no_nulls_in_dim_listings)
[0m12:49:18.643614 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m12:49:18.650592 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m12:49:18.651595 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: BEGIN
[0m12:49:18.651595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:18.859177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.207 seconds
[0m12:49:18.859177 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m12:49:18.860173 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'dim_listings_cleansed'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m12:49:18.876665 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.016 seconds
[0m12:49:18.877702 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m12:49:18.878698 [debug] [Thread-1 (]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m12:49:18.881652 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m12:49:18.883473 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m12:49:18.883645 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM "DBT"."raw"."dim_listings_cleansed" WHERE
    listing_id IS NULL OR
    listing_name IS NULL OR
    room_type IS NULL OR
    minimum_nights IS NULL OR
    host_id IS NULL OR
    price_str IS NULL OR
    created_at IS NULL OR
    updated_at IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m12:49:18.888672 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:49:18.890629 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: ROLLBACK
[0m12:49:18.891226 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m12:49:18.891626 [info ] [Thread-1 (]: 12 of 22 PASS no_nulls_in_dim_listings ......................................... [[32mPASS[0m in 0.25s]
[0m12:49:18.892622 [debug] [Thread-1 (]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m12:49:18.892622 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:49:18.894046 [info ] [Thread-1 (]: 13 of 22 START test not_null_dim_hosts_cleansed_host_id ........................ [RUN]
[0m12:49:18.894616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.no_nulls_in_dim_listings, now test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05)
[0m12:49:18.894616 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:49:18.902595 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m12:49:18.903592 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:49:18.906584 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m12:49:18.908579 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m12:49:18.908579 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: BEGIN
[0m12:49:18.909576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:19.080785 [debug] [Thread-1 (]: SQL status: BEGIN in 0.172 seconds
[0m12:49:19.081831 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m12:49:19.083128 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from "DBT"."raw"."dim_hosts_cleansed"
where host_id is null



      
    ) dbt_internal_test
[0m12:49:19.089114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:49:19.093157 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: ROLLBACK
[0m12:49:19.094227 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m12:49:19.096097 [info ] [Thread-1 (]: 13 of 22 PASS not_null_dim_hosts_cleansed_host_id .............................. [[32mPASS[0m in 0.20s]
[0m12:49:19.098091 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:49:19.100085 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:49:19.101248 [info ] [Thread-1 (]: 14 of 22 START test not_null_dim_hosts_cleansed_host_name ...................... [RUN]
[0m12:49:19.103122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05, now test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830)
[0m12:49:19.104075 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:49:19.121076 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m12:49:19.123029 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:49:19.129074 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m12:49:19.131005 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m12:49:19.132245 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: BEGIN
[0m12:49:19.132997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:19.191249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m12:49:19.192317 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m12:49:19.193245 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_name
from "DBT"."raw"."dim_hosts_cleansed"
where host_name is null



      
    ) dbt_internal_test
[0m12:49:19.194241 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "host_name" does not exist
LINE 13: select host_name
                ^

[0m12:49:19.195274 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: ROLLBACK
[0m12:49:19.196237 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: Close
[0m12:49:19.203266 [debug] [Thread-1 (]: Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql
[0m12:49:19.205261 [error] [Thread-1 (]: 14 of 22 ERROR not_null_dim_hosts_cleansed_host_name ........................... [[31mERROR[0m in 0.10s]
[0m12:49:19.207196 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:49:19.208496 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:49:19.209194 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql.
[0m12:49:19.211187 [info ] [Thread-1 (]: 15 of 22 START test not_null_dim_listings_cleansed_host_id ..................... [RUN]
[0m12:49:19.213135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830, now test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m12:49:19.214178 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:49:19.226100 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:49:19.228095 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:49:19.232113 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:49:19.233109 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:49:19.234080 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: BEGIN
[0m12:49:19.235074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:19.278620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m12:49:19.279534 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:49:19.279534 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from "DBT"."raw"."dim_listings_cleansed"
where host_id is null



      
    ) dbt_internal_test
[0m12:49:19.284490 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:49:19.286884 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: ROLLBACK
[0m12:49:19.287513 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m12:49:19.288478 [info ] [Thread-1 (]: 15 of 22 PASS not_null_dim_listings_cleansed_host_id ........................... [[32mPASS[0m in 0.08s]
[0m12:49:19.289477 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:49:19.290474 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:49:19.290474 [info ] [Thread-1 (]: 16 of 22 START test not_null_dim_listings_cleansed_listing_id .................. [RUN]
[0m12:49:19.291501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m12:49:19.292495 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:49:19.297482 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:49:19.298479 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:49:19.301884 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:49:19.303632 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:49:19.304438 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: BEGIN
[0m12:49:19.304438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:19.377429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m12:49:19.378467 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:49:19.378572 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from "DBT"."raw"."dim_listings_cleansed"
where listing_id is null



      
    ) dbt_internal_test
[0m12:49:19.385528 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:49:19.389567 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: ROLLBACK
[0m12:49:19.390523 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m12:49:19.392510 [info ] [Thread-1 (]: 16 of 22 PASS not_null_dim_listings_cleansed_listing_id ........................ [[32mPASS[0m in 0.10s]
[0m12:49:19.395126 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:49:19.396503 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:49:19.397500 [info ] [Thread-1 (]: 17 of 22 START test not_null_fct_reviews_reviewer_name ......................... [RUN]
[0m12:49:19.399493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88)
[0m12:49:19.400536 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:49:19.409477 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m12:49:19.412459 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:49:19.416474 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m12:49:19.417471 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m12:49:19.417471 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: BEGIN
[0m12:49:19.418647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:19.640426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.221 seconds
[0m12:49:19.641427 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m12:49:19.642423 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reviewer_name
from "DBT"."raw"."fct_reviews"
where reviewer_name is null



      
    ) dbt_internal_test
[0m12:49:19.730348 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.087 seconds
[0m12:49:19.736326 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: ROLLBACK
[0m12:49:19.738317 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: Close
[0m12:49:19.739589 [info ] [Thread-1 (]: 17 of 22 PASS not_null_fct_reviews_reviewer_name ............................... [[32mPASS[0m in 0.34s]
[0m12:49:19.741310 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:49:19.742292 [debug] [Thread-1 (]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:49:19.742292 [info ] [Thread-1 (]: 18 of 22 START test positive_value_dim_listings_cleansed_minimum_nights ........ [RUN]
[0m12:49:19.744306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88, now test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313)
[0m12:49:19.745294 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:49:19.752266 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m12:49:19.754225 [debug] [Thread-1 (]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:49:19.759238 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m12:49:19.761207 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m12:49:19.761207 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: BEGIN
[0m12:49:19.762203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:19.806266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m12:49:19.807253 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m12:49:19.807253 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
    *
FROM
    "DBT"."raw"."dim_listings_cleansed"
WHERE
    minimum_nights < 1

      
    ) dbt_internal_test
[0m12:49:19.812201 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:49:19.814196 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: ROLLBACK
[0m12:49:19.814634 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m12:49:19.815633 [info ] [Thread-1 (]: 18 of 22 PASS positive_value_dim_listings_cleansed_minimum_nights .............. [[32mPASS[0m in 0.07s]
[0m12:49:19.816631 [debug] [Thread-1 (]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:49:19.817628 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:49:19.818013 [info ] [Thread-1 (]: 19 of 22 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m12:49:19.818625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313, now test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m12:49:19.818625 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:49:19.826637 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:49:19.828214 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:49:19.831620 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:49:19.832689 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:49:19.832689 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: BEGIN
[0m12:49:19.833588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:19.872360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m12:49:19.872360 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:49:19.873390 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from "DBT"."raw"."dim_listings_cleansed"
    where host_id is not null
),

parent as (
    select host_id as to_field
    from "DBT"."raw"."dim_hosts_cleansed"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:19.882350 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m12:49:19.884695 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: ROLLBACK
[0m12:49:19.885303 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m12:49:19.887304 [info ] [Thread-1 (]: 19 of 22 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.07s]
[0m12:49:19.890324 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:49:19.890324 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:49:19.891318 [info ] [Thread-1 (]: 20 of 22 START test relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_  [RUN]
[0m12:49:19.892284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe)
[0m12:49:19.892284 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:49:19.898303 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m12:49:19.900406 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:49:19.904286 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m12:49:19.906249 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m12:49:19.908246 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: BEGIN
[0m12:49:19.909246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:19.949653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:49:19.950642 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m12:49:19.951686 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select listing_id as from_field
    from "DBT"."raw"."fct_reviews"
    where listing_id is not null
),

parent as (
    select listing_id as to_field
    from "DBT"."raw"."dim_listings_cleansed"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:20.063911 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.112 seconds
[0m12:49:20.067900 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: ROLLBACK
[0m12:49:20.068901 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: Close
[0m12:49:20.070862 [info ] [Thread-1 (]: 20 of 22 PASS relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_  [[32mPASS[0m in 0.18s]
[0m12:49:20.072846 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:49:20.074840 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:49:20.075837 [info ] [Thread-1 (]: 21 of 22 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m12:49:20.077836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe, now test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347)
[0m12:49:20.078829 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:49:20.096785 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m12:49:20.099773 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:49:20.109788 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m12:49:20.111867 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m12:49:20.112772 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: BEGIN
[0m12:49:20.114232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:20.191358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.078 seconds
[0m12:49:20.193404 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m12:49:20.194399 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from "DBT"."raw"."dim_hosts_cleansed"
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:49:20.210307 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m12:49:20.214353 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: ROLLBACK
[0m12:49:20.215895 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m12:49:20.217330 [info ] [Thread-1 (]: 21 of 22 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 0.14s]
[0m12:49:20.220281 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:49:20.221278 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:49:20.222610 [info ] [Thread-1 (]: 22 of 22 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m12:49:20.224270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347, now test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m12:49:20.225307 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:49:20.237280 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:49:20.239231 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:49:20.246255 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:49:20.249206 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:49:20.250606 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: BEGIN
[0m12:49:20.251200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:20.455384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.204 seconds
[0m12:49:20.456442 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:49:20.457430 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from "DBT"."raw"."dim_listings_cleansed"
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:49:20.476991 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m12:49:20.479976 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: ROLLBACK
[0m12:49:20.481923 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m12:49:20.482957 [info ] [Thread-1 (]: 22 of 22 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.26s]
[0m12:49:20.485958 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:49:20.487905 [info ] [MainThread]: 
[0m12:49:20.490273 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:20.491271 [debug] [MainThread]: On master: BEGIN
[0m12:49:20.492315 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:20.565226 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m12:49:20.566225 [debug] [MainThread]: On master: COMMIT
[0m12:49:20.566225 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:20.567224 [debug] [MainThread]: On master: COMMIT
[0m12:49:20.568012 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:49:20.581184 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:49:20.584821 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:20.584821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw_dbt_test__audit', 'test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4', 'test',
'2025-02-02 11:49:15.118195+00:00',
'2025-02-02 11:49:17.278220',
'2025-02-02 11:49:17.383812'
,'pass','0.10953807830810547',
'63b2c65b-4b1c-4c89-a2ab-d82c045f5645','1.9.1',CURRENT_TIMESTAMP(0),'1');
           
      
  
[0m12:49:20.586774 [debug] [MainThread]: Postgres adapter: Postgres error: value too long for type character varying(50)

[0m12:49:20.590361 [debug] [MainThread]: On master: Close
[0m12:49:20.601331 [info ] [MainThread]: 
[0m12:49:20.602329 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m12:49:20.602329 [info ] [MainThread]: 
[0m12:49:20.603326 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m12:49:20.605321 [info ] [MainThread]: 
[0m12:49:20.605321 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_39596d790161761077ff1592b68943f6.sql
[0m12:49:20.607318 [info ] [MainThread]: 
[0m12:49:20.608327 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number (models\schema.yml)
  syntax error at or near ")"
  LINE 10:     ),
               ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_07e7a515218ef6e3a17e164c642c7d18.sql
[0m12:49:20.610308 [info ] [MainThread]: 
[0m12:49:20.610308 [error] [MainThread]:   Database Error in test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_ (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                   ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_table__fbda7436ebe2ffe341acf0622c76d629.sql
[0m12:49:20.612304 [info ] [MainThread]: 
[0m12:49:20.613384 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models\sources.yml)[0m
[0m12:49:20.614301 [error] [MainThread]:   Got 17499 results, configured to fail if != 0
[0m12:49:20.615300 [info ] [MainThread]: 
[0m12:49:20.617327 [info ] [MainThread]:   compiled code at target\compiled\dbtlearn\models\sources.yml\dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb.sql
[0m12:49:20.618289 [info ] [MainThread]: 
[0m12:49:20.619438 [error] [MainThread]:   Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql
[0m12:49:20.620281 [info ] [MainThread]: 
[0m12:49:20.621279 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=6 SKIP=0 TOTAL=22
[0m12:49:20.622278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:20.623275 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m12:49:20.623275 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m12:49:20.624297 [info ] [MainThread]: 
[0m12:49:20.624297 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m12:49:20.625740 [error] [MainThread]: Encountered an error:
Database Error
  value too long for type character varying(50)
[0m12:49:20.627262 [debug] [MainThread]: Command `dbt test` failed at 12:49:20.627262 after 5.61 seconds
[0m12:49:20.627262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B835096300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B836BA0470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B836A98A40>]}
[0m12:49:20.628260 [debug] [MainThread]: Flushing usage events
[0m12:49:21.372846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:25.834724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22060A330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2201B8B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2226DC170>]}


============================== 12:55:25.840715 | c6afa39b-3efa-4744-a824-00c25899f3e4 ==============================
[0m12:55:25.840715 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:55:25.842710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:55:26.066138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6afa39b-3efa-4744-a824-00c25899f3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2202AD730>]}
[0m12:55:26.134954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6afa39b-3efa-4744-a824-00c25899f3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2230C0B60>]}
[0m12:55:26.136908 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:55:26.361430 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:55:26.744033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:55:26.744033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:55:26.836250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6afa39b-3efa-4744-a824-00c25899f3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22321D400>]}
[0m12:55:27.003514 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:55:27.008117 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:55:27.114452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6afa39b-3efa-4744-a824-00c25899f3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2246C4470>]}
[0m12:55:27.115122 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:55:27.119655 [info ] [MainThread]: 
[0m12:55:27.121096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:55:27.121652 [info ] [MainThread]: 
[0m12:55:27.122651 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:55:27.129639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m12:55:27.219709 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:55:27.220739 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:55:27.220739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:27.450281 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.229 seconds
[0m12:55:27.455266 [debug] [ThreadPool]: On list_DBT: Close
[0m12:55:27.465238 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:55:27.466251 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:55:27.467235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:27.522816 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.055 seconds
[0m12:55:27.523850 [debug] [ThreadPool]: On list_DBT: Close
[0m12:55:27.526244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m12:55:27.532790 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:55:27.532790 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:55:27.533818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:27.566896 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m12:55:27.566896 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:55:27.567893 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:55:27.575590 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.007 seconds
[0m12:55:27.577520 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:55:27.578108 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:55:27.578520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_raw, now list_DBT_DEV)
[0m12:55:27.581506 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:55:27.586190 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:55:27.586190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:27.638547 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m12:55:27.639583 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:55:27.639583 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:55:27.654355 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m12:55:27.657299 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:55:27.658893 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:55:27.671311 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:27.672309 [debug] [MainThread]: On master: BEGIN
[0m12:55:27.672309 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:27.730768 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m12:55:27.730768 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:27.730768 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:55:27.740714 [debug] [MainThread]: SQL status: SELECT 3 in 0.009 seconds
[0m12:55:27.741746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6afa39b-3efa-4744-a824-00c25899f3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C224E21550>]}
[0m12:55:27.742748 [debug] [MainThread]: On master: ROLLBACK
[0m12:55:27.743321 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:27.743321 [debug] [MainThread]: On master: BEGIN
[0m12:55:27.744337 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:55:27.744337 [debug] [MainThread]: On master: COMMIT
[0m12:55:27.744337 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:27.745370 [debug] [MainThread]: On master: COMMIT
[0m12:55:27.745898 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:55:27.745898 [debug] [MainThread]: On master: Close
[0m12:55:27.748475 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:55:27.748475 [info ] [Thread-1 (]: 1 of 33 START sql table model raw.src_hosts .................................... [RUN]
[0m12:55:27.749452 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_hosts'
[0m12:55:27.750449 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:55:27.758434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:55:27.759442 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m12:55:27.802317 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m12:55:27.804664 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m12:55:27.805303 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: BEGIN
[0m12:55:27.805303 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:55:27.857733 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m12:55:27.858743 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m12:55:27.859750 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */

  
    

  create  table "DBT"."raw"."src_hosts__dbt_tmp"
  
  
    as
  
  (
    WITH raw_hosts AS (
    SELECT
        *
    FROM
       "DBT"."raw"."raw_hosts"
)
SELECT
    id AS host_id,
    NAME AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
  
[0m12:55:27.882114 [debug] [Thread-1 (]: SQL status: SELECT 14111 in 0.021 seconds
[0m12:55:27.902067 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m12:55:27.903060 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
alter table "DBT"."raw"."src_hosts" rename to "src_hosts__dbt_backup"
[0m12:55:27.905055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:55:27.913030 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m12:55:27.913030 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
alter table "DBT"."raw"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m12:55:27.915028 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:55:27.984792 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: COMMIT
[0m12:55:27.985488 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m12:55:27.985789 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: COMMIT
[0m12:55:28.000750 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m12:55:28.008762 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."src_hosts__dbt_backup"
[0m12:55:28.013746 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_hosts"
[0m12:55:28.014747 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
drop table if exists "DBT"."raw"."src_hosts__dbt_backup" cascade
[0m12:55:28.018702 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:55:28.021731 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m12:55:28.024117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6afa39b-3efa-4744-a824-00c25899f3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C224B3A120>]}
[0m12:55:28.025206 [info ] [Thread-1 (]: 1 of 33 OK created sql table model raw.src_hosts ............................... [[32mSELECT 14111[0m in 0.27s]
[0m12:55:28.026205 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:55:28.027202 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:55:28.027202 [info ] [Thread-1 (]: 2 of 33 START sql table model raw.src_reviews .................................. [RUN]
[0m12:55:28.028200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_reviews)
[0m12:55:28.028200 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:55:28.032189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:55:28.032728 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m12:55:28.037277 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m12:55:28.039220 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m12:55:28.039788 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: BEGIN
[0m12:55:28.040247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:28.079379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m12:55:28.080330 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m12:55:28.080330 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */

  
    

  create  table "DBT"."raw"."src_reviews__dbt_tmp"
  
  
    as
  
  (
    WITH raw_reviews AS (
    SELECT
        *
    FROM
        "DBT"."raw"."raw_reviews"
)
SELECT
    listing_id,
    review_date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
  
[0m12:55:33.392551 [debug] [Thread-1 (]: SQL status: SELECT 410284 in 5.311 seconds
[0m12:55:33.401569 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m12:55:33.402567 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
alter table "DBT"."raw"."src_reviews" rename to "src_reviews__dbt_backup"
[0m12:55:33.403519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:55:33.416527 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m12:55:33.417527 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
alter table "DBT"."raw"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m12:55:33.419492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:55:33.422515 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: COMMIT
[0m12:55:33.423510 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m12:55:33.424511 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: COMMIT
[0m12:55:33.428953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:55:33.437979 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."src_reviews__dbt_backup"
[0m12:55:33.438979 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.src_reviews"
[0m12:55:33.439960 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
drop table if exists "DBT"."raw"."src_reviews__dbt_backup" cascade
[0m12:55:33.470840 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.030 seconds
[0m12:55:33.474826 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m12:55:33.475820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6afa39b-3efa-4744-a824-00c25899f3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C225291F70>]}
[0m12:55:33.477998 [info ] [Thread-1 (]: 2 of 33 OK created sql table model raw.src_reviews ............................. [[32mSELECT 410284[0m in 5.45s]
[0m12:55:33.479765 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:55:33.481484 [debug] [Thread-1 (]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m12:55:33.482757 [info ] [Thread-1 (]: 3 of 33 START seed file raw.seed_full_moon_dates ............................... [RUN]
[0m12:55:33.484848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now seed.dbtlearn.seed_full_moon_dates)
[0m12:55:33.486790 [debug] [Thread-1 (]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m12:55:33.487831 [debug] [Thread-1 (]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m12:55:33.537766 [debug] [Thread-1 (]: Using postgres connection "seed.dbtlearn.seed_full_moon_dates"
[0m12:55:33.538609 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: BEGIN
[0m12:55:33.538609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:33.735625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.196 seconds
[0m12:55:33.736622 [debug] [Thread-1 (]: Using postgres connection "seed.dbtlearn.seed_full_moon_dates"
[0m12:55:33.737723 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
truncate table "DBT"."raw"."seed_full_moon_dates"
[0m12:55:33.740612 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m12:55:33.787481 [debug] [Thread-1 (]: Using postgres connection "seed.dbtlearn.seed_full_moon_dates"
[0m12:55:33.787481 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: 
          insert into "DBT"."raw"."seed_full_moon_dates" ("full_moon_date") values
          (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s...
[0m12:55:33.791122 [debug] [Thread-1 (]: SQL status: INSERT 0 272 in 0.003 seconds
[0m12:55:33.797147 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m12:55:33.800136 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: COMMIT
[0m12:55:33.800136 [debug] [Thread-1 (]: Using postgres connection "seed.dbtlearn.seed_full_moon_dates"
[0m12:55:33.801134 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: COMMIT
[0m12:55:33.814129 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m12:55:33.815977 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: Close
[0m12:55:33.817962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6afa39b-3efa-4744-a824-00c25899f3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2252A8F80>]}
[0m12:55:33.818957 [info ] [Thread-1 (]: 3 of 33 OK loaded seed file raw.seed_full_moon_dates ........................... [[32mINSERT 272[0m in 0.33s]
[0m12:55:33.820918 [debug] [Thread-1 (]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m12:55:33.822910 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_hosts
[0m12:55:33.823879 [info ] [Thread-1 (]: 4 of 33 START snapshot DEV.scd_raw_hosts ....................................... [RUN]
[0m12:55:33.826326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtlearn.seed_full_moon_dates, now snapshot.dbtlearn.scd_raw_hosts)
[0m12:55:33.827371 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_hosts
[0m12:55:33.840287 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_hosts
[0m12:55:33.920109 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m12:55:33.920109 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select * FROM "DBT"."raw"."raw_hosts"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m12:55:33.921105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:33.958127 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.037 seconds
[0m12:55:33.965111 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m12:55:33.966108 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m12:55:33.975842 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m12:55:33.977900 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_hosts"
[0m12:55:33.981839 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m12:55:33.982842 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: BEGIN
[0m12:55:33.985873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m12:55:33.986871 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m12:55:33.987875 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      
  
    

  create  table "DBT"."DEV"."scd_raw_hosts"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select * FROM "DBT"."raw"."raw_hosts"

    ) sbq



  );
  
  
[0m12:55:33.990851 [debug] [Thread-1 (]: Postgres adapter: Postgres error: schema "DEV" does not exist

[0m12:55:33.991847 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: ROLLBACK
[0m12:55:33.993809 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: Close
[0m12:55:34.100688 [debug] [Thread-1 (]: Database Error in snapshot scd_raw_hosts (snapshots\scd_raw_hosts.sql)
  schema "DEV" does not exist
  compiled code at target\run\dbtlearn\snapshots\scd_raw_hosts.sql
[0m12:55:34.102683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6afa39b-3efa-4744-a824-00c25899f3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C224578CE0>]}
[0m12:55:34.104678 [error] [Thread-1 (]: 4 of 33 ERROR snapshotting DEV.scd_raw_hosts ................................... [[31mERROR[0m in 0.28s]
[0m12:55:34.106673 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_hosts
[0m12:55:34.108285 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:55:34.109724 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbtlearn.scd_raw_hosts' to be skipped because of status 'error'.  Reason: Database Error in snapshot scd_raw_hosts (snapshots\scd_raw_hosts.sql)
  schema "DEV" does not exist
  compiled code at target\run\dbtlearn\snapshots\scd_raw_hosts.sql.
[0m12:55:34.110899 [info ] [Thread-1 (]: 5 of 33 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m12:55:34.112662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearn.scd_raw_hosts, now test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65)
[0m12:55:34.114656 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:55:34.159531 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:55:34.161554 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:55:34.182870 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:55:34.184468 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:55:34.184468 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: BEGIN
[0m12:55:34.185461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:34.221364 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m12:55:34.221364 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:55:34.222397 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct room_type) = 4
 as expression


    from "DBT"."raw"."raw_listings"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m12:55:34.229343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:55:34.232335 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: ROLLBACK
[0m12:55:34.233745 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: Close
[0m12:55:34.234764 [info ] [Thread-1 (]: 5 of 33 PASS dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[32mPASS[0m in 0.12s]
[0m12:55:34.236300 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:55:34.236786 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:55:34.236786 [info ] [Thread-1 (]: 6 of 33 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m12:55:34.237783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65, now test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9)
[0m12:55:34.238767 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:55:34.253696 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:55:34.255680 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:55:34.258677 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:55:34.260376 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:55:34.260699 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: BEGIN
[0m12:55:34.261669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:34.301140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:55:34.302165 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:55:34.302957 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(price, '^\\$[0-9][0-9\\.]+$', '')), 1), 0)


 > 0
 as expression


    from "DBT"."raw"."raw_listings"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





      
    ) dbt_internal_test
[0m12:55:34.316489 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m12:55:34.318486 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: ROLLBACK
[0m12:55:34.319307 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: Close
[0m12:55:34.320307 [error] [Thread-1 (]: 6 of 33 FAIL 17499 dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[31mFAIL 17499[0m in 0.08s]
[0m12:55:34.321307 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:55:34.321307 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:55:34.323443 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9' to be skipped because of status 'fail'.  Reason: Got 17499 results, configured to fail if != 0.
[0m12:55:34.322703 [info ] [Thread-1 (]: 7 of 33 START sql table model raw.dim_hosts_cleansed ........................... [RUN]
[0m12:55:34.325300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9, now model.dbtlearn.dim_hosts_cleansed)
[0m12:55:34.326297 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:55:34.330310 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:55:34.331305 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:55:34.336298 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:55:34.337261 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:55:34.338046 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: BEGIN
[0m12:55:34.338288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:34.391012 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m12:55:34.391012 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:55:34.392050 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */

  
    

  create  table "DBT"."raw"."dim_hosts_cleansed__dbt_tmp"
  
  
    as
  
  (
    WITH src_hosts AS (
    SELECT * FROM "DBT"."raw"."src_hosts"
)
SELECT 
    host_id,
    COALESCE(host_name, 'Anonymous') AS name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
  
[0m12:55:34.428109 [debug] [Thread-1 (]: SQL status: SELECT 14111 in 0.034 seconds
[0m12:55:34.436873 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:55:34.437881 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
alter table "DBT"."raw"."dim_hosts_cleansed" rename to "dim_hosts_cleansed__dbt_backup"
[0m12:55:34.439370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:55:34.445864 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:55:34.446865 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
alter table "DBT"."raw"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m12:55:34.448808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:55:34.452852 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: COMMIT
[0m12:55:34.453852 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:55:34.454796 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: COMMIT
[0m12:55:34.458145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:55:34.464979 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."dim_hosts_cleansed__dbt_backup"
[0m12:55:34.465986 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:55:34.466988 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop table if exists "DBT"."raw"."dim_hosts_cleansed__dbt_backup" cascade
[0m12:55:34.478120 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m12:55:34.482146 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m12:55:34.484104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6afa39b-3efa-4744-a824-00c25899f3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C224EA1970>]}
[0m12:55:34.485140 [info ] [Thread-1 (]: 7 of 33 OK created sql table model raw.dim_hosts_cleansed ...................... [[32mSELECT 14111[0m in 0.16s]
[0m12:55:34.488094 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:55:34.489091 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m12:55:34.490088 [info ] [Thread-1 (]: 8 of 33 START sql incremental model raw.fct_reviews ............................ [RUN]
[0m12:55:34.492082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.fct_reviews)
[0m12:55:34.494096 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m12:55:34.526991 [info ] [Thread-1 (]: Loading "DBT"."raw"."fct_reviews" incrementally (all missing dates)
[0m12:55:34.528428 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m12:55:34.529272 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m12:55:34.569203 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:55:34.569203 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */

    
  
    

  create temporary table "fct_reviews__dbt_tmp125534563206"
  
  
    as
  
  (
    

WITH src_reviews AS (
  SELECT * FROM "DBT"."raw"."src_reviews"
)
SELECT 
  md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
  *
FROM src_reviews
WHERE review_text is not null

  
    AND review_date > (select max(review_date) from "DBT"."raw"."fct_reviews")
    
  

  );
  
  
[0m12:55:34.570192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:34.951573 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.381 seconds
[0m12:55:34.972350 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:55:34.973121 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: BEGIN
[0m12:55:34.974380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:55:34.975115 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:55:34.975115 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp125534563206'
        
      order by ordinal_position

  
[0m12:55:34.997534 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.021 seconds
[0m12:55:35.007031 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:55:35.007031 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m12:55:35.012018 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m12:55:35.037948 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:55:35.038533 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp125534563206'
        
      order by ordinal_position

  
[0m12:55:35.041938 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m12:55:35.046924 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:55:35.046924 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m12:55:35.051911 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m12:55:35.064880 [debug] [Thread-1 (]: 
    In "DBT"."raw"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:55:35.078838 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m12:55:35.079837 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:55:35.080833 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */

      insert into "DBT"."raw"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp125534563206"
    )


  
[0m12:55:35.081830 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m12:55:35.083826 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: COMMIT
[0m12:55:35.083826 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.fct_reviews"
[0m12:55:35.084823 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: COMMIT
[0m12:55:35.104769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m12:55:35.105766 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m12:55:35.106763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6afa39b-3efa-4744-a824-00c25899f3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C224DE2030>]}
[0m12:55:35.106763 [info ] [Thread-1 (]: 8 of 33 OK created sql incremental model raw.fct_reviews ....................... [[32mINSERT 0 0[0m in 0.61s]
[0m12:55:35.108759 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m12:55:35.109756 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:55:35.109756 [info ] [Thread-1 (]: 9 of 33 SKIP relation raw.src_listings ......................................... [[33mSKIP[0m]
[0m12:55:35.110758 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:55:35.111751 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m12:55:35.112748 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.src_listings' to be skipped because of status 'skipped'. 
[0m12:55:35.112748 [info ] [Thread-1 (]: 10 of 33 SKIP relation DEV.scd_raw_listings .................................... [[33mSKIP[0m]
[0m12:55:35.113745 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m12:55:35.114744 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:55:35.115740 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbtlearn.scd_raw_listings' to be skipped because of status 'skipped'. 
[0m12:55:35.115740 [info ] [Thread-1 (]: 11 of 33 START test accepted_values_dim_hosts_cleansed_is_superhost__t__f ...... [RUN]
[0m12:55:35.116739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4)
[0m12:55:35.117735 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:55:35.128705 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m12:55:35.129702 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:55:35.132694 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m12:55:35.133694 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m12:55:35.134691 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: BEGIN
[0m12:55:35.134691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:35.330733 [debug] [Thread-1 (]: SQL status: BEGIN in 0.195 seconds
[0m12:55:35.331722 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m12:55:35.332719 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_superhost as value_field,
        count(*) as n_records

    from "DBT"."raw"."dim_hosts_cleansed"
    group by is_superhost

)

select *
from all_values
where value_field not in (
    't','f'
)



      
    ) dbt_internal_test
[0m12:55:35.343709 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m12:55:35.347732 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: ROLLBACK
[0m12:55:35.348733 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: Close
[0m12:55:35.350690 [info ] [Thread-1 (]: 11 of 33 PASS accepted_values_dim_hosts_cleansed_is_superhost__t__f ............ [[32mPASS[0m in 0.23s]
[0m12:55:35.353688 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:55:35.354724 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:55:35.355739 [info ] [Thread-1 (]: 12 of 33 START test not_null_dim_hosts_cleansed_host_id ........................ [RUN]
[0m12:55:35.357213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4, now test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05)
[0m12:55:35.359255 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:55:35.379208 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m12:55:35.381158 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:55:35.390131 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m12:55:35.392127 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m12:55:35.393122 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: BEGIN
[0m12:55:35.394133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:35.563272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.169 seconds
[0m12:55:35.563272 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m12:55:35.564269 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from "DBT"."raw"."dim_hosts_cleansed"
where host_id is null



      
    ) dbt_internal_test
[0m12:55:35.567260 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:55:35.569289 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: ROLLBACK
[0m12:55:35.570027 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m12:55:35.570287 [info ] [Thread-1 (]: 12 of 33 PASS not_null_dim_hosts_cleansed_host_id .............................. [[32mPASS[0m in 0.21s]
[0m12:55:35.571250 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:55:35.572248 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:55:35.572882 [info ] [Thread-1 (]: 13 of 33 START test not_null_dim_hosts_cleansed_host_name ...................... [RUN]
[0m12:55:35.573246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05, now test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830)
[0m12:55:35.574244 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:55:35.581225 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m12:55:35.582222 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:55:35.585214 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m12:55:35.586212 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m12:55:35.586212 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: BEGIN
[0m12:55:35.587207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:35.788414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.202 seconds
[0m12:55:35.790460 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m12:55:35.791457 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_name
from "DBT"."raw"."dim_hosts_cleansed"
where host_name is null



      
    ) dbt_internal_test
[0m12:55:35.793402 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "host_name" does not exist
LINE 13: select host_name
                ^

[0m12:55:35.795400 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: ROLLBACK
[0m12:55:35.796446 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: Close
[0m12:55:35.805410 [debug] [Thread-1 (]: Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql
[0m12:55:35.807410 [error] [Thread-1 (]: 13 of 33 ERROR not_null_dim_hosts_cleansed_host_name ........................... [[31mERROR[0m in 0.23s]
[0m12:55:35.810406 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:55:35.811669 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:55:35.813398 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql.
[0m12:55:35.814623 [info ] [Thread-1 (]: 14 of 33 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m12:55:35.816768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830, now test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347)
[0m12:55:35.818340 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:55:35.834319 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m12:55:35.835318 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:55:35.839308 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m12:55:35.840312 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m12:55:35.840312 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: BEGIN
[0m12:55:35.841392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:35.883052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m12:55:35.883052 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m12:55:35.884080 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from "DBT"."raw"."dim_hosts_cleansed"
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:55:35.894039 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m12:55:35.896052 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: ROLLBACK
[0m12:55:35.897544 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m12:55:35.898544 [info ] [Thread-1 (]: 14 of 33 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 0.08s]
[0m12:55:35.899544 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:55:35.900802 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:55:35.900802 [info ] [Thread-1 (]: 15 of 33 START test accepted_values_fct_reviews_review_sentiment__positive__neutral__negative  [RUN]
[0m12:55:35.902533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347, now test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef)
[0m12:55:35.902533 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:55:35.912506 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m12:55:35.913504 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:55:35.917493 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m12:55:35.918491 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m12:55:35.919570 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: BEGIN
[0m12:55:35.920487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:35.961377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m12:55:35.962405 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m12:55:35.962405 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        review_sentiment as value_field,
        count(*) as n_records

    from "DBT"."raw"."fct_reviews"
    group by review_sentiment

)

select *
from all_values
where value_field not in (
    'positive','neutral','negative'
)



      
    ) dbt_internal_test
[0m12:55:36.079951 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.117 seconds
[0m12:55:36.083936 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: ROLLBACK
[0m12:55:36.085884 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: Close
[0m12:55:36.087313 [info ] [Thread-1 (]: 15 of 33 PASS accepted_values_fct_reviews_review_sentiment__positive__neutral__negative  [[32mPASS[0m in 0.18s]
[0m12:55:36.089880 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:55:36.090909 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:55:36.091905 [info ] [Thread-1 (]: 16 of 33 START test not_null_fct_reviews_reviewer_name ......................... [RUN]
[0m12:55:36.093877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef, now test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88)
[0m12:55:36.095878 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:55:36.104874 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m12:55:36.105871 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:55:36.111842 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m12:55:36.113809 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m12:55:36.113809 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: BEGIN
[0m12:55:36.114806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:36.157126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m12:55:36.158127 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m12:55:36.159128 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reviewer_name
from "DBT"."raw"."fct_reviews"
where reviewer_name is null



      
    ) dbt_internal_test
[0m12:55:36.253914 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.094 seconds
[0m12:55:36.256906 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: ROLLBACK
[0m12:55:36.258968 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: Close
[0m12:55:36.259996 [info ] [Thread-1 (]: 16 of 33 PASS not_null_fct_reviews_reviewer_name ............................... [[32mPASS[0m in 0.17s]
[0m12:55:36.262998 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:55:36.263994 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:55:36.265953 [info ] [Thread-1 (]: 17 of 33 SKIP relation raw.dim_listings_cleansed ............................... [[33mSKIP[0m]
[0m12:55:36.267948 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:55:36.268983 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m12:55:36.269982 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.dim_listings_cleansed' to be skipped because of status 'skipped'. 
[0m12:55:36.271013 [info ] [Thread-1 (]: 18 of 33 START sql table model raw.mart_fullmoon_reviews ....................... [RUN]
[0m12:55:36.274978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88, now model.dbtlearn.mart_fullmoon_reviews)
[0m12:55:36.275971 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m12:55:36.284902 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m12:55:36.288898 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m12:55:36.298867 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m12:55:36.300859 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m12:55:36.301886 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: BEGIN
[0m12:55:36.302890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:36.373848 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m12:55:36.375067 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m12:55:36.375889 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */

  
    

  create  table "DBT"."raw"."mart_fullmoon_reviews__dbt_tmp"
  
  
    as
  
  (
    
WITH fct_reviews AS (
    select * from "DBT"."raw"."fct_reviews"
),
full_moon_dates AS (
    select * from "DBT"."raw"."seed_full_moon_dates"
)
select r.*,
case
when fm.full_moon_date IS NULL THEN 'not full moon'
else 'full moon'
END AS is_full_moon
from
fct_reviews r
left join full_moon_dates fm 
--on (TO_DATE(r.review_date) = DATEADD(DAY,1, fm.full_moon_date))
ON (r.review_date::date = fm.full_moon_date + INTERVAL '1 day')
  );
  
[0m12:55:43.720919 [debug] [Thread-1 (]: SQL status: SELECT 409697 in 7.344 seconds
[0m12:55:43.729935 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m12:55:43.730926 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
alter table "DBT"."raw"."mart_fullmoon_reviews" rename to "mart_fullmoon_reviews__dbt_backup"
[0m12:55:43.731912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:55:43.740868 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m12:55:43.741864 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
alter table "DBT"."raw"."mart_fullmoon_reviews__dbt_tmp" rename to "mart_fullmoon_reviews"
[0m12:55:43.743857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:55:43.746849 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: COMMIT
[0m12:55:43.747847 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m12:55:43.749091 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: COMMIT
[0m12:55:43.857587 [debug] [Thread-1 (]: SQL status: COMMIT in 0.107 seconds
[0m12:55:43.869553 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."mart_fullmoon_reviews__dbt_backup"
[0m12:55:43.872545 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.mart_fullmoon_reviews"
[0m12:55:43.874540 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
drop table if exists "DBT"."raw"."mart_fullmoon_reviews__dbt_backup" cascade
[0m12:55:43.922637 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.046 seconds
[0m12:55:43.926579 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m12:55:43.927577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6afa39b-3efa-4744-a824-00c25899f3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22534E690>]}
[0m12:55:43.929689 [info ] [Thread-1 (]: 18 of 33 OK created sql table model raw.mart_fullmoon_reviews .................. [[32mSELECT 409697[0m in 7.65s]
[0m12:55:43.931568 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m12:55:43.933111 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:55:43.934606 [info ] [Thread-1 (]: 19 of 33 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m12:55:43.936559 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:55:43.937556 [debug] [Thread-1 (]: Began running node test.dbtlearn.consistent_created_at
[0m12:55:43.938586 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af' to be skipped because of status 'skipped'. 
[0m12:55:43.939544 [info ] [Thread-1 (]: 20 of 33 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m12:55:43.941540 [debug] [Thread-1 (]: Finished running node test.dbtlearn.consistent_created_at
[0m12:55:43.943702 [debug] [Thread-1 (]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m12:55:43.944532 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.consistent_created_at' to be skipped because of status 'skipped'. 
[0m12:55:43.945562 [info ] [Thread-1 (]: 21 of 33 SKIP test dim_listings_minimum_nights ................................. [[33mSKIP[0m]
[0m12:55:43.947560 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m12:55:43.948555 [debug] [Thread-1 (]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m12:55:43.950516 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dim_listings_minimum_nights' to be skipped because of status 'skipped'. 
[0m12:55:43.953515 [info ] [Thread-1 (]: 22 of 33 SKIP test no_nulls_in_dim_listings .................................... [[33mSKIP[0m]
[0m12:55:43.955507 [debug] [Thread-1 (]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m12:55:43.956501 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:55:43.957496 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.no_nulls_in_dim_listings' to be skipped because of status 'skipped'. 
[0m12:55:43.958498 [info ] [Thread-1 (]: 23 of 33 SKIP test not_null_dim_listings_cleansed_host_id ...................... [[33mSKIP[0m]
[0m12:55:43.959941 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:55:43.960490 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:55:43.961516 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' to be skipped because of status 'skipped'. 
[0m12:55:43.962484 [info ] [Thread-1 (]: 24 of 33 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m12:55:43.963482 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:55:43.964480 [debug] [Thread-1 (]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:55:43.964480 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' to be skipped because of status 'skipped'. 
[0m12:55:43.965474 [info ] [Thread-1 (]: 25 of 33 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m12:55:43.967502 [debug] [Thread-1 (]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:55:43.967502 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:55:43.968496 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313' to be skipped because of status 'skipped'. 
[0m12:55:43.969465 [info ] [Thread-1 (]: 26 of 33 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m12:55:43.971470 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:55:43.973456 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:55:43.974453 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' to be skipped because of status 'skipped'. 
[0m12:55:43.974453 [info ] [Thread-1 (]: 27 of 33 SKIP test relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_  [[33mSKIP[0m]
[0m12:55:43.976447 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:55:43.976447 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:55:43.977474 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe' to be skipped because of status 'skipped'. 
[0m12:55:43.978441 [info ] [Thread-1 (]: 28 of 33 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m12:55:43.979438 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:55:43.979438 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' to be skipped because of status 'skipped'. 
[0m12:55:43.980435 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m12:55:43.982432 [info ] [Thread-1 (]: 29 of 33 SKIP relation raw.dim_listings_w_hosts ................................ [[33mSKIP[0m]
[0m12:55:43.983430 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m12:55:43.984427 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.dim_listings_w_hosts' to be skipped because of status 'skipped'. 
[0m12:55:43.985450 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:55:43.985450 [info ] [Thread-1 (]: 30 of 33 SKIP test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [[33mSKIP[0m]
[0m12:55:43.987418 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:55:43.988414 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:55:43.989433 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75' to be skipped because of status 'skipped'. 
[0m12:55:43.988853 [info ] [Thread-1 (]: 31 of 33 SKIP test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [[33mSKIP[0m]
[0m12:55:43.990421 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:55:43.991409 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:55:43.992412 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970' to be skipped because of status 'skipped'. 
[0m12:55:43.994623 [info ] [Thread-1 (]: 32 of 33 SKIP test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [[33mSKIP[0m]
[0m12:55:43.996392 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:55:43.997437 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:55:43.999388 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a' to be skipped because of status 'skipped'. 
[0m12:55:43.998388 [info ] [Thread-1 (]: 33 of 33 SKIP test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[33mSKIP[0m]
[0m12:55:44.000383 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:55:44.001380 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' to be skipped because of status 'skipped'. 
[0m12:55:44.003375 [info ] [MainThread]: 
[0m12:55:44.004375 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:44.005369 [debug] [MainThread]: On master: BEGIN
[0m12:55:44.005369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:55:44.057684 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m12:55:44.057684 [debug] [MainThread]: On master: COMMIT
[0m12:55:44.058399 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:44.058399 [debug] [MainThread]: On master: COMMIT
[0m12:55:44.059834 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:55:44.071365 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:55:44.072331 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:44.073328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.src_hosts', 'table',
'2025-02-02 11:55:25.707589+00:00',
'2025-02-02 11:55:27.750449',
'2025-02-02 11:55:28.021731'
,'success','0.27327466011047363',
'c6afa39b-3efa-4744-a824-00c25899f3e4','1.9.1',CURRENT_TIMESTAMP(0),'14111');
           
      
  
[0m12:55:44.078316 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.005 seconds
[0m12:55:44.080337 [info ] [MainThread]: 
     
[0m12:55:44.082305 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:44.082305 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.src_reviews', 'table',
'2025-02-02 11:55:25.707589+00:00',
'2025-02-02 11:55:28.029197',
'2025-02-02 11:55:33.473827'
,'success','5.447620630264282',
'c6afa39b-3efa-4744-a824-00c25899f3e4','1.9.1',CURRENT_TIMESTAMP(0),'410284');
           
      
  
[0m12:55:44.084067 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m12:55:44.084944 [info ] [MainThread]: 
     
[0m12:55:44.087343 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:44.087343 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'seed.dbtlearn.seed_full_moon_dates', 'seed',
'2025-02-02 11:55:25.707589+00:00',
'2025-02-02 11:55:33.487772',
'2025-02-02 11:55:33.815977'
,'success','0.33212924003601074',
'c6afa39b-3efa-4744-a824-00c25899f3e4','1.9.1',CURRENT_TIMESTAMP(0),'272');
           
      
  
[0m12:55:44.089311 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m12:55:44.090336 [info ] [MainThread]: 
     
[0m12:55:44.091380 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:44.092330 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('DEV', 'snapshot.dbtlearn.scd_raw_hosts', 'snapshot',
'2025-02-02 11:55:25.707589+00:00',
'2025-02-02 11:55:33.828366',
'2025-02-02 11:55:33.993474'
,'error','0.2762184143066406',
'c6afa39b-3efa-4744-a824-00c25899f3e4','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m12:55:44.093852 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m12:55:44.095727 [info ] [MainThread]: 
     
[0m12:55:44.096716 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:44.097715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw_dbt_test__audit', 'test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65', 'test',
'2025-02-02 11:55:25.707589+00:00',
'2025-02-02 11:55:34.115434',
'2025-02-02 11:55:34.232335'
,'pass','0.12108278274536133',
'c6afa39b-3efa-4744-a824-00c25899f3e4','1.9.1',CURRENT_TIMESTAMP(0),'1');
           
      
  
[0m12:55:44.099901 [debug] [MainThread]: Postgres adapter: Postgres error: value too long for type character varying(50)

[0m12:55:44.102700 [debug] [MainThread]: On master: Close
[0m12:55:44.113770 [info ] [MainThread]: 
[0m12:55:44.114696 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m12:55:44.115669 [info ] [MainThread]: 
[0m12:55:44.116776 [error] [MainThread]:   Database Error in snapshot scd_raw_hosts (snapshots\scd_raw_hosts.sql)
  schema "DEV" does not exist
  compiled code at target\run\dbtlearn\snapshots\scd_raw_hosts.sql
[0m12:55:44.118658 [info ] [MainThread]: 
[0m12:55:44.120653 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models\sources.yml)[0m
[0m12:55:44.121723 [error] [MainThread]:   Got 17499 results, configured to fail if != 0
[0m12:55:44.122648 [info ] [MainThread]: 
[0m12:55:44.123647 [info ] [MainThread]:   compiled code at target\compiled\dbtlearn\models\sources.yml\dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb.sql
[0m12:55:44.124641 [info ] [MainThread]: 
[0m12:55:44.125639 [error] [MainThread]:   Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql
[0m12:55:44.127633 [info ] [MainThread]: 
[0m12:55:44.128643 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=3 SKIP=18 TOTAL=33
[0m12:55:44.129629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:44.129876 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m12:55:44.130649 [debug] [MainThread]: Connection 'list_DBT_DEV' was properly closed.
[0m12:55:44.130649 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m12:55:44.131623 [info ] [MainThread]: 
[0m12:55:44.132358 [info ] [MainThread]: Finished running 1 incremental model, 1 seed, 2 snapshots, 6 table models, 22 data tests, 1 view model in 0 hours 0 minutes and 17.01 seconds (17.01s).
[0m12:55:44.133239 [error] [MainThread]: Encountered an error:
Database Error
  value too long for type character varying(50)
[0m12:55:44.135234 [debug] [MainThread]: Command `dbt build` failed at 12:55:44.135234 after 18.53 seconds
[0m12:55:44.136232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22278AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22454A360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22537BA10>]}
[0m12:55:44.137730 [debug] [MainThread]: Flushing usage events
[0m12:55:45.171763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:56.976818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8D6658E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8B47CBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8DF44170>]}


============================== 12:57:56.992774 | 49a24cd6-d3a5-4d7e-a514-7f6c9bb92399 ==============================
[0m12:57:56.992774 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:57:56.995573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m12:57:57.228562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49a24cd6-d3a5-4d7e-a514-7f6c9bb92399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8E20CFB0>]}
[0m12:57:57.292713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49a24cd6-d3a5-4d7e-a514-7f6c9bb92399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8D6BDB50>]}
[0m12:57:57.294266 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:57:57.530900 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:57:57.863778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:57.864775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:57.957528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49a24cd6-d3a5-4d7e-a514-7f6c9bb92399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8E4A28D0>]}
[0m12:57:58.003564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49a24cd6-d3a5-4d7e-a514-7f6c9bb92399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8F7C1190>]}
[0m12:57:58.003564 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:57:58.004917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49a24cd6-d3a5-4d7e-a514-7f6c9bb92399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8E0ACB90>]}
[0m12:57:58.007576 [info ] [MainThread]: 
[0m12:57:58.008597 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:58.008597 [info ] [MainThread]: 
[0m12:57:58.009481 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:58.014468 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m12:57:58.102871 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:57:58.103868 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:57:58.103868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:58.322143 [debug] [ThreadPool]: SQL status: BEGIN in 0.218 seconds
[0m12:57:58.323184 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:57:58.325178 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:57:58.348530 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.022 seconds
[0m12:57:58.353516 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:57:58.355519 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:57:58.358092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m12:57:58.367479 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:57:58.368476 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:57:58.370471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:58.426883 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m12:57:58.427915 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:57:58.428458 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:57:58.434897 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.007 seconds
[0m12:57:58.437856 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:57:58.438600 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:57:58.449573 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.449573 [debug] [MainThread]: On master: BEGIN
[0m12:57:58.449573 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:58.489466 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m12:57:58.489466 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.490466 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:57:58.499440 [debug] [MainThread]: SQL status: SELECT 3 in 0.009 seconds
[0m12:57:58.501470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49a24cd6-d3a5-4d7e-a514-7f6c9bb92399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8F76F890>]}
[0m12:57:58.501470 [debug] [MainThread]: On master: ROLLBACK
[0m12:57:58.502436 [debug] [MainThread]: On master: Close
[0m12:57:58.506647 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:57:58.507450 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_hosts'
[0m12:57:58.507450 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:57:58.515433 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:57:58.516436 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m12:57:58.517774 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:57:58.518428 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:57:58.518428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m12:57:58.519422 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:57:58.525402 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:57:58.526367 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m12:57:58.527367 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:57:58.527997 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:57:58.528363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:57:58.528363 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:57:58.532353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:57:58.533351 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m12:57:58.534348 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:57:58.534348 [debug] [Thread-1 (]: Began running node operation.dbtlearn.dbtlearn-on-run-end-0
[0m12:57:58.535526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now operation.dbtlearn.dbtlearn-on-run-end-0)
[0m12:57:58.535526 [debug] [Thread-1 (]: Began compiling node operation.dbtlearn.dbtlearn-on-run-end-0
[0m12:57:58.546316 [info ] [Thread-1 (]: ========== Begin Summary ==========
[0m12:57:58.547120 [info ] [Thread-1 (]: ========== End Summary ==========
[0m12:57:58.547911 [debug] [Thread-1 (]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m12:57:58.548942 [debug] [Thread-1 (]: Began executing node operation.dbtlearn.dbtlearn-on-run-end-0
[0m12:57:58.549906 [debug] [Thread-1 (]: Finished running node operation.dbtlearn.dbtlearn-on-run-end-0
[0m12:57:58.551106 [debug] [Thread-1 (]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m12:57:58.551106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly operation.dbtlearn.dbtlearn-on-run-end-0, now seed.dbtlearn.seed_full_moon_dates)
[0m12:57:58.551932 [debug] [Thread-1 (]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m12:57:58.554925 [debug] [Thread-1 (]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m12:57:58.556942 [debug] [Thread-1 (]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m12:57:58.556942 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_hosts
[0m12:57:58.559915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtlearn.seed_full_moon_dates, now snapshot.dbtlearn.scd_raw_hosts)
[0m12:57:58.559915 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_hosts
[0m12:57:58.564901 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_hosts
[0m12:57:58.565897 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_hosts
[0m12:57:58.566317 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m12:57:58.566862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearn.scd_raw_hosts, now snapshot.dbtlearn.scd_raw_listings)
[0m12:57:58.566862 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m12:57:58.571890 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m12:57:58.572891 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m12:57:58.573891 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:57:58.574401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearn.scd_raw_listings, now test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65)
[0m12:57:58.574952 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:57:58.594865 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:57:58.598825 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:57:58.599853 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:57:58.600836 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:57:58.600836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65, now test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9)
[0m12:57:58.601815 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:57:58.612821 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:57:58.614783 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:57:58.615815 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:57:58.615845 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:57:58.617816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9, now model.dbtlearn.dim_hosts_cleansed)
[0m12:57:58.618771 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:57:58.622794 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:57:58.623759 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:57:58.624787 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:57:58.625284 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:57:58.625752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m12:57:58.625752 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:57:58.628775 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:57:58.630741 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:57:58.631767 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:57:58.632198 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m12:57:58.632733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m12:57:58.632733 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m12:57:58.662653 [info ] [Thread-1 (]: Loading "DBT"."raw"."fct_reviews" incrementally (all missing dates)
[0m12:57:58.663651 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m12:57:58.664847 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m12:57:58.665674 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m12:57:58.665674 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:57:58.666952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4)
[0m12:57:58.667640 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:57:58.678713 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m12:57:58.680652 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:57:58.681637 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m12:57:58.682631 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:57:58.682631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4, now test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05)
[0m12:57:58.683945 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:57:58.695597 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m12:57:58.697561 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:57:58.698937 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m12:57:58.699590 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:57:58.699590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05, now test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830)
[0m12:57:58.700787 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:57:58.707537 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m12:57:58.708530 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:57:58.709527 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m12:57:58.709527 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:57:58.710569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830, now test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347)
[0m12:57:58.710569 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:57:58.717538 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m12:57:58.718612 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:57:58.720038 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m12:57:58.720498 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m12:57:58.721504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347, now model.dbtlearn.dim_listings_w_hosts)
[0m12:57:58.722493 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m12:57:58.726517 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m12:57:58.727512 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m12:57:58.728497 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m12:57:58.728497 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:57:58.729680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_w_hosts, now test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m12:57:58.729680 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:57:58.736487 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m12:57:58.738450 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:57:58.739447 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:57:58.739578 [debug] [Thread-1 (]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m12:57:58.739578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtlearn.dim_listings_minimum_nights)
[0m12:57:58.740445 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m12:57:58.746428 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m12:57:58.747729 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m12:57:58.748456 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m12:57:58.748456 [debug] [Thread-1 (]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m12:57:58.749592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dim_listings_minimum_nights, now test.dbtlearn.no_nulls_in_dim_listings)
[0m12:57:58.749592 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m12:57:58.767408 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m12:57:58.767408 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: BEGIN
[0m12:57:58.767408 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:57:58.800596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m12:57:58.801425 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m12:57:58.801425 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'dim_listings_cleansed'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m12:57:58.817628 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.016 seconds
[0m12:57:58.822616 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m12:57:58.823577 [debug] [Thread-1 (]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m12:57:58.823577 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: ROLLBACK
[0m12:57:58.825081 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m12:57:58.825606 [debug] [Thread-1 (]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m12:57:58.826571 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:57:58.826571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.no_nulls_in_dim_listings, now test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m12:57:58.826571 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:57:58.831592 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:57:58.833596 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:57:58.834662 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:57:58.834662 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:57:58.835546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m12:57:58.836543 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:57:58.841530 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:57:58.842527 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:57:58.843631 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:57:58.843631 [debug] [Thread-1 (]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:57:58.844559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313)
[0m12:57:58.844559 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:57:58.850532 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m12:57:58.851912 [debug] [Thread-1 (]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:57:58.852501 [debug] [Thread-1 (]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m12:57:58.853497 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:57:58.853497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313, now test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m12:57:58.853497 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:57:58.862507 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:57:58.863470 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:57:58.864470 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:57:58.864470 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:57:58.865503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m12:57:58.865503 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:57:58.869503 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:57:58.870487 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:57:58.871971 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:57:58.871971 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m12:57:58.872484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e, now model.dbtlearn.mart_fullmoon_reviews)
[0m12:57:58.872484 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m12:57:58.877471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m12:57:58.878741 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m12:57:58.879540 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m12:57:58.880463 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:57:58.880970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.mart_fullmoon_reviews, now test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef)
[0m12:57:58.881465 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:57:58.887438 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m12:57:58.888404 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:57:58.889405 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m12:57:58.889405 [debug] [Thread-1 (]: Began running node test.dbtlearn.consistent_created_at
[0m12:57:58.890398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef, now test.dbtlearn.consistent_created_at)
[0m12:57:58.890747 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.consistent_created_at
[0m12:57:58.893423 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m12:57:58.894388 [debug] [Thread-1 (]: Began executing node test.dbtlearn.consistent_created_at
[0m12:57:58.895416 [debug] [Thread-1 (]: Finished running node test.dbtlearn.consistent_created_at
[0m12:57:58.895416 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:57:58.895416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.consistent_created_at, now test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88)
[0m12:57:58.896555 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:57:58.900408 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m12:57:58.901414 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:57:58.902402 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m12:57:58.902910 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:57:58.903364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88, now test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe)
[0m12:57:58.903364 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:57:58.909385 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m12:57:58.910348 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:57:58.910794 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m12:57:58.911343 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:57:58.911343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe, now test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75)
[0m12:57:58.912386 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:57:58.922356 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m12:57:58.923351 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:57:58.924308 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m12:57:58.924308 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:57:58.925454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75, now test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970)
[0m12:57:58.925454 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:57:58.934317 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m12:57:58.936289 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:57:58.937274 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m12:57:58.937274 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:57:58.938270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970, now test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a)
[0m12:57:58.938270 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:57:58.951270 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m12:57:58.952274 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: BEGIN
[0m12:57:58.952274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:58.994145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m12:57:58.995182 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m12:57:58.995182 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'dim_listings_w_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m12:57:59.021035 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.025 seconds
[0m12:57:59.023064 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m12:57:59.025064 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:57:59.026021 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: ROLLBACK
[0m12:57:59.027017 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: Close
[0m12:57:59.028269 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m12:57:59.029012 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:57:59.030135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a, now test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da)
[0m12:57:59.031008 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:57:59.056690 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m12:57:59.056970 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:57:59.057935 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m12:57:59.058932 [debug] [Thread-1 (]: Began running node analysis.dbtlearn.full_moon_no_sleep
[0m12:57:59.059501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da, now analysis.dbtlearn.full_moon_no_sleep)
[0m12:57:59.059945 [debug] [Thread-1 (]: Began compiling node analysis.dbtlearn.full_moon_no_sleep
[0m12:57:59.062957 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbtlearn.full_moon_no_sleep"
[0m12:57:59.064139 [debug] [Thread-1 (]: Began executing node analysis.dbtlearn.full_moon_no_sleep
[0m12:57:59.064915 [debug] [Thread-1 (]: Finished running node analysis.dbtlearn.full_moon_no_sleep
[0m12:57:59.066160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:59.066910 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m12:57:59.066910 [debug] [MainThread]: Connection 'analysis.dbtlearn.full_moon_no_sleep' was properly closed.
[0m12:57:59.075435 [debug] [MainThread]: Command end result
[0m12:57:59.323309 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:57:59.328046 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:57:59.336043 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m12:58:00.246039 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:58:00.247075 [info ] [MainThread]: Building catalog
[0m12:58:00.257477 [debug] [ThreadPool]: Acquiring new postgres connection 'DBT.information_schema'
[0m12:58:00.277221 [debug] [ThreadPool]: Using postgres connection "DBT.information_schema"
[0m12:58:00.278218 [debug] [ThreadPool]: On DBT.information_schema: BEGIN
[0m12:58:00.279215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:00.324233 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m12:58:00.325229 [debug] [ThreadPool]: Using postgres connection "DBT.information_schema"
[0m12:58:00.325229 [debug] [ThreadPool]: On DBT.information_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "DBT.information_schema"} */

    
    

    select
        'DBT' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('seed_full_moon_dates')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('raw_hosts')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('raw_listings')) or (upper(sch.nspname) = upper('DEV') and
           upper(tbl.relname) = upper('scd_raw_hosts')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('src_reviews')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('src_hosts')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('raw_reviews')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('dim_listings_cleansed')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('fct_reviews')) or (upper(sch.nspname) = upper('DEV') and
           upper(tbl.relname) = upper('scd_raw_listings')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('dim_listings_w_hosts')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('mart_fullmoon_reviews')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('src_listings')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('dim_hosts_cleansed')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:58:00.335908 [debug] [ThreadPool]: SQL status: SELECT 65 in 0.010 seconds
[0m12:58:00.343888 [debug] [ThreadPool]: On DBT.information_schema: ROLLBACK
[0m12:58:00.344886 [debug] [ThreadPool]: On DBT.information_schema: Close
[0m12:58:00.361840 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\catalog.json
[0m12:58:00.402768 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:58:00.405302 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:58:00.405724 [info ] [MainThread]: Catalog written to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\catalog.json
[0m12:58:00.406724 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:58:00.406724 after 3.82 seconds
[0m12:58:00.406724 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:58:00.407726 [debug] [MainThread]: Connection 'DBT.information_schema' was properly closed.
[0m12:58:00.407726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8BDFE3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8D5A9A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8DF44170>]}
[0m12:58:00.407726 [debug] [MainThread]: Flushing usage events
[0m12:58:01.261723 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:30.492582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCAB88770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCD7405C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCDFA1F40>]}


============================== 12:58:30.502827 | 65be419d-5a12-440a-b2a7-b0e02f9c0f0f ==============================
[0m12:58:30.502827 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:58:30.504918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m12:58:30.733973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65be419d-5a12-440a-b2a7-b0e02f9c0f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCE2FCFE0>]}
[0m12:58:30.802074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65be419d-5a12-440a-b2a7-b0e02f9c0f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCD7BC4A0>]}
[0m12:58:30.803205 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:58:31.034381 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:58:31.360962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:58:31.360962 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:58:31.456372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65be419d-5a12-440a-b2a7-b0e02f9c0f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCE748EC0>]}
[0m12:58:31.627905 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:58:31.631889 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:58:31.669486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65be419d-5a12-440a-b2a7-b0e02f9c0f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCF7EF560>]}
[0m12:58:31.669486 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 sources, 1 exposure, 814 macros
[0m12:58:31.670785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65be419d-5a12-440a-b2a7-b0e02f9c0f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCE540F80>]}
[0m12:58:31.673520 [info ] [MainThread]: 
[0m12:58:31.674144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:58:31.674473 [info ] [MainThread]: 
[0m12:58:31.675606 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:58:31.680462 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m12:58:31.774387 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:58:31.775421 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:58:31.775421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:31.813745 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.038 seconds
[0m12:58:31.815011 [debug] [ThreadPool]: On list_DBT: Close
[0m12:58:31.817966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_DEV'
[0m12:58:31.825851 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:58:31.825944 [debug] [ThreadPool]: On list_DBT_DEV: BEGIN
[0m12:58:31.825944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:31.862817 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m12:58:31.863818 [debug] [ThreadPool]: Using postgres connection "list_DBT_DEV"
[0m12:58:31.863818 [debug] [ThreadPool]: On list_DBT_DEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_DEV"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'DEV'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'DEV'
  
[0m12:58:31.871561 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m12:58:31.873525 [debug] [ThreadPool]: On list_DBT_DEV: ROLLBACK
[0m12:58:31.874231 [debug] [ThreadPool]: On list_DBT_DEV: Close
[0m12:58:31.875231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_raw)
[0m12:58:31.877259 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:58:31.878256 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:58:31.878256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:31.915257 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m12:58:31.916186 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:58:31.916186 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:58:31.925159 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.008 seconds
[0m12:58:31.933144 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:58:31.933945 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:58:31.950092 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:31.950092 [debug] [MainThread]: On master: BEGIN
[0m12:58:31.951090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:31.992645 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m12:58:31.992645 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:31.993646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:58:32.004612 [debug] [MainThread]: SQL status: SELECT 3 in 0.010 seconds
[0m12:58:32.006572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65be419d-5a12-440a-b2a7-b0e02f9c0f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCFB99730>]}
[0m12:58:32.007570 [debug] [MainThread]: On master: ROLLBACK
[0m12:58:32.008144 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:32.008144 [debug] [MainThread]: On master: BEGIN
[0m12:58:32.009657 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:58:32.010175 [debug] [MainThread]: On master: COMMIT
[0m12:58:32.010175 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:32.011174 [debug] [MainThread]: On master: COMMIT
[0m12:58:32.012200 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:58:32.012200 [debug] [MainThread]: On master: Close
[0m12:58:32.015145 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_hosts
[0m12:58:32.016126 [info ] [Thread-1 (]: 1 of 2 START snapshot DEV.scd_raw_hosts ........................................ [RUN]
[0m12:58:32.017106 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbtlearn.scd_raw_hosts'
[0m12:58:32.018018 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_hosts
[0m12:58:32.031990 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_hosts
[0m12:58:32.115753 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m12:58:32.116751 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select * FROM "DBT"."raw"."raw_hosts"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m12:58:32.116751 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:58:32.154368 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.037 seconds
[0m12:58:32.162349 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m12:58:32.162349 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m12:58:32.164055 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m12:58:32.164055 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_hosts"
[0m12:58:32.166053 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m12:58:32.166580 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: BEGIN
[0m12:58:32.167049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:58:32.168047 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m12:58:32.168047 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      
  
    

  create  table "DBT"."DEV"."scd_raw_hosts"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select * FROM "DBT"."raw"."raw_hosts"

    ) sbq



  );
  
  
[0m12:58:32.169621 [debug] [Thread-1 (]: Postgres adapter: Postgres error: schema "DEV" does not exist

[0m12:58:32.170299 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: ROLLBACK
[0m12:58:32.170814 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: Close
[0m12:58:32.177247 [debug] [Thread-1 (]: Database Error in snapshot scd_raw_hosts (snapshots\scd_raw_hosts.sql)
  schema "DEV" does not exist
  compiled code at target\run\dbtlearn\snapshots\scd_raw_hosts.sql
[0m12:58:32.179913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65be419d-5a12-440a-b2a7-b0e02f9c0f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD00080B0>]}
[0m12:58:32.180704 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting DEV.scd_raw_hosts .................................... [[31mERROR[0m in 0.16s]
[0m12:58:32.181896 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_hosts
[0m12:58:32.182699 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m12:58:32.184248 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbtlearn.scd_raw_hosts' to be skipped because of status 'error'.  Reason: Database Error in snapshot scd_raw_hosts (snapshots\scd_raw_hosts.sql)
  schema "DEV" does not exist
  compiled code at target\run\dbtlearn\snapshots\scd_raw_hosts.sql.
[0m12:58:32.183695 [info ] [Thread-1 (]: 2 of 2 START snapshot DEV.scd_raw_listings ..................................... [RUN]
[0m12:58:32.185694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearn.scd_raw_hosts, now snapshot.dbtlearn.scd_raw_listings)
[0m12:58:32.185694 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m12:58:32.190686 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m12:58:32.195670 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m12:58:32.195670 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select * FROM "DBT"."raw"."raw_listings"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m12:58:32.196660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:32.238690 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.042 seconds
[0m12:58:32.239690 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m12:58:32.240691 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m12:58:32.241732 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m12:58:32.243138 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_listings"
[0m12:58:32.245644 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m12:58:32.245858 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: BEGIN
[0m12:58:32.247122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:58:32.247666 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m12:58:32.247666 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      
  
    

  create  table "DBT"."DEV"."scd_raw_listings"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select * FROM "DBT"."raw"."raw_listings"

    ) sbq



  );
  
  
[0m12:58:32.249426 [debug] [Thread-1 (]: Postgres adapter: Postgres error: schema "DEV" does not exist

[0m12:58:32.250098 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: ROLLBACK
[0m12:58:32.250725 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m12:58:32.255085 [debug] [Thread-1 (]: Database Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  schema "DEV" does not exist
  compiled code at target\run\dbtlearn\snapshots\scd_raw_listings.sql
[0m12:58:32.255085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65be419d-5a12-440a-b2a7-b0e02f9c0f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD00BCFE0>]}
[0m12:58:32.256083 [error] [Thread-1 (]: 2 of 2 ERROR snapshotting DEV.scd_raw_listings ................................. [[31mERROR[0m in 0.07s]
[0m12:58:32.257612 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m12:58:32.258491 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbtlearn.scd_raw_listings' to be skipped because of status 'error'.  Reason: Database Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  schema "DEV" does not exist
  compiled code at target\run\dbtlearn\snapshots\scd_raw_listings.sql.
[0m12:58:32.260449 [info ] [MainThread]: 
[0m12:58:32.261446 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:32.261446 [debug] [MainThread]: On master: BEGIN
[0m12:58:32.262445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:58:32.314207 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m12:58:32.315204 [debug] [MainThread]: On master: COMMIT
[0m12:58:32.315204 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:32.316201 [debug] [MainThread]: On master: COMMIT
[0m12:58:32.317349 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:58:32.332311 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:58:32.336152 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:32.336152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('DEV', 'snapshot.dbtlearn.scd_raw_hosts', 'snapshot',
'2025-02-02 11:58:30.412613+00:00',
'2025-02-02 11:58:32.018018',
'2025-02-02 11:58:32.170814'
,'error','0.1601409912109375',
'65be419d-5a12-440a-b2a7-b0e02f9c0f0f','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m12:58:32.349331 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.012 seconds
[0m12:58:32.352888 [info ] [MainThread]: 
     
[0m12:58:32.354916 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:32.356232 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('DEV', 'snapshot.dbtlearn.scd_raw_listings', 'snapshot',
'2025-02-02 11:58:30.412613+00:00',
'2025-02-02 11:58:32.186661',
'2025-02-02 11:58:32.250725'
,'error','0.06939101219177246',
'65be419d-5a12-440a-b2a7-b0e02f9c0f0f','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m12:58:32.358875 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m12:58:32.362861 [info ] [MainThread]: 
     
[0m12:58:32.364857 [info ] [MainThread]: ========== End Summary ==========
[0m12:58:32.366853 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m12:58:32.382852 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m12:58:32.384804 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.07s]
[0m12:58:32.385936 [debug] [MainThread]: On master: Close
[0m12:58:32.387796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:32.388793 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m12:58:32.389793 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m12:58:32.389962 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m12:58:32.390820 [info ] [MainThread]: 
[0m12:58:32.392786 [info ] [MainThread]: Finished running 1 project hook, 2 snapshots in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m12:58:32.396970 [debug] [MainThread]: Command end result
[0m12:58:32.450615 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:58:32.454646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:58:32.460617 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m12:58:32.461587 [info ] [MainThread]: 
[0m12:58:32.462580 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:58:32.462580 [info ] [MainThread]: 
[0m12:58:32.463609 [error] [MainThread]:   Database Error in snapshot scd_raw_hosts (snapshots\scd_raw_hosts.sql)
  schema "DEV" does not exist
  compiled code at target\run\dbtlearn\snapshots\scd_raw_hosts.sql
[0m12:58:32.464579 [info ] [MainThread]: 
[0m12:58:32.465572 [error] [MainThread]:   Database Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  schema "DEV" does not exist
  compiled code at target\run\dbtlearn\snapshots\scd_raw_listings.sql
[0m12:58:32.466569 [info ] [MainThread]: 
[0m12:58:32.466569 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m12:58:32.468596 [debug] [MainThread]: Command `dbt snapshot` failed at 12:58:32.467600 after 2.15 seconds
[0m12:58:32.468596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCE27E420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCD790B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCD790140>]}
[0m12:58:32.468596 [debug] [MainThread]: Flushing usage events
[0m12:58:33.118118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:40.919661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8EEFC7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8EE42F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8EEFC4050>]}


============================== 12:59:40.930556 | 47fa4b5a-dc6a-4267-9d46-5cde05835a55 ==============================
[0m12:59:40.930556 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:59:40.932630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:59:41.184415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47fa4b5a-dc6a-4267-9d46-5cde05835a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8EF151A00>]}
[0m12:59:41.251429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47fa4b5a-dc6a-4267-9d46-5cde05835a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8EB83C950>]}
[0m12:59:41.253006 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:59:41.474159 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:59:41.855016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:59:41.856013 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://snapshots\scd_raw_hosts.sql
[0m12:59:41.856013 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://snapshots\scd_raw_listings.sql
[0m12:59:42.208138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47fa4b5a-dc6a-4267-9d46-5cde05835a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F0833680>]}
[0m12:59:42.376138 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:59:42.380217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:59:42.411881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47fa4b5a-dc6a-4267-9d46-5cde05835a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F095FAD0>]}
[0m12:59:42.411881 [info ] [MainThread]: Found 8 models, 1 analysis, 22 data tests, 1 seed, 1 operation, 2 snapshots, 3 sources, 1 exposure, 814 macros
[0m12:59:42.412914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47fa4b5a-dc6a-4267-9d46-5cde05835a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8EF229D00>]}
[0m12:59:42.415870 [info ] [MainThread]: 
[0m12:59:42.416947 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:42.416947 [info ] [MainThread]: 
[0m12:59:42.417866 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:59:42.422854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m12:59:42.508818 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m12:59:42.509815 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m12:59:42.509815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:42.549649 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.040 seconds
[0m12:59:42.551643 [debug] [ThreadPool]: On list_DBT: Close
[0m12:59:42.553638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m12:59:42.561645 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:59:42.562642 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m12:59:42.562642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:42.608958 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m12:59:42.609990 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m12:59:42.609990 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:59:42.625872 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.015 seconds
[0m12:59:42.629913 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m12:59:42.631595 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m12:59:42.653883 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:42.654919 [debug] [MainThread]: On master: BEGIN
[0m12:59:42.654919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:42.727343 [debug] [MainThread]: SQL status: BEGIN in 0.072 seconds
[0m12:59:42.728338 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:42.729346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:59:42.748328 [debug] [MainThread]: SQL status: SELECT 3 in 0.018 seconds
[0m12:59:42.751324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47fa4b5a-dc6a-4267-9d46-5cde05835a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8EF292D80>]}
[0m12:59:42.752322 [debug] [MainThread]: On master: ROLLBACK
[0m12:59:42.753942 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:42.754993 [debug] [MainThread]: On master: BEGIN
[0m12:59:42.756148 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:59:42.756984 [debug] [MainThread]: On master: COMMIT
[0m12:59:42.757982 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:42.758982 [debug] [MainThread]: On master: COMMIT
[0m12:59:42.760186 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:59:42.761187 [debug] [MainThread]: On master: Close
[0m12:59:42.765178 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_hosts
[0m12:59:42.766224 [info ] [Thread-1 (]: 1 of 2 START snapshot raw.scd_raw_hosts ........................................ [RUN]
[0m12:59:42.769213 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbtlearn.scd_raw_hosts'
[0m12:59:42.770226 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_hosts
[0m12:59:42.797094 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_hosts
[0m12:59:42.878536 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m12:59:42.878683 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select * FROM "DBT"."raw"."raw_hosts"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m12:59:42.879517 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:59:42.920033 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m12:59:42.926476 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m12:59:42.926476 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m12:59:42.927469 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m12:59:42.928556 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_hosts"
[0m12:59:42.929427 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m12:59:42.930727 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: BEGIN
[0m12:59:42.931422 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:59:42.932453 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m12:59:42.932453 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      
  
    

  create  table "DBT"."raw"."scd_raw_hosts"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select * FROM "DBT"."raw"."raw_hosts"

    ) sbq



  );
  
  
[0m12:59:43.005893 [debug] [Thread-1 (]: SQL status: SELECT 14111 in 0.072 seconds
[0m12:59:43.026837 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: COMMIT
[0m12:59:43.026837 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m12:59:43.027834 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: COMMIT
[0m12:59:43.049974 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m12:59:43.054827 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: Close
[0m12:59:43.059812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47fa4b5a-dc6a-4267-9d46-5cde05835a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F0EFF350>]}
[0m12:59:43.061856 [info ] [Thread-1 (]: 1 of 2 OK snapshotted raw.scd_raw_hosts ........................................ [[32mSELECT 14111[0m in 0.29s]
[0m12:59:43.064851 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_hosts
[0m12:59:43.065843 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m12:59:43.066840 [info ] [Thread-1 (]: 2 of 2 START snapshot raw.scd_raw_listings ..................................... [RUN]
[0m12:59:43.068828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearn.scd_raw_hosts, now snapshot.dbtlearn.scd_raw_listings)
[0m12:59:43.069786 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m12:59:43.080799 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m12:59:43.085771 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m12:59:43.085771 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select * FROM "DBT"."raw"."raw_listings"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m12:59:43.086960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:43.130866 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.044 seconds
[0m12:59:43.131691 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m12:59:43.131691 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m12:59:43.133143 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m12:59:43.133683 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_listings"
[0m12:59:43.134811 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m12:59:43.134811 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: BEGIN
[0m12:59:43.135679 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:59:43.136676 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m12:59:43.137144 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      
  
    

  create  table "DBT"."raw"."scd_raw_listings"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select * FROM "DBT"."raw"."raw_listings"

    ) sbq



  );
  
  
[0m12:59:43.206543 [debug] [Thread-1 (]: SQL status: SELECT 17499 in 0.069 seconds
[0m12:59:43.207541 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: COMMIT
[0m12:59:43.208540 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m12:59:43.208540 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: COMMIT
[0m12:59:43.219954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m12:59:43.220470 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m12:59:43.221742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47fa4b5a-dc6a-4267-9d46-5cde05835a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F0E78CE0>]}
[0m12:59:43.222477 [info ] [Thread-1 (]: 2 of 2 OK snapshotted raw.scd_raw_listings ..................................... [[32mSELECT 17499[0m in 0.15s]
[0m12:59:43.223463 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m12:59:43.224478 [info ] [MainThread]: 
[0m12:59:43.225457 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:43.225457 [debug] [MainThread]: On master: BEGIN
[0m12:59:43.225457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:43.262535 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:59:43.263356 [debug] [MainThread]: On master: COMMIT
[0m12:59:43.264353 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:43.265351 [debug] [MainThread]: On master: COMMIT
[0m12:59:43.266175 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:59:43.278348 [info ] [MainThread]: ========== Begin Summary ==========
[0m12:59:43.281307 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:43.281307 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'snapshot.dbtlearn.scd_raw_hosts', 'snapshot',
'2025-02-02 11:59:40.790724+00:00',
'2025-02-02 11:59:42.770226',
'2025-02-02 11:59:43.054827'
,'success','0.287686824798584',
'47fa4b5a-dc6a-4267-9d46-5cde05835a55','1.9.1',CURRENT_TIMESTAMP(0),'14111');
           
      
  
[0m12:59:43.285299 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.003 seconds
[0m12:59:43.286450 [info ] [MainThread]: 
     
[0m12:59:43.288291 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:43.289319 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'snapshot.dbtlearn.scd_raw_listings', 'snapshot',
'2025-02-02 11:59:40.790724+00:00',
'2025-02-02 11:59:43.070821',
'2025-02-02 11:59:43.220470'
,'success','0.15263891220092773',
'47fa4b5a-dc6a-4267-9d46-5cde05835a55','1.9.1',CURRENT_TIMESTAMP(0),'17499');
           
      
  
[0m12:59:43.291283 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m12:59:43.294308 [info ] [MainThread]: 
     
[0m12:59:43.296268 [info ] [MainThread]: ========== End Summary ==========
[0m12:59:43.297266 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m12:59:43.307790 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m12:59:43.309779 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.04s]
[0m12:59:43.311773 [debug] [MainThread]: On master: Close
[0m12:59:43.312775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:43.313777 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m12:59:43.314923 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m12:59:43.315789 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m12:59:43.315789 [info ] [MainThread]: 
[0m12:59:43.316758 [info ] [MainThread]: Finished running 1 project hook, 2 snapshots in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m12:59:43.318780 [debug] [MainThread]: Command end result
[0m12:59:43.442468 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m12:59:43.446223 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m12:59:43.453392 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m12:59:43.453924 [info ] [MainThread]: 
[0m12:59:43.454423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:59:43.455388 [info ] [MainThread]: 
[0m12:59:43.456540 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:59:43.457382 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:59:43.457382 after 2.77 seconds
[0m12:59:43.458415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8EC412870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8EF0E18B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E8EBAF90>]}
[0m12:59:43.458415 [debug] [MainThread]: Flushing usage events
[0m12:59:44.034184 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:53.910857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CB50A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CB50ACC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CB50A4E0>]}


============================== 13:27:53.915888 | b4a31f95-7f12-4134-999b-e7ae60a43f7c ==============================
[0m13:27:53.915888 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:27:53.916469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:27:54.127923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4a31f95-7f12-4134-999b-e7ae60a43f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CB52B770>]}
[0m13:27:54.189801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4a31f95-7f12-4134-999b-e7ae60a43f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CAE7D580>]}
[0m13:27:54.190868 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:27:54.419429 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:27:54.791248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:54.791248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:54.886039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4a31f95-7f12-4134-999b-e7ae60a43f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CB6E48F0>]}
[0m13:27:55.055852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m13:27:55.059632 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m13:27:55.096015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4a31f95-7f12-4134-999b-e7ae60a43f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CCD372F0>]}
[0m13:27:55.096624 [info ] [MainThread]: Found 8 models, 1 analysis, 22 data tests, 1 seed, 1 operation, 2 snapshots, 3 sources, 1 exposure, 814 macros
[0m13:27:55.097877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4a31f95-7f12-4134-999b-e7ae60a43f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CCB80710>]}
[0m13:27:55.100622 [info ] [MainThread]: 
[0m13:27:55.101144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:27:55.102039 [info ] [MainThread]: 
[0m13:27:55.102039 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:27:55.107027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m13:27:55.186586 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m13:27:55.186586 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m13:27:55.187205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:55.224549 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.037 seconds
[0m13:27:55.226544 [debug] [ThreadPool]: On list_DBT: Close
[0m13:27:55.228538 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m13:27:55.236545 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m13:27:55.236545 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m13:27:55.237542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:55.278850 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m13:27:55.278850 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m13:27:55.279875 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m13:27:55.292081 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.011 seconds
[0m13:27:55.296113 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m13:27:55.297147 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m13:27:55.318114 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:55.319114 [debug] [MainThread]: On master: BEGIN
[0m13:27:55.320109 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:55.392107 [debug] [MainThread]: SQL status: BEGIN in 0.071 seconds
[0m13:27:55.392107 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:55.394144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:27:55.414254 [debug] [MainThread]: SQL status: SELECT 3 in 0.019 seconds
[0m13:27:55.417245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4a31f95-7f12-4134-999b-e7ae60a43f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CD1769C0>]}
[0m13:27:55.418243 [debug] [MainThread]: On master: ROLLBACK
[0m13:27:55.419272 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:55.420321 [debug] [MainThread]: On master: BEGIN
[0m13:27:55.421361 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:27:55.422312 [debug] [MainThread]: On master: COMMIT
[0m13:27:55.423310 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:55.424306 [debug] [MainThread]: On master: COMMIT
[0m13:27:55.425259 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:27:55.425259 [debug] [MainThread]: On master: Close
[0m13:27:55.429250 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_hosts
[0m13:27:55.431425 [info ] [Thread-1 (]: 1 of 2 START snapshot raw.scd_raw_hosts ........................................ [RUN]
[0m13:27:55.436277 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbtlearn.scd_raw_hosts'
[0m13:27:55.437419 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_hosts
[0m13:27:55.459210 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_hosts
[0m13:27:55.516041 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:27:55.517040 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: BEGIN
[0m13:27:55.517040 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:27:55.576079 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m13:27:55.576897 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:27:55.577897 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:27:55.617531 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.038 seconds
[0m13:27:55.690314 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:27:55.690314 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

        
  
    

  create temporary table "scd_raw_hosts__dbt_tmp132755682335"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select * FROM "DBT"."raw"."raw_hosts"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DBT"."raw"."scd_raw_hosts"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m13:27:55.724353 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m13:27:55.727347 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:27:55.727347 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts__dbt_tmp132755682335'
        
      order by ordinal_position

  
[0m13:27:55.730595 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m13:27:55.734616 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:27:55.734616 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:27:55.738737 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m13:27:55.742728 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:27:55.743725 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts__dbt_tmp132755682335'
        
      order by ordinal_position

  
[0m13:27:55.746383 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m13:27:55.750405 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:27:55.750405 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:27:55.754497 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m13:27:55.761480 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:27:55.761480 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts__dbt_tmp132755682335'
        
      order by ordinal_position

  
[0m13:27:55.765476 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m13:27:55.784452 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:27:55.785448 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        
    
    with snapshot_query as (

        



select * FROM "DBT"."raw"."raw_hosts"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DBT"."raw"."scd_raw_hosts"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m13:27:55.786440 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m13:27:55.789406 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:27:55.789406 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m13:27:55.790811 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m13:27:55.790811 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_hosts"
[0m13:27:55.791810 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:27:55.792808 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      update "DBT"."raw"."scd_raw_hosts"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "scd_raw_hosts__dbt_tmp132755682335" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "DBT"."raw"."scd_raw_hosts".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "DBT"."raw"."scd_raw_hosts".dbt_valid_to is null;
      


    insert into "DBT"."raw"."scd_raw_hosts" ("id", "name", "is_superhost", "created_at", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."is_superhost",DBT_INTERNAL_SOURCE."created_at",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "scd_raw_hosts__dbt_tmp132755682335" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m13:27:55.793838 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m13:27:55.807767 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: COMMIT
[0m13:27:55.808765 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:27:55.808765 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: COMMIT
[0m13:27:55.830333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m13:27:55.839319 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: Close
[0m13:27:55.845288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4a31f95-7f12-4134-999b-e7ae60a43f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CCDF8FE0>]}
[0m13:27:55.847293 [info ] [Thread-1 (]: 1 of 2 OK snapshotted raw.scd_raw_hosts ........................................ [[32mINSERT 0 0[0m in 0.41s]
[0m13:27:55.849819 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_hosts
[0m13:27:55.851150 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m13:27:55.852812 [info ] [Thread-1 (]: 2 of 2 START snapshot raw.scd_raw_listings ..................................... [RUN]
[0m13:27:55.854765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearn.scd_raw_hosts, now snapshot.dbtlearn.scd_raw_listings)
[0m13:27:55.855794 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m13:27:55.865768 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m13:27:55.878698 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:55.879695 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: BEGIN
[0m13:27:55.879695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:55.923579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m13:27:55.924605 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:55.924605 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:27:55.944775 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.019 seconds
[0m13:27:55.950761 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:55.951762 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

        
  
    

  create temporary table "scd_raw_listings__dbt_tmp132755948766"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select * FROM "DBT"."raw"."raw_listings"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DBT"."raw"."scd_raw_listings"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m13:27:56.034427 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.082 seconds
[0m13:27:56.038447 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:56.039441 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings__dbt_tmp132755948766'
        
      order by ordinal_position

  
[0m13:27:56.042400 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.003 seconds
[0m13:27:56.046421 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:56.047421 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:27:56.051377 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m13:27:56.055364 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:56.055364 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings__dbt_tmp132755948766'
        
      order by ordinal_position

  
[0m13:27:56.059388 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.003 seconds
[0m13:27:56.062378 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:56.063378 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:27:56.067333 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m13:27:56.070364 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:56.071357 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings__dbt_tmp132755948766'
        
      order by ordinal_position

  
[0m13:27:56.074315 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.003 seconds
[0m13:27:56.077339 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:56.077339 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        
    
    with snapshot_query as (

        



select * FROM "DBT"."raw"."raw_listings"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DBT"."raw"."scd_raw_listings"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m13:27:56.078794 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m13:27:56.079795 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:56.079795 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m13:27:56.080923 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m13:27:56.080923 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:56.082419 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:56.082787 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      update "DBT"."raw"."scd_raw_listings"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "scd_raw_listings__dbt_tmp132755948766" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "DBT"."raw"."scd_raw_listings".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "DBT"."raw"."scd_raw_listings".dbt_valid_to is null;
      


    insert into "DBT"."raw"."scd_raw_listings" ("id", "listing_url", "name", "room_type", "minimum_nights", "host_id", "price", "created_at", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."listing_url",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."minimum_nights",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."created_at",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "scd_raw_listings__dbt_tmp132755948766" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m13:27:56.088770 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.006 seconds
[0m13:27:56.089799 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: COMMIT
[0m13:27:56.090797 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:56.090797 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: COMMIT
[0m13:27:56.100744 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m13:27:56.102738 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m13:27:56.104729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4a31f95-7f12-4134-999b-e7ae60a43f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CB7F8AA0>]}
[0m13:27:56.106726 [info ] [Thread-1 (]: 2 of 2 OK snapshotted raw.scd_raw_listings ..................................... [[32mINSERT 0 1[0m in 0.25s]
[0m13:27:56.108720 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m13:27:56.111750 [info ] [MainThread]: 
[0m13:27:56.112880 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:56.113705 [debug] [MainThread]: On master: BEGIN
[0m13:27:56.114731 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:56.159580 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m13:27:56.159580 [debug] [MainThread]: On master: COMMIT
[0m13:27:56.160614 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:56.160614 [debug] [MainThread]: On master: COMMIT
[0m13:27:56.161648 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:27:56.171584 [info ] [MainThread]: ========== Begin Summary ==========
[0m13:27:56.174540 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:56.175537 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'snapshot.dbtlearn.scd_raw_hosts', 'snapshot',
'2025-02-02 12:27:53.771346+00:00',
'2025-02-02 12:27:55.438268',
'2025-02-02 12:27:55.839319'
,'success','0.40807247161865234',
'b4a31f95-7f12-4134-999b-e7ae60a43f7c','1.9.1',CURRENT_TIMESTAMP(0),'0');
           
      
  
[0m13:27:56.178480 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m13:27:56.179983 [info ] [MainThread]: 
     
[0m13:27:56.181853 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:56.181853 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'snapshot.dbtlearn.scd_raw_listings', 'snapshot',
'2025-02-02 12:27:53.771346+00:00',
'2025-02-02 12:27:55.856022',
'2025-02-02 12:27:56.102738'
,'success','0.24990510940551758',
'b4a31f95-7f12-4134-999b-e7ae60a43f7c','1.9.1',CURRENT_TIMESTAMP(0),'1');
           
      
  
[0m13:27:56.183280 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m13:27:56.184812 [info ] [MainThread]: 
     
[0m13:27:56.187042 [info ] [MainThread]: ========== End Summary ==========
[0m13:27:56.188802 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m13:27:56.195783 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m13:27:56.196749 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.04s]
[0m13:27:56.197659 [debug] [MainThread]: On master: Close
[0m13:27:56.198653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:56.198653 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m13:27:56.199618 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m13:27:56.199618 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m13:27:56.200807 [info ] [MainThread]: 
[0m13:27:56.201614 [info ] [MainThread]: Finished running 1 project hook, 2 snapshots in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m13:27:56.202611 [debug] [MainThread]: Command end result
[0m13:27:56.336251 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m13:27:56.339119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m13:27:56.346226 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m13:27:56.346400 [info ] [MainThread]: 
[0m13:27:56.347225 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:56.348221 [info ] [MainThread]: 
[0m13:27:56.348221 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:27:56.350247 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:27:56.349218 after 2.68 seconds
[0m13:27:56.350247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CADC58E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CD763CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CD762DB0>]}
[0m13:27:56.351240 [debug] [MainThread]: Flushing usage events
[0m13:27:57.022322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:20.850419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DF6F42270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFA4337D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DF8379190>]}


============================== 13:37:20.858193 | b2411d71-b2ee-43d7-a9a2-a133efea8fa5 ==============================
[0m13:37:20.858193 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:37:20.863413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m13:37:21.084818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2411d71-b2ee-43d7-a9a2-a133efea8fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DF796D700>]}
[0m13:37:21.156414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2411d71-b2ee-43d7-a9a2-a133efea8fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFA7256A0>]}
[0m13:37:21.161565 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:37:21.376689 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:37:21.689820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:37:21.689820 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:37:21.784349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2411d71-b2ee-43d7-a9a2-a133efea8fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFA863590>]}
[0m13:37:21.957318 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m13:37:21.961275 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m13:37:21.998867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2411d71-b2ee-43d7-a9a2-a133efea8fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFBD37FE0>]}
[0m13:37:21.999898 [info ] [MainThread]: Found 8 models, 1 analysis, 22 data tests, 1 seed, 1 operation, 2 snapshots, 3 sources, 1 exposure, 814 macros
[0m13:37:22.000844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2411d71-b2ee-43d7-a9a2-a133efea8fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFA9AC9E0>]}
[0m13:37:22.002873 [info ] [MainThread]: 
[0m13:37:22.004281 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:37:22.004281 [info ] [MainThread]: 
[0m13:37:22.005311 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:37:22.009873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m13:37:22.093087 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m13:37:22.093087 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m13:37:22.093087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:22.148525 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.052 seconds
[0m13:37:22.149522 [debug] [ThreadPool]: On list_DBT: Close
[0m13:37:22.152677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m13:37:22.153703 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m13:37:22.153703 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m13:37:22.153703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:22.195106 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m13:37:22.196103 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m13:37:22.196103 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m13:37:22.203076 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.008 seconds
[0m13:37:22.203076 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m13:37:22.207419 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m13:37:22.216167 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:22.216167 [debug] [MainThread]: On master: BEGIN
[0m13:37:22.216167 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:37:22.258020 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m13:37:22.259046 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:22.259046 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:37:22.269275 [debug] [MainThread]: SQL status: SELECT 3 in 0.010 seconds
[0m13:37:22.269275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2411d71-b2ee-43d7-a9a2-a133efea8fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFC15BFE0>]}
[0m13:37:22.269275 [debug] [MainThread]: On master: ROLLBACK
[0m13:37:22.269275 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:22.274884 [debug] [MainThread]: On master: BEGIN
[0m13:37:22.276022 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:37:22.276022 [debug] [MainThread]: On master: COMMIT
[0m13:37:22.277033 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:22.277033 [debug] [MainThread]: On master: COMMIT
[0m13:37:22.277033 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:37:22.277033 [debug] [MainThread]: On master: Close
[0m13:37:22.282883 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_hosts
[0m13:37:22.283911 [info ] [Thread-1 (]: 1 of 2 START snapshot raw.scd_raw_hosts ........................................ [RUN]
[0m13:37:22.286500 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbtlearn.scd_raw_hosts'
[0m13:37:22.286500 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_hosts
[0m13:37:22.309375 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_hosts
[0m13:37:22.367500 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:37:22.367500 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: BEGIN
[0m13:37:22.367500 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:37:22.407301 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m13:37:22.407301 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:37:22.407301 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:37:22.426647 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.020 seconds
[0m13:37:22.491178 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:37:22.491178 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

        
  
    

  create temporary table "scd_raw_hosts__dbt_tmp133722483186"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select * FROM "DBT"."raw"."raw_hosts"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DBT"."raw"."scd_raw_hosts"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m13:37:22.520219 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.031 seconds
[0m13:37:22.520219 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:37:22.528220 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts__dbt_tmp133722483186'
        
      order by ordinal_position

  
[0m13:37:22.528220 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m13:37:22.528220 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:37:22.528220 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:37:22.537347 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m13:37:22.537347 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:37:22.537347 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts__dbt_tmp133722483186'
        
      order by ordinal_position

  
[0m13:37:22.545378 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m13:37:22.545378 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:37:22.545378 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:37:22.553372 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m13:37:22.557043 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:37:22.557043 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts__dbt_tmp133722483186'
        
      order by ordinal_position

  
[0m13:37:22.565369 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m13:37:22.582493 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:37:22.582493 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        
    
    with snapshot_query as (

        



select * FROM "DBT"."raw"."raw_hosts"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DBT"."raw"."scd_raw_hosts"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m13:37:22.584187 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m13:37:22.584187 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:37:22.584187 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m13:37:22.584187 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m13:37:22.584187 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_hosts"
[0m13:37:22.589849 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:37:22.589849 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      update "DBT"."raw"."scd_raw_hosts"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "scd_raw_hosts__dbt_tmp133722483186" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "DBT"."raw"."scd_raw_hosts".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "DBT"."raw"."scd_raw_hosts".dbt_valid_to is null;
      


    insert into "DBT"."raw"."scd_raw_hosts" ("id", "name", "is_superhost", "created_at", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."is_superhost",DBT_INTERNAL_SOURCE."created_at",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "scd_raw_hosts__dbt_tmp133722483186" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m13:37:22.590847 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m13:37:22.601316 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: COMMIT
[0m13:37:22.601316 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:37:22.609432 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: COMMIT
[0m13:37:22.613775 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:37:22.617799 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: Close
[0m13:37:22.620919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2411d71-b2ee-43d7-a9a2-a133efea8fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DF796C8C0>]}
[0m13:37:22.621912 [info ] [Thread-1 (]: 1 of 2 OK snapshotted raw.scd_raw_hosts ........................................ [[32mINSERT 0 0[0m in 0.33s]
[0m13:37:22.623187 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_hosts
[0m13:37:22.624184 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m13:37:22.624184 [info ] [Thread-1 (]: 2 of 2 START snapshot raw.scd_raw_listings ..................................... [RUN]
[0m13:37:22.625506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearn.scd_raw_hosts, now snapshot.dbtlearn.scd_raw_listings)
[0m13:37:22.625506 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m13:37:22.627533 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m13:37:22.636414 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:37:22.636414 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: BEGIN
[0m13:37:22.637446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:22.672170 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m13:37:22.673199 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:37:22.673199 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:37:22.692336 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.018 seconds
[0m13:37:22.693365 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:37:22.693365 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

        
  
    

  create temporary table "scd_raw_listings__dbt_tmp133722693365"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select * FROM "DBT"."raw"."raw_listings"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DBT"."raw"."scd_raw_listings"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m13:37:22.761276 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.064 seconds
[0m13:37:22.761276 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:37:22.761276 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings__dbt_tmp133722693365'
        
      order by ordinal_position

  
[0m13:37:22.769381 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.003 seconds
[0m13:37:22.769381 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:37:22.769381 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:37:22.777378 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m13:37:22.777378 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:37:22.777378 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings__dbt_tmp133722693365'
        
      order by ordinal_position

  
[0m13:37:22.785336 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.003 seconds
[0m13:37:22.785336 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:37:22.785336 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:37:22.785336 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m13:37:22.793361 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:37:22.793361 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings__dbt_tmp133722693365'
        
      order by ordinal_position

  
[0m13:37:22.793361 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.003 seconds
[0m13:37:22.801356 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:37:22.801356 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        
    
    with snapshot_query as (

        



select * FROM "DBT"."raw"."raw_listings"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DBT"."raw"."scd_raw_listings"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m13:37:22.801356 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m13:37:22.801356 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:37:22.801356 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m13:37:22.805185 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m13:37:22.805185 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_listings"
[0m13:37:22.806216 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:37:22.806916 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      update "DBT"."raw"."scd_raw_listings"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "scd_raw_listings__dbt_tmp133722693365" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "DBT"."raw"."scd_raw_listings".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "DBT"."raw"."scd_raw_listings".dbt_valid_to is null;
      


    insert into "DBT"."raw"."scd_raw_listings" ("id", "listing_url", "name", "room_type", "minimum_nights", "host_id", "price", "created_at", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."listing_url",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."minimum_nights",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."created_at",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "scd_raw_listings__dbt_tmp133722693365" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m13:37:22.807946 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m13:37:22.807946 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: COMMIT
[0m13:37:22.807946 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:37:22.807946 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: COMMIT
[0m13:37:22.811643 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:37:22.812675 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m13:37:22.812675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2411d71-b2ee-43d7-a9a2-a133efea8fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFA8620C0>]}
[0m13:37:22.813878 [info ] [Thread-1 (]: 2 of 2 OK snapshotted raw.scd_raw_listings ..................................... [[32mINSERT 0 0[0m in 0.19s]
[0m13:37:22.815884 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m13:37:22.816871 [info ] [MainThread]: 
[0m13:37:22.818033 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:22.818033 [debug] [MainThread]: On master: BEGIN
[0m13:37:22.818033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:37:23.001090 [debug] [MainThread]: SQL status: BEGIN in 0.182 seconds
[0m13:37:23.001090 [debug] [MainThread]: On master: COMMIT
[0m13:37:23.002087 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:23.002087 [debug] [MainThread]: On master: COMMIT
[0m13:37:23.002087 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:37:23.018177 [info ] [MainThread]: ========== Begin Summary ==========
[0m13:37:23.026663 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:23.026663 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'snapshot.dbtlearn.scd_raw_hosts', 'snapshot',
'2025-02-02 12:37:20.660700+00:00',
'2025-02-02 12:37:22.286500',
'2025-02-02 12:37:22.617799'
,'success','0.3343222141265869',
'b2411d71-b2ee-43d7-a9a2-a133efea8fa5','1.9.1',CURRENT_TIMESTAMP(0),'0');
           
      
  
[0m13:37:23.052680 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.022 seconds
[0m13:37:23.054678 [info ] [MainThread]: 
     
[0m13:37:23.057231 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:23.057231 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'snapshot.dbtlearn.scd_raw_listings', 'snapshot',
'2025-02-02 12:37:20.660700+00:00',
'2025-02-02 12:37:22.626535',
'2025-02-02 12:37:22.812675'
,'success','0.18716907501220703',
'b2411d71-b2ee-43d7-a9a2-a133efea8fa5','1.9.1',CURRENT_TIMESTAMP(0),'0');
           
      
  
[0m13:37:23.059375 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m13:37:23.060377 [info ] [MainThread]: 
     
[0m13:37:23.064966 [info ] [MainThread]: ========== End Summary ==========
[0m13:37:23.066959 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m13:37:23.074375 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m13:37:23.080150 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.08s]
[0m13:37:23.082147 [debug] [MainThread]: On master: Close
[0m13:37:23.083450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:23.083450 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m13:37:23.085446 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m13:37:23.085446 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m13:37:23.086444 [info ] [MainThread]: 
[0m13:37:23.087439 [info ] [MainThread]: Finished running 1 project hook, 2 snapshots in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m13:37:23.090489 [debug] [MainThread]: Command end result
[0m13:37:23.218633 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m13:37:23.222331 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m13:37:23.223360 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m13:37:23.229535 [info ] [MainThread]: 
[0m13:37:23.230532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:37:23.230532 [info ] [MainThread]: 
[0m13:37:23.231866 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:37:23.232864 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:37:23.232864 after 2.67 seconds
[0m13:37:23.232864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DF9CB3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFC7683B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFC769400>]}
[0m13:37:23.232864 [debug] [MainThread]: Flushing usage events
[0m13:37:24.052395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:21.630510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020488E97CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020488E97050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020488E97890>]}


============================== 13:41:21.635943 | b8940580-b3e0-49c2-aaa3-8777703ede33 ==============================
[0m13:41:21.635943 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:41:21.635943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:41:21.847536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8940580-b3e0-49c2-aaa3-8777703ede33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020489073470>]}
[0m13:41:21.911670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8940580-b3e0-49c2-aaa3-8777703ede33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204883F8890>]}
[0m13:41:21.916586 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:41:22.133214 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:41:22.449797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:41:22.449797 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:41:22.541118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8940580-b3e0-49c2-aaa3-8777703ede33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020488FD0EC0>]}
[0m13:41:22.710613 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m13:41:22.714740 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m13:41:22.787611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8940580-b3e0-49c2-aaa3-8777703ede33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048A2BE5A0>]}
[0m13:41:22.788610 [info ] [MainThread]: Found 8 models, 1 analysis, 22 data tests, 1 seed, 1 operation, 2 snapshots, 3 sources, 1 exposure, 814 macros
[0m13:41:22.789608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8940580-b3e0-49c2-aaa3-8777703ede33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020489073AD0>]}
[0m13:41:22.791604 [info ] [MainThread]: 
[0m13:41:22.795633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:41:22.796679 [info ] [MainThread]: 
[0m13:41:22.798625 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:41:22.805605 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m13:41:22.900893 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m13:41:22.900893 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m13:41:22.900893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:22.943201 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.039 seconds
[0m13:41:22.943201 [debug] [ThreadPool]: On list_DBT: Close
[0m13:41:22.946446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m13:41:22.948550 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m13:41:22.948550 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m13:41:22.948550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:23.006894 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m13:41:23.007892 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m13:41:23.007892 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m13:41:23.023038 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.014 seconds
[0m13:41:23.026650 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m13:41:23.029827 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m13:41:23.046550 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:23.046550 [debug] [MainThread]: On master: BEGIN
[0m13:41:23.046550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:23.248045 [debug] [MainThread]: SQL status: BEGIN in 0.196 seconds
[0m13:41:23.248903 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:23.249954 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:41:23.266407 [debug] [MainThread]: SQL status: SELECT 3 in 0.019 seconds
[0m13:41:23.266407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8940580-b3e0-49c2-aaa3-8777703ede33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048A66ED20>]}
[0m13:41:23.275231 [debug] [MainThread]: On master: ROLLBACK
[0m13:41:23.276318 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:23.277347 [debug] [MainThread]: On master: BEGIN
[0m13:41:23.278323 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:41:23.279353 [debug] [MainThread]: On master: COMMIT
[0m13:41:23.279353 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:23.279353 [debug] [MainThread]: On master: COMMIT
[0m13:41:23.279353 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:41:23.283049 [debug] [MainThread]: On master: Close
[0m13:41:23.287472 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_hosts
[0m13:41:23.288469 [info ] [Thread-1 (]: 1 of 2 START snapshot raw.scd_raw_hosts ........................................ [RUN]
[0m13:41:23.294018 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbtlearn.scd_raw_hosts'
[0m13:41:23.294018 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_hosts
[0m13:41:23.320439 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_hosts
[0m13:41:23.375857 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:41:23.375857 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: BEGIN
[0m13:41:23.375857 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:41:23.427552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m13:41:23.428110 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:41:23.428110 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:41:23.464494 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.037 seconds
[0m13:41:23.544486 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:41:23.544486 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

        
  
    

  create temporary table "scd_raw_hosts__dbt_tmp134123536493"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select * FROM "DBT"."raw"."raw_hosts"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DBT"."raw"."scd_raw_hosts"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m13:41:23.578272 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.034 seconds
[0m13:41:23.578272 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:41:23.578272 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts__dbt_tmp134123536493'
        
      order by ordinal_position

  
[0m13:41:23.586266 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m13:41:23.586266 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:41:23.586266 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:41:23.594264 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m13:41:23.594264 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:41:23.594264 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts__dbt_tmp134123536493'
        
      order by ordinal_position

  
[0m13:41:23.602254 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m13:41:23.610255 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:41:23.610531 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:41:23.616322 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.005 seconds
[0m13:41:23.622171 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:41:23.622171 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_hosts__dbt_tmp134123536493'
        
      order by ordinal_position

  
[0m13:41:23.622171 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m13:41:23.643868 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:41:23.643868 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        
    
    with snapshot_query as (

        



select * FROM "DBT"."raw"."raw_hosts"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DBT"."raw"."scd_raw_hosts"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m13:41:23.643868 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m13:41:23.643868 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:41:23.651943 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m13:41:23.651943 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m13:41:23.651943 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_hosts"
[0m13:41:23.654041 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:41:23.655074 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */

      update "DBT"."raw"."scd_raw_hosts"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "scd_raw_hosts__dbt_tmp134123536493" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "DBT"."raw"."scd_raw_hosts".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "DBT"."raw"."scd_raw_hosts".dbt_valid_to is null;
      


    insert into "DBT"."raw"."scd_raw_hosts" ("id", "name", "is_superhost", "created_at", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."is_superhost",DBT_INTERNAL_SOURCE."created_at",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "scd_raw_hosts__dbt_tmp134123536493" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m13:41:23.658130 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.005 seconds
[0m13:41:23.674172 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: COMMIT
[0m13:41:23.674172 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_hosts"
[0m13:41:23.674172 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: COMMIT
[0m13:41:23.690659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m13:41:23.706993 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: Close
[0m13:41:23.713714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8940580-b3e0-49c2-aaa3-8777703ede33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020489142D80>]}
[0m13:41:23.715307 [info ] [Thread-1 (]: 1 of 2 OK snapshotted raw.scd_raw_hosts ........................................ [[32mINSERT 0 1[0m in 0.42s]
[0m13:41:23.718332 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_hosts
[0m13:41:23.719422 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m13:41:23.720420 [info ] [Thread-1 (]: 2 of 2 START snapshot raw.scd_raw_listings ..................................... [RUN]
[0m13:41:23.721565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearn.scd_raw_hosts, now snapshot.dbtlearn.scd_raw_listings)
[0m13:41:23.722563 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m13:41:23.729001 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m13:41:23.735200 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:41:23.736364 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: BEGIN
[0m13:41:23.736364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:23.774597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m13:41:23.774597 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:41:23.774597 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:41:23.791480 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.017 seconds
[0m13:41:23.791480 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:41:23.791480 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

        
  
    

  create temporary table "scd_raw_listings__dbt_tmp134123791480"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select * FROM "DBT"."raw"."raw_listings"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DBT"."raw"."scd_raw_listings"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m13:41:23.865287 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.069 seconds
[0m13:41:23.866313 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:41:23.866313 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings__dbt_tmp134123791480'
        
      order by ordinal_position

  
[0m13:41:23.874450 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.003 seconds
[0m13:41:23.875484 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:41:23.875484 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:41:23.875484 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m13:41:23.883515 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:41:23.883515 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings__dbt_tmp134123791480'
        
      order by ordinal_position

  
[0m13:41:23.891511 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.003 seconds
[0m13:41:23.891511 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:41:23.891511 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m13:41:23.899506 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m13:41:23.899506 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:41:23.899506 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'scd_raw_listings__dbt_tmp134123791480'
        
      order by ordinal_position

  
[0m13:41:23.907500 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.004 seconds
[0m13:41:23.907500 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:41:23.907500 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        
    
    with snapshot_query as (

        



select * FROM "DBT"."raw"."raw_listings"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DBT"."raw"."scd_raw_listings"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m13:41:23.915464 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m13:41:23.915464 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:41:23.915464 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m13:41:23.915464 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m13:41:23.915464 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_listings"
[0m13:41:23.915464 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:41:23.919745 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */

      update "DBT"."raw"."scd_raw_listings"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "scd_raw_listings__dbt_tmp134123791480" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "DBT"."raw"."scd_raw_listings".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "DBT"."raw"."scd_raw_listings".dbt_valid_to is null;
      


    insert into "DBT"."raw"."scd_raw_listings" ("id", "listing_url", "name", "room_type", "minimum_nights", "host_id", "price", "created_at", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."listing_url",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."minimum_nights",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."created_at",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "scd_raw_listings__dbt_tmp134123791480" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m13:41:23.920787 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m13:41:23.920787 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: COMMIT
[0m13:41:23.920787 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:41:23.920787 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: COMMIT
[0m13:41:23.925570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:41:23.926599 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m13:41:23.926599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8940580-b3e0-49c2-aaa3-8777703ede33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048B04DE50>]}
[0m13:41:23.928362 [info ] [Thread-1 (]: 2 of 2 OK snapshotted raw.scd_raw_listings ..................................... [[32mINSERT 0 0[0m in 0.21s]
[0m13:41:23.929361 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m13:41:23.931355 [info ] [MainThread]: 
[0m13:41:23.932352 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:23.932352 [debug] [MainThread]: On master: BEGIN
[0m13:41:23.933380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:23.972596 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m13:41:23.972596 [debug] [MainThread]: On master: COMMIT
[0m13:41:23.973624 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:23.973624 [debug] [MainThread]: On master: COMMIT
[0m13:41:23.974781 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:41:23.985394 [info ] [MainThread]: ========== Begin Summary ==========
[0m13:41:23.987388 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:23.987388 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'snapshot.dbtlearn.scd_raw_hosts', 'snapshot',
'2025-02-02 12:41:21.443893+00:00',
'2025-02-02 12:41:23.294018',
'2025-02-02 12:41:23.706993'
,'success','0.4174215793609619',
'b8940580-b3e0-49c2-aaa3-8777703ede33','1.9.1',CURRENT_TIMESTAMP(0),'1');
           
      
  
[0m13:41:23.991983 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m13:41:23.993323 [info ] [MainThread]: 
     
[0m13:41:23.994396 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:23.995424 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'snapshot.dbtlearn.scd_raw_listings', 'snapshot',
'2025-02-02 12:41:21.443893+00:00',
'2025-02-02 12:41:23.723562',
'2025-02-02 12:41:23.926599'
,'success','0.2050340175628662',
'b8940580-b3e0-49c2-aaa3-8777703ede33','1.9.1',CURRENT_TIMESTAMP(0),'0');
           
      
  
[0m13:41:23.996352 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m13:41:23.997383 [info ] [MainThread]: 
     
[0m13:41:23.998585 [info ] [MainThread]: ========== End Summary ==========
[0m13:41:24.000582 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m13:41:24.004712 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m13:41:24.008373 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m13:41:24.009370 [debug] [MainThread]: On master: Close
[0m13:41:24.010368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:24.010368 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m13:41:24.010368 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m13:41:24.011365 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m13:41:24.011365 [info ] [MainThread]: 
[0m13:41:24.012393 [info ] [MainThread]: Finished running 1 project hook, 2 snapshots in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m13:41:24.014383 [debug] [MainThread]: Command end result
[0m13:41:24.134367 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m13:41:24.134367 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m13:41:24.142283 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m13:41:24.148434 [info ] [MainThread]: 
[0m13:41:24.149432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:41:24.150442 [info ] [MainThread]: 
[0m13:41:24.150442 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:41:24.151477 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:41:24.151477 after 2.81 seconds
[0m13:41:24.152454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020486C591F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020486C59310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204887E4CE0>]}
[0m13:41:24.152454 [debug] [MainThread]: Flushing usage events
[0m13:41:24.999209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:16.680098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBBE684080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBBE687140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBBE684EC0>]}


============================== 14:37:16.684581 | 83d78873-c913-43b0-acb5-32bc4041b86a ==============================
[0m14:37:16.684581 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:37:16.685815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --select scd_raw_reviews', 'send_anonymous_usage_stats': 'True'}
[0m14:37:16.888058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83d78873-c913-43b0-acb5-32bc4041b86a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBBE7C0860>]}
[0m14:37:16.958740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83d78873-c913-43b0-acb5-32bc4041b86a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBBE65FC80>]}
[0m14:37:16.959873 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:37:17.177700 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:37:17.509947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:37:17.509947 [debug] [MainThread]: Partial parsing: added file: dbtlearn://snapshots\scd_raw_reviews.sql
[0m14:37:17.853814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83d78873-c913-43b0-acb5-32bc4041b86a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBBE6A7E00>]}
[0m14:37:18.027471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m14:37:18.031608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m14:37:18.067004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83d78873-c913-43b0-acb5-32bc4041b86a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBBFFB2FC0>]}
[0m14:37:18.068002 [info ] [MainThread]: Found 8 models, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 snapshots, 3 sources, 1 exposure, 814 macros
[0m14:37:18.068002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83d78873-c913-43b0-acb5-32bc4041b86a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBBE9736B0>]}
[0m14:37:18.070029 [info ] [MainThread]: 
[0m14:37:18.071158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:37:18.072156 [info ] [MainThread]: 
[0m14:37:18.072156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:18.074062 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m14:37:18.151086 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m14:37:18.152079 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m14:37:18.152079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:18.330858 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.179 seconds
[0m14:37:18.330858 [debug] [ThreadPool]: On list_DBT: Close
[0m14:37:18.337165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m14:37:18.343232 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m14:37:18.343232 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m14:37:18.343232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:18.536143 [debug] [ThreadPool]: SQL status: BEGIN in 0.187 seconds
[0m14:37:18.536143 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m14:37:18.536143 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m14:37:18.548501 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.010 seconds
[0m14:37:18.548501 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m14:37:18.552100 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m14:37:18.560090 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:18.560090 [debug] [MainThread]: On master: BEGIN
[0m14:37:18.560090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:18.740332 [debug] [MainThread]: SQL status: BEGIN in 0.175 seconds
[0m14:37:18.741331 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:18.741646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:37:18.750164 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m14:37:18.750164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83d78873-c913-43b0-acb5-32bc4041b86a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBBFE9D130>]}
[0m14:37:18.750164 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:18.752613 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:18.752613 [debug] [MainThread]: On master: BEGIN
[0m14:37:18.753463 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:37:18.753463 [debug] [MainThread]: On master: COMMIT
[0m14:37:18.753463 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:18.754492 [debug] [MainThread]: On master: COMMIT
[0m14:37:18.755146 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:18.755146 [debug] [MainThread]: On master: Close
[0m14:37:18.757250 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_reviews
[0m14:37:18.758282 [info ] [Thread-1 (]: 1 of 1 START snapshot raw.scd_raw_reviews ...................................... [RUN]
[0m14:37:18.758863 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbtlearn.scd_raw_reviews'
[0m14:37:18.758863 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_reviews
[0m14:37:18.760891 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_reviews
[0m14:37:18.833071 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_reviews"
[0m14:37:18.833071 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_reviews"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select * FROM "DBT"."raw"."raw_reviews"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m14:37:18.833071 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:37:18.989703 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                  ^

[0m14:37:18.989703 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_reviews: Close
[0m14:37:18.997115 [debug] [Thread-1 (]: Database Error in snapshot scd_raw_reviews (snapshots\scd_raw_reviews.sql)
  column "id" does not exist
  LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                    ^
[0m14:37:19.000803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83d78873-c913-43b0-acb5-32bc4041b86a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBBE973F80>]}
[0m14:37:19.001831 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting raw.scd_raw_reviews .................................. [[31mERROR[0m in 0.24s]
[0m14:37:19.002345 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_reviews
[0m14:37:19.003373 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbtlearn.scd_raw_reviews' to be skipped because of status 'error'.  Reason: Database Error in snapshot scd_raw_reviews (snapshots\scd_raw_reviews.sql)
  column "id" does not exist
  LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                    ^.
[0m14:37:19.006678 [info ] [MainThread]: 
[0m14:37:19.007677 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:19.007677 [debug] [MainThread]: On master: BEGIN
[0m14:37:19.008674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:19.045901 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m14:37:19.046929 [debug] [MainThread]: On master: COMMIT
[0m14:37:19.046929 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:19.047871 [debug] [MainThread]: On master: COMMIT
[0m14:37:19.048869 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:19.060265 [info ] [MainThread]: ========== Begin Summary ==========
[0m14:37:19.062752 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:19.062752 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'snapshot.dbtlearn.scd_raw_reviews', 'snapshot',
'2025-02-02 13:37:16.586615+00:00',
'2025-02-02 13:37:18.759895',
'2025-02-02 13:37:18.989703'
,'error','0.2382514476776123',
'83d78873-c913-43b0-acb5-32bc4041b86a','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m14:37:19.075420 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.011 seconds
[0m14:37:19.077441 [info ] [MainThread]: 
     
[0m14:37:19.078449 [info ] [MainThread]: ========== End Summary ==========
[0m14:37:19.079448 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m14:37:19.087917 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m14:37:19.090484 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.04s]
[0m14:37:19.091482 [debug] [MainThread]: On master: Close
[0m14:37:19.091482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:19.092724 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m14:37:19.092724 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m14:37:19.092724 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_reviews' was properly closed.
[0m14:37:19.093721 [info ] [MainThread]: 
[0m14:37:19.093721 [info ] [MainThread]: Finished running 1 project hook, 1 snapshot in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m14:37:19.095716 [debug] [MainThread]: Command end result
[0m14:37:19.216429 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m14:37:19.218993 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m14:37:19.224857 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m14:37:19.224857 [info ] [MainThread]: 
[0m14:37:19.225859 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:37:19.226865 [info ] [MainThread]: 
[0m14:37:19.226865 [error] [MainThread]:   Database Error in snapshot scd_raw_reviews (snapshots\scd_raw_reviews.sql)
  column "id" does not exist
  LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                    ^
[0m14:37:19.228848 [info ] [MainThread]: 
[0m14:37:19.229844 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:37:19.230860 [debug] [MainThread]: Command `dbt snapshot` failed at 14:37:19.230860 after 2.74 seconds
[0m14:37:19.231839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBBE274DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBC0424AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBC0424DA0>]}
[0m14:37:19.231839 [debug] [MainThread]: Flushing usage events
[0m14:37:19.708758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:51.027136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3B40BF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3A118FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3A119100>]}


============================== 14:37:51.030855 | 769eee06-7885-475d-8660-ed1155187319 ==============================
[0m14:37:51.030855 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:37:51.031982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --select scd_raw_reviews', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:51.231498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '769eee06-7885-475d-8660-ed1155187319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3C556E70>]}
[0m14:37:51.299947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '769eee06-7885-475d-8660-ed1155187319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3970D4F0>]}
[0m14:37:51.302896 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:37:51.515691 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:37:51.845323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:51.845323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:51.941109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '769eee06-7885-475d-8660-ed1155187319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3DAFEA20>]}
[0m14:37:52.125341 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m14:37:52.129371 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m14:37:52.163198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '769eee06-7885-475d-8660-ed1155187319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3D7DEF60>]}
[0m14:37:52.164203 [info ] [MainThread]: Found 8 models, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 snapshots, 3 sources, 1 exposure, 814 macros
[0m14:37:52.166267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '769eee06-7885-475d-8660-ed1155187319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3D960500>]}
[0m14:37:52.168734 [info ] [MainThread]: 
[0m14:37:52.169383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:37:52.170281 [info ] [MainThread]: 
[0m14:37:52.171256 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:52.173272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m14:37:52.253835 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m14:37:52.254871 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m14:37:52.254871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:52.295374 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.040 seconds
[0m14:37:52.295374 [debug] [ThreadPool]: On list_DBT: Close
[0m14:37:52.299572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m14:37:52.303383 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m14:37:52.303383 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m14:37:52.303383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:52.338268 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m14:37:52.339296 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m14:37:52.339296 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m14:37:52.345731 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.006 seconds
[0m14:37:52.345731 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m14:37:52.348163 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m14:37:52.355177 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:52.355177 [debug] [MainThread]: On master: BEGIN
[0m14:37:52.355177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:52.388048 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m14:37:52.389077 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:52.389077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:37:52.396619 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m14:37:52.396619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '769eee06-7885-475d-8660-ed1155187319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3C5767E0>]}
[0m14:37:52.396619 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:52.396619 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:52.396619 [debug] [MainThread]: On master: BEGIN
[0m14:37:52.400906 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:37:52.400906 [debug] [MainThread]: On master: COMMIT
[0m14:37:52.400906 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:52.401936 [debug] [MainThread]: On master: COMMIT
[0m14:37:52.402551 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:52.402551 [debug] [MainThread]: On master: Close
[0m14:37:52.406052 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_reviews
[0m14:37:52.407199 [info ] [Thread-1 (]: 1 of 1 START snapshot raw.scd_raw_reviews ...................................... [RUN]
[0m14:37:52.408206 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbtlearn.scd_raw_reviews'
[0m14:37:52.408206 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_reviews
[0m14:37:52.410227 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_reviews
[0m14:37:52.484109 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_reviews"
[0m14:37:52.485106 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_reviews"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select * FROM "DBT"."raw"."raw_reviews"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m14:37:52.485106 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:37:52.527147 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                  ^

[0m14:37:52.527147 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_reviews: Close
[0m14:37:52.532532 [debug] [Thread-1 (]: Database Error in snapshot scd_raw_reviews (snapshots\scd_raw_reviews.sql)
  column "id" does not exist
  LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                    ^
[0m14:37:52.535863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '769eee06-7885-475d-8660-ed1155187319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3DBC8CE0>]}
[0m14:37:52.536862 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting raw.scd_raw_reviews .................................. [[31mERROR[0m in 0.12s]
[0m14:37:52.537521 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_reviews
[0m14:37:52.538519 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbtlearn.scd_raw_reviews' to be skipped because of status 'error'.  Reason: Database Error in snapshot scd_raw_reviews (snapshots\scd_raw_reviews.sql)
  column "id" does not exist
  LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                    ^.
[0m14:37:52.539759 [info ] [MainThread]: 
[0m14:37:52.540757 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:52.540757 [debug] [MainThread]: On master: BEGIN
[0m14:37:52.540757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:52.716745 [debug] [MainThread]: SQL status: BEGIN in 0.176 seconds
[0m14:37:52.717742 [debug] [MainThread]: On master: COMMIT
[0m14:37:52.717742 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:52.717742 [debug] [MainThread]: On master: COMMIT
[0m14:37:52.719185 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:52.728312 [info ] [MainThread]: ========== Begin Summary ==========
[0m14:37:52.731840 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:52.732870 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'snapshot.dbtlearn.scd_raw_reviews', 'snapshot',
'2025-02-02 13:37:50.971400+00:00',
'2025-02-02 13:37:52.409219',
'2025-02-02 13:37:52.527147'
,'error','0.12432527542114258',
'769eee06-7885-475d-8660-ed1155187319','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m14:37:52.735598 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.005 seconds
[0m14:37:52.735598 [info ] [MainThread]: 
     
[0m14:37:52.740109 [info ] [MainThread]: ========== End Summary ==========
[0m14:37:52.741333 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m14:37:52.748623 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m14:37:52.750571 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m14:37:52.751577 [debug] [MainThread]: On master: Close
[0m14:37:52.751577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:52.752673 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m14:37:52.752673 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m14:37:52.752673 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_reviews' was properly closed.
[0m14:37:52.753672 [info ] [MainThread]: 
[0m14:37:52.754668 [info ] [MainThread]: Finished running 1 project hook, 1 snapshot in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m14:37:52.755667 [debug] [MainThread]: Command end result
[0m14:37:52.802603 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m14:37:52.804591 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m14:37:52.811215 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m14:37:52.811215 [info ] [MainThread]: 
[0m14:37:52.812225 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:37:52.813213 [info ] [MainThread]: 
[0m14:37:52.813799 [error] [MainThread]:   Database Error in snapshot scd_raw_reviews (snapshots\scd_raw_reviews.sql)
  column "id" does not exist
  LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                    ^
[0m14:37:52.815291 [info ] [MainThread]: 
[0m14:37:52.815962 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:37:52.817235 [debug] [MainThread]: Command `dbt snapshot` failed at 14:37:52.817235 after 1.94 seconds
[0m14:37:52.817982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3BFBD2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3BFBF410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3C0C2690>]}
[0m14:37:52.817982 [debug] [MainThread]: Flushing usage events
[0m14:37:53.305062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:23.567501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F293EB320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F267AC1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F27157E00>]}


============================== 14:38:23.571698 | 357e867a-18ae-4426-92b3-791322afc6b5 ==============================
[0m14:38:23.571698 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:38:23.573143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --select scd_raw_reviews', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:38:23.772188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '357e867a-18ae-4426-92b3-791322afc6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F267AD4C0>]}
[0m14:38:23.842881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '357e867a-18ae-4426-92b3-791322afc6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F28F2BC20>]}
[0m14:38:23.844800 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:38:24.055578 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:38:24.369669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:38:24.369669 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://snapshots\scd_raw_reviews.sql
[0m14:38:24.572412 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot scd_raw_reviews (snapshots\scd_raw_reviews.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m14:38:24.574108 [debug] [MainThread]: Command `dbt snapshot` failed at 14:38:24.574108 after 1.16 seconds
[0m14:38:24.574108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F28FFBF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F23287BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F29652F60>]}
[0m14:38:24.575102 [debug] [MainThread]: Flushing usage events
[0m14:38:25.069937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:45.398482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D482444920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D482446FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D480AD9010>]}


============================== 14:40:45.403418 | 40292923-eed8-4064-abef-35dcecf7f1b1 ==============================
[0m14:40:45.403418 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:40:45.404057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --select scd_raw_reviews', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:40:45.604536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40292923-eed8-4064-abef-35dcecf7f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D482BED670>]}
[0m14:40:45.668519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40292923-eed8-4064-abef-35dcecf7f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D482D17C80>]}
[0m14:40:45.670355 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:40:45.894089 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:40:46.209554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:46.209554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:46.302278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40292923-eed8-4064-abef-35dcecf7f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D482F89130>]}
[0m14:40:46.470633 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m14:40:46.474471 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m14:40:46.506354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40292923-eed8-4064-abef-35dcecf7f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D482FEE750>]}
[0m14:40:46.507351 [info ] [MainThread]: Found 8 models, 1 analysis, 22 data tests, 1 seed, 1 operation, 3 snapshots, 3 sources, 1 exposure, 814 macros
[0m14:40:46.508454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40292923-eed8-4064-abef-35dcecf7f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4826C2930>]}
[0m14:40:46.510474 [info ] [MainThread]: 
[0m14:40:46.511003 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:46.511003 [info ] [MainThread]: 
[0m14:40:46.512000 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:40:46.512997 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m14:40:46.591170 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m14:40:46.591170 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m14:40:46.591170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:46.627953 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.037 seconds
[0m14:40:46.628983 [debug] [ThreadPool]: On list_DBT: Close
[0m14:40:46.634764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m14:40:46.635763 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m14:40:46.635763 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m14:40:46.635763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:46.674056 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m14:40:46.675084 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m14:40:46.675084 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m14:40:46.681635 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.006 seconds
[0m14:40:46.681635 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m14:40:46.681635 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m14:40:46.689786 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:46.689786 [debug] [MainThread]: On master: BEGIN
[0m14:40:46.689786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:46.725447 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m14:40:46.726480 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:46.726480 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:40:46.733738 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m14:40:46.733738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40292923-eed8-4064-abef-35dcecf7f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D484A41AC0>]}
[0m14:40:46.733738 [debug] [MainThread]: On master: ROLLBACK
[0m14:40:46.733738 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:46.733738 [debug] [MainThread]: On master: BEGIN
[0m14:40:46.738111 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:40:46.738111 [debug] [MainThread]: On master: COMMIT
[0m14:40:46.738111 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:46.739138 [debug] [MainThread]: On master: COMMIT
[0m14:40:46.739843 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:40:46.739843 [debug] [MainThread]: On master: Close
[0m14:40:46.744509 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_reviews
[0m14:40:46.745821 [info ] [Thread-1 (]: 1 of 1 START snapshot raw.scd_raw_reviews ...................................... [RUN]
[0m14:40:46.779335 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbtlearn.scd_raw_reviews'
[0m14:40:46.779709 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_reviews
[0m14:40:46.794539 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_reviews
[0m14:40:46.861208 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbtlearn.scd_raw_reviews"
[0m14:40:46.861208 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_reviews: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_reviews"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select * FROM "DBT"."raw"."raw_reviews"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m14:40:46.861208 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:46.896628 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                  ^

[0m14:40:46.897655 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_reviews: Close
[0m14:40:46.903935 [debug] [Thread-1 (]: Database Error in snapshot scd_raw_reviews (snapshots\scd_raw_reviews.sql)
  column "id" does not exist
  LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                    ^
[0m14:40:46.906403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40292923-eed8-4064-abef-35dcecf7f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D483133080>]}
[0m14:40:46.907427 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting raw.scd_raw_reviews .................................. [[31mERROR[0m in 0.13s]
[0m14:40:46.907842 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_reviews
[0m14:40:46.908864 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbtlearn.scd_raw_reviews' to be skipped because of status 'error'.  Reason: Database Error in snapshot scd_raw_reviews (snapshots\scd_raw_reviews.sql)
  column "id" does not exist
  LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                    ^.
[0m14:40:46.910097 [info ] [MainThread]: 
[0m14:40:46.911094 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:46.911094 [debug] [MainThread]: On master: BEGIN
[0m14:40:46.912092 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:40:47.064792 [debug] [MainThread]: SQL status: BEGIN in 0.153 seconds
[0m14:40:47.065818 [debug] [MainThread]: On master: COMMIT
[0m14:40:47.066789 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:47.066789 [debug] [MainThread]: On master: COMMIT
[0m14:40:47.068081 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:40:47.076079 [info ] [MainThread]: ========== Begin Summary ==========
[0m14:40:47.083342 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:47.083342 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'snapshot.dbtlearn.scd_raw_reviews', 'snapshot',
'2025-02-02 13:40:45.301145+00:00',
'2025-02-02 13:40:46.781063',
'2025-02-02 13:40:46.897655'
,'error','0.12559866905212402',
'40292923-eed8-4064-abef-35dcecf7f1b1','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m14:40:47.105544 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.021 seconds
[0m14:40:47.107533 [info ] [MainThread]: 
     
[0m14:40:47.108555 [info ] [MainThread]: ========== End Summary ==========
[0m14:40:47.109553 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m14:40:47.111548 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m14:40:47.115328 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.05s]
[0m14:40:47.116327 [debug] [MainThread]: On master: Close
[0m14:40:47.117324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:47.118322 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m14:40:47.118322 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m14:40:47.119317 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_reviews' was properly closed.
[0m14:40:47.119317 [info ] [MainThread]: 
[0m14:40:47.121565 [info ] [MainThread]: Finished running 1 project hook, 1 snapshot in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m14:40:47.123560 [debug] [MainThread]: Command end result
[0m14:40:47.174489 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m14:40:47.177055 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m14:40:47.182748 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m14:40:47.183039 [info ] [MainThread]: 
[0m14:40:47.184037 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:40:47.184037 [info ] [MainThread]: 
[0m14:40:47.185034 [error] [MainThread]:   Database Error in snapshot scd_raw_reviews (snapshots\scd_raw_reviews.sql)
  column "id" does not exist
  LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                    ^
[0m14:40:47.186312 [info ] [MainThread]: 
[0m14:40:47.187234 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:40:47.188142 [debug] [MainThread]: Command `dbt snapshot` failed at 14:40:47.188142 after 1.99 seconds
[0m14:40:47.189140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FF6AD4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D482CCE030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D481CBCD40>]}
[0m14:40:47.189594 [debug] [MainThread]: Flushing usage events
[0m14:40:47.708976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:39:11.133708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F9798BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255FC29DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255FB697D10>]}


============================== 15:39:11.138726 | 644f0f28-4205-4525-a68d-3837d49f50e5 ==============================
[0m15:39:11.138726 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:39:11.139743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:39:11.438475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '644f0f28-4205-4525-a68d-3837d49f50e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255FC29D670>]}
[0m15:39:11.500556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '644f0f28-4205-4525-a68d-3837d49f50e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255FB8CB530>]}
[0m15:39:11.501742 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:39:11.914078 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:39:14.307084 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m15:39:14.308082 [debug] [MainThread]: Partial parsing: deleted file: dbtlearn://snapshots\scd_raw_reviews.sql
[0m15:39:14.462406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '644f0f28-4205-4525-a68d-3837d49f50e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255FC7CEE10>]}
[0m15:39:14.625213 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m15:39:14.639907 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m15:39:14.726632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '644f0f28-4205-4525-a68d-3837d49f50e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255FC4F5340>]}
[0m15:39:14.727369 [info ] [MainThread]: Found 8 models, 1 analysis, 22 data tests, 1 seed, 1 operation, 2 snapshots, 3 sources, 1 exposure, 814 macros
[0m15:39:14.728339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644f0f28-4205-4525-a68d-3837d49f50e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255FC52CC80>]}
[0m15:39:14.731330 [info ] [MainThread]: 
[0m15:39:14.732016 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:39:14.732937 [info ] [MainThread]: 
[0m15:39:14.733934 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:39:14.739282 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m15:39:18.437018 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m15:39:18.438009 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m15:39:18.439006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:18.480095 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m15:39:18.481071 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m15:39:18.481071 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:39:18.487892 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.006 seconds
[0m15:39:18.489887 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m15:39:18.489887 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m15:39:18.499747 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:18.500746 [debug] [MainThread]: On master: BEGIN
[0m15:39:18.500746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:18.533360 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m15:39:18.534095 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:18.534095 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:39:18.544307 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m15:39:18.545306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644f0f28-4205-4525-a68d-3837d49f50e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F9922B10>]}
[0m15:39:18.546303 [debug] [MainThread]: On master: ROLLBACK
[0m15:39:18.546755 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:18.546755 [debug] [MainThread]: On master: BEGIN
[0m15:39:18.547575 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:39:18.547575 [debug] [MainThread]: On master: COMMIT
[0m15:39:18.547575 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:18.548561 [debug] [MainThread]: On master: COMMIT
[0m15:39:18.549201 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:39:18.549557 [debug] [MainThread]: On master: Close
[0m15:39:18.551764 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m15:39:18.551764 [info ] [Thread-1 (]: 1 of 22 START test accepted_values_dim_hosts_cleansed_is_superhost__t__f ....... [RUN]
[0m15:39:18.552550 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4'
[0m15:39:18.553555 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m15:39:18.569475 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m15:39:18.571471 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m15:39:18.590451 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m15:39:18.591906 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m15:39:18.592413 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: BEGIN
[0m15:39:18.592413 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:39:18.628588 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:39:18.628588 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m15:39:18.628588 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_superhost as value_field,
        count(*) as n_records

    from "DBT"."raw"."dim_hosts_cleansed"
    group by is_superhost

)

select *
from all_values
where value_field not in (
    't','f'
)



      
    ) dbt_internal_test
[0m15:39:18.633575 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:39:18.637596 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: ROLLBACK
[0m15:39:18.638365 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: Close
[0m15:39:18.638365 [info ] [Thread-1 (]: 1 of 22 PASS accepted_values_dim_hosts_cleansed_is_superhost__t__f ............. [[32mPASS[0m in 0.09s]
[0m15:39:18.640395 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m15:39:18.640395 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:39:18.640395 [info ] [Thread-1 (]: 2 of 22 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m15:39:18.641625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4, now test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m15:39:18.642388 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:39:18.649338 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m15:39:18.650741 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:39:18.654073 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m15:39:18.655323 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m15:39:18.656322 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: BEGIN
[0m15:39:18.656322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:18.692809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:39:18.692809 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m15:39:18.693839 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from "DBT"."raw"."dim_listings_cleansed"
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m15:39:18.699830 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m15:39:18.700788 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: ROLLBACK
[0m15:39:18.702187 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m15:39:18.702187 [info ] [Thread-1 (]: 2 of 22 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.06s]
[0m15:39:18.704184 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:39:18.704184 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m15:39:18.705181 [info ] [Thread-1 (]: 3 of 22 START test accepted_values_fct_reviews_review_sentiment__positive__neutral__negative  [RUN]
[0m15:39:18.705751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef)
[0m15:39:18.706178 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m15:39:18.713160 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m15:39:18.715154 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m15:39:18.718146 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m15:39:18.719143 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m15:39:18.719143 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: BEGIN
[0m15:39:18.720141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:18.753053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m15:39:18.753053 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m15:39:18.754082 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        review_sentiment as value_field,
        count(*) as n_records

    from "DBT"."raw"."fct_reviews"
    group by review_sentiment

)

select *
from all_values
where value_field not in (
    'positive','neutral','negative'
)



      
    ) dbt_internal_test
[0m15:39:18.870056 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.116 seconds
[0m15:39:18.874046 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: ROLLBACK
[0m15:39:18.875014 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: Close
[0m15:39:18.876013 [info ] [Thread-1 (]: 3 of 22 PASS accepted_values_fct_reviews_review_sentiment__positive__neutral__negative  [[32mPASS[0m in 0.17s]
[0m15:39:18.878006 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m15:39:18.879036 [debug] [Thread-1 (]: Began running node test.dbtlearn.consistent_created_at
[0m15:39:18.880104 [info ] [Thread-1 (]: 4 of 22 START test consistent_created_at ....................................... [RUN]
[0m15:39:18.881436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef, now test.dbtlearn.consistent_created_at)
[0m15:39:18.882026 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.consistent_created_at
[0m15:39:18.889002 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m15:39:18.890602 [debug] [Thread-1 (]: Began executing node test.dbtlearn.consistent_created_at
[0m15:39:18.893989 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.consistent_created_at"
[0m15:39:18.895333 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.consistent_created_at"
[0m15:39:18.895957 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: BEGIN
[0m15:39:18.897005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:18.932916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:39:18.932916 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.consistent_created_at"
[0m15:39:18.933885 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * FROM "DBT"."raw"."dim_listings_cleansed" l
INNER JOIN "DBT"."raw"."fct_reviews" r
USING (listing_id)
WHERE l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m15:39:19.043941 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.109 seconds
[0m15:39:19.046931 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: ROLLBACK
[0m15:39:19.047930 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: Close
[0m15:39:19.048928 [info ] [Thread-1 (]: 4 of 22 PASS consistent_created_at ............................................. [[32mPASS[0m in 0.17s]
[0m15:39:19.051646 [debug] [Thread-1 (]: Finished running node test.dbtlearn.consistent_created_at
[0m15:39:19.052917 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m15:39:19.053914 [info ] [Thread-1 (]: 5 of 22 START test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [RUN]
[0m15:39:19.054957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.consistent_created_at, now test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75)
[0m15:39:19.055908 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m15:39:19.080839 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m15:39:19.081836 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m15:39:19.085249 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m15:39:19.086825 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m15:39:19.087825 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: BEGIN
[0m15:39:19.088033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:19.128459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m15:39:19.128459 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m15:39:19.129488 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  
( 1=1 and max(price) <= 5000
)
 as expression


    from "DBT"."raw"."dim_listings_w_hosts"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m15:39:19.130453 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.dim_listings_w_hosts" does not exist
LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                  ^

[0m15:39:19.130453 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: ROLLBACK
[0m15:39:19.131450 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: Close
[0m15:39:19.226487 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m15:39:19.226487 [error] [Thread-1 (]: 5 of 22 ERROR dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [[31mERROR[0m in 0.17s]
[0m15:39:19.227725 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m15:39:19.228488 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m15:39:19.229689 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql.
[0m15:39:19.228488 [info ] [Thread-1 (]: 6 of 22 START test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [RUN]
[0m15:39:19.230483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75, now test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970)
[0m15:39:19.231480 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m15:39:19.243537 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m15:39:19.244461 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m15:39:19.248403 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m15:39:19.250058 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m15:39:19.250398 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: BEGIN
[0m15:39:19.250398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:19.284693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m15:39:19.284693 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m15:39:19.285716 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and percentile_cont(0.99) within group (order by price) >= 50 and percentile_cont(0.99) within group (order by price) <= 500
)
 as expression


    from "DBT"."raw"."dim_listings_w_hosts"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m15:39:19.286687 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.dim_listings_w_hosts" does not exist
LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                  ^

[0m15:39:19.286687 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: ROLLBACK
[0m15:39:19.287725 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: Close
[0m15:39:19.290676 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_39596d790161761077ff1592b68943f6.sql
[0m15:39:19.290676 [error] [Thread-1 (]: 6 of 22 ERROR dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [[31mERROR[0m in 0.06s]
[0m15:39:19.291942 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m15:39:19.292697 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m15:39:19.293804 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_39596d790161761077ff1592b68943f6.sql.
[0m15:39:19.292697 [info ] [Thread-1 (]: 7 of 22 START test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [RUN]
[0m15:39:19.294674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970, now test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a)
[0m15:39:19.294674 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m15:39:19.323768 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m15:39:19.323768 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: BEGIN
[0m15:39:19.324774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:19.363387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m15:39:19.364182 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m15:39:19.364182 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'dim_listings_w_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m15:39:19.380106 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.015 seconds
[0m15:39:19.384792 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m15:39:19.386090 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m15:39:19.389082 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m15:39:19.390093 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m15:39:19.390093 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PRICE'
            and
            relation_column_type not in ('NUMBER')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m15:39:19.391077 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 10:     ),
             ^

[0m15:39:19.392074 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: ROLLBACK
[0m15:39:19.392074 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: Close
[0m15:39:19.396065 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number (models\schema.yml)
  syntax error at or near ")"
  LINE 10:     ),
               ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_07e7a515218ef6e3a17e164c642c7d18.sql
[0m15:39:19.397062 [error] [Thread-1 (]: 7 of 22 ERROR dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [[31mERROR[0m in 0.10s]
[0m15:39:19.398059 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m15:39:19.398059 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m15:39:19.399518 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number (models\schema.yml)
  syntax error at or near ")"
  LINE 10:     ),
               ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_07e7a515218ef6e3a17e164c642c7d18.sql.
[0m15:39:19.399056 [info ] [Thread-1 (]: 8 of 22 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m15:39:19.400054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a, now test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da)
[0m15:39:19.400054 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m15:39:19.423990 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m15:39:19.425638 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m15:39:19.427978 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m15:39:19.430977 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m15:39:19.430977 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: BEGIN
[0m15:39:19.431968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:19.620973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.189 seconds
[0m15:39:19.622004 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m15:39:19.622004 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        "DBT"."raw"."dim_listings_w_hosts"
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        "DBT"."raw"."raw_listings"
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m15:39:19.623966 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.dim_listings_w_hosts" does not exist
LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                 ^

[0m15:39:19.623966 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: ROLLBACK
[0m15:39:19.625386 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m15:39:19.629008 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_ (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                   ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_table__fbda7436ebe2ffe341acf0622c76d629.sql
[0m15:39:19.629950 [error] [Thread-1 (]: 8 of 22 ERROR dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[31mERROR[0m in 0.23s]
[0m15:39:19.630946 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m15:39:19.632046 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m15:39:19.632969 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_ (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                   ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_table__fbda7436ebe2ffe341acf0622c76d629.sql.
[0m15:39:19.632046 [info ] [Thread-1 (]: 9 of 22 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m15:39:19.633939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da, now test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65)
[0m15:39:19.633939 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m15:39:19.641951 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m15:39:19.642914 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m15:39:19.645907 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m15:39:19.647903 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m15:39:19.648898 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: BEGIN
[0m15:39:19.648898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:19.780694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.132 seconds
[0m15:39:19.781687 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m15:39:19.781687 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct room_type) = 4
 as expression


    from "DBT"."raw"."raw_listings"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m15:39:19.788667 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m15:39:19.789694 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: ROLLBACK
[0m15:39:19.790688 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: Close
[0m15:39:19.791662 [info ] [Thread-1 (]: 9 of 22 PASS dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[32mPASS[0m in 0.16s]
[0m15:39:19.793308 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m15:39:19.793654 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m15:39:19.793654 [info ] [Thread-1 (]: 10 of 22 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m15:39:19.794769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65, now test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9)
[0m15:39:19.795681 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m15:39:19.808652 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m15:39:19.809612 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m15:39:19.814634 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m15:39:19.816244 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m15:39:19.816593 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: BEGIN
[0m15:39:19.816593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:19.852498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:39:19.852498 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m15:39:19.853519 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(price, '^\\$[0-9][0-9\\.]+$', '')), 1), 0)


 > 0
 as expression


    from "DBT"."raw"."raw_listings"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





      
    ) dbt_internal_test
[0m15:39:19.863393 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m15:39:19.865415 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: ROLLBACK
[0m15:39:19.866386 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: Close
[0m15:39:19.867096 [error] [Thread-1 (]: 10 of 22 FAIL 17499 dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[31mFAIL 17499[0m in 0.07s]
[0m15:39:19.868407 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m15:39:19.868407 [debug] [Thread-1 (]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m15:39:19.869245 [info ] [Thread-1 (]: 11 of 22 START test dim_listings_minimum_nights ................................ [RUN]
[0m15:39:19.869378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9, now test.dbtlearn.dim_listings_minimum_nights)
[0m15:39:19.870401 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m15:39:19.953164 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m15:39:19.955149 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m15:39:19.958141 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dim_listings_minimum_nights"
[0m15:39:19.960138 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dim_listings_minimum_nights"
[0m15:39:19.962069 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: BEGIN
[0m15:39:19.962880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:20.110486 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m15:39:20.110486 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dim_listings_minimum_nights"
[0m15:39:20.111483 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM
    "DBT"."raw"."dim_listings_cleansed"
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m15:39:20.114474 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:39:20.116469 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: ROLLBACK
[0m15:39:20.116469 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m15:39:20.117467 [info ] [Thread-1 (]: 11 of 22 PASS dim_listings_minimum_nights ...................................... [[32mPASS[0m in 0.25s]
[0m15:39:20.118465 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m15:39:20.118465 [debug] [Thread-1 (]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m15:39:20.119462 [info ] [Thread-1 (]: 12 of 22 START test no_nulls_in_dim_listings ................................... [RUN]
[0m15:39:20.120459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dim_listings_minimum_nights, now test.dbtlearn.no_nulls_in_dim_listings)
[0m15:39:20.120459 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m15:39:20.127440 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m15:39:20.127440 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: BEGIN
[0m15:39:20.127440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:20.309966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.182 seconds
[0m15:39:20.310568 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m15:39:20.311568 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'dim_listings_cleansed'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m15:39:20.334813 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.023 seconds
[0m15:39:20.336778 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m15:39:20.337775 [debug] [Thread-1 (]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m15:39:20.340767 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m15:39:20.341765 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m15:39:20.342762 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM "DBT"."raw"."dim_listings_cleansed" WHERE
    listing_id IS NULL OR
    listing_name IS NULL OR
    room_type IS NULL OR
    minimum_nights IS NULL OR
    host_id IS NULL OR
    price_str IS NULL OR
    created_at IS NULL OR
    updated_at IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m15:39:20.347972 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m15:39:20.348971 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: ROLLBACK
[0m15:39:20.350321 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m15:39:20.350321 [info ] [Thread-1 (]: 12 of 22 PASS no_nulls_in_dim_listings ......................................... [[32mPASS[0m in 0.23s]
[0m15:39:20.352307 [debug] [Thread-1 (]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m15:39:20.352307 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m15:39:20.353304 [info ] [Thread-1 (]: 13 of 22 START test not_null_dim_hosts_cleansed_host_id ........................ [RUN]
[0m15:39:20.354301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.no_nulls_in_dim_listings, now test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05)
[0m15:39:20.354301 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m15:39:20.361284 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m15:39:20.362281 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m15:39:20.364827 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m15:39:20.365824 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m15:39:20.366839 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: BEGIN
[0m15:39:20.366839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:20.403721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:39:20.403721 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m15:39:20.404718 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from "DBT"."raw"."dim_hosts_cleansed"
where host_id is null



      
    ) dbt_internal_test
[0m15:39:20.407756 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:39:20.408739 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: ROLLBACK
[0m15:39:20.409907 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m15:39:20.410663 [info ] [Thread-1 (]: 13 of 22 PASS not_null_dim_hosts_cleansed_host_id .............................. [[32mPASS[0m in 0.06s]
[0m15:39:20.411906 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m15:39:20.412926 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m15:39:20.413899 [info ] [Thread-1 (]: 14 of 22 START test not_null_dim_hosts_cleansed_host_name ...................... [RUN]
[0m15:39:20.414988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05, now test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830)
[0m15:39:20.414988 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m15:39:20.422875 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m15:39:20.424878 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m15:39:20.428860 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m15:39:20.430855 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m15:39:20.431853 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: BEGIN
[0m15:39:20.432851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:20.485707 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m15:39:20.486730 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m15:39:20.486730 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_name
from "DBT"."raw"."dim_hosts_cleansed"
where host_name is null



      
    ) dbt_internal_test
[0m15:39:20.488221 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "host_name" does not exist
LINE 13: select host_name
                ^

[0m15:39:20.488731 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: ROLLBACK
[0m15:39:20.488731 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: Close
[0m15:39:20.491723 [debug] [Thread-1 (]: Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql
[0m15:39:20.492745 [error] [Thread-1 (]: 14 of 22 ERROR not_null_dim_hosts_cleansed_host_name ........................... [[31mERROR[0m in 0.08s]
[0m15:39:20.493717 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m15:39:20.493717 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:39:20.494683 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql.
[0m15:39:20.494683 [info ] [Thread-1 (]: 15 of 22 START test not_null_dim_listings_cleansed_host_id ..................... [RUN]
[0m15:39:20.495721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830, now test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m15:39:20.495721 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:39:20.500701 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m15:39:20.501665 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:39:20.503692 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m15:39:20.504688 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m15:39:20.505655 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: BEGIN
[0m15:39:20.505655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:20.668066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.162 seconds
[0m15:39:20.668066 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m15:39:20.669090 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from "DBT"."raw"."dim_listings_cleansed"
where host_id is null



      
    ) dbt_internal_test
[0m15:39:20.673722 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:39:20.675719 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: ROLLBACK
[0m15:39:20.676321 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m15:39:20.677240 [info ] [Thread-1 (]: 15 of 22 PASS not_null_dim_listings_cleansed_host_id ........................... [[32mPASS[0m in 0.18s]
[0m15:39:20.678236 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:39:20.678236 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:39:20.679233 [info ] [Thread-1 (]: 16 of 22 START test not_null_dim_listings_cleansed_listing_id .................. [RUN]
[0m15:39:20.680230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m15:39:20.680230 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:39:20.685248 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m15:39:20.686247 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:39:20.689238 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m15:39:20.690237 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m15:39:20.691303 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: BEGIN
[0m15:39:20.691303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:20.727104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:39:20.727104 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m15:39:20.728118 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from "DBT"."raw"."dim_listings_cleansed"
where listing_id is null



      
    ) dbt_internal_test
[0m15:39:20.732535 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:39:20.733535 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: ROLLBACK
[0m15:39:20.734906 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m15:39:20.734906 [info ] [Thread-1 (]: 16 of 22 PASS not_null_dim_listings_cleansed_listing_id ........................ [[32mPASS[0m in 0.05s]
[0m15:39:20.735796 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:39:20.736784 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m15:39:20.736784 [info ] [Thread-1 (]: 17 of 22 START test not_null_fct_reviews_reviewer_name ......................... [RUN]
[0m15:39:20.737938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88)
[0m15:39:20.737938 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m15:39:20.742805 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m15:39:20.744117 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m15:39:20.748785 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m15:39:20.749795 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m15:39:20.749795 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: BEGIN
[0m15:39:20.750780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:20.784453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m15:39:20.784453 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m15:39:20.785345 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reviewer_name
from "DBT"."raw"."fct_reviews"
where reviewer_name is null



      
    ) dbt_internal_test
[0m15:39:20.920405 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.135 seconds
[0m15:39:20.934927 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: ROLLBACK
[0m15:39:20.936323 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: Close
[0m15:39:20.937322 [info ] [Thread-1 (]: 17 of 22 PASS not_null_fct_reviews_reviewer_name ............................... [[32mPASS[0m in 0.20s]
[0m15:39:20.938322 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m15:39:20.939458 [debug] [Thread-1 (]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:39:20.939458 [info ] [Thread-1 (]: 18 of 22 START test positive_value_dim_listings_cleansed_minimum_nights ........ [RUN]
[0m15:39:20.940314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88, now test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313)
[0m15:39:20.941312 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:39:20.949291 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m15:39:20.951285 [debug] [Thread-1 (]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:39:20.953279 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m15:39:20.954277 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m15:39:20.955274 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: BEGIN
[0m15:39:20.956024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:20.992111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m15:39:20.993110 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m15:39:20.993110 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
    *
FROM
    "DBT"."raw"."dim_listings_cleansed"
WHERE
    minimum_nights < 1

      
    ) dbt_internal_test
[0m15:39:20.998281 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:39:21.000268 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: ROLLBACK
[0m15:39:21.000906 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m15:39:21.000906 [info ] [Thread-1 (]: 18 of 22 PASS positive_value_dim_listings_cleansed_minimum_nights .............. [[32mPASS[0m in 0.06s]
[0m15:39:21.002892 [debug] [Thread-1 (]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:39:21.002892 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:39:21.003891 [info ] [Thread-1 (]: 19 of 22 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m15:39:21.004512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313, now test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m15:39:21.004889 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:39:21.014862 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m15:39:21.015860 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:39:21.017853 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m15:39:21.018851 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m15:39:21.019850 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: BEGIN
[0m15:39:21.019850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:21.056763 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m15:39:21.057566 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m15:39:21.057566 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from "DBT"."raw"."dim_listings_cleansed"
    where host_id is not null
),

parent as (
    select host_id as to_field
    from "DBT"."raw"."dim_hosts_cleansed"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:39:21.066563 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m15:39:21.068604 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: ROLLBACK
[0m15:39:21.069556 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m15:39:21.069556 [info ] [Thread-1 (]: 19 of 22 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.07s]
[0m15:39:21.070553 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:39:21.071552 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m15:39:21.071552 [info ] [Thread-1 (]: 20 of 22 START test relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_  [RUN]
[0m15:39:21.072756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe)
[0m15:39:21.072756 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m15:39:21.079563 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m15:39:21.080558 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m15:39:21.083550 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m15:39:21.084516 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m15:39:21.085514 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: BEGIN
[0m15:39:21.086512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:21.121500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:39:21.121500 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m15:39:21.122534 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select listing_id as from_field
    from "DBT"."raw"."fct_reviews"
    where listing_id is not null
),

parent as (
    select listing_id as to_field
    from "DBT"."raw"."dim_listings_cleansed"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:39:21.231135 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.108 seconds
[0m15:39:21.235156 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: ROLLBACK
[0m15:39:21.236159 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: Close
[0m15:39:21.238116 [info ] [Thread-1 (]: 20 of 22 PASS relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_  [[32mPASS[0m in 0.16s]
[0m15:39:21.240143 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m15:39:21.241142 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m15:39:21.242140 [info ] [Thread-1 (]: 21 of 22 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m15:39:21.243104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe, now test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347)
[0m15:39:21.244133 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m15:39:21.254101 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m15:39:21.256254 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m15:39:21.264085 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m15:39:21.266056 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m15:39:21.266056 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: BEGIN
[0m15:39:21.267089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:21.300681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m15:39:21.300681 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m15:39:21.301710 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from "DBT"."raw"."dim_hosts_cleansed"
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:39:21.308690 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m15:39:21.311348 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: ROLLBACK
[0m15:39:21.311652 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m15:39:21.312705 [info ] [Thread-1 (]: 21 of 22 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 0.07s]
[0m15:39:21.313648 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m15:39:21.314806 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:39:21.314806 [info ] [Thread-1 (]: 22 of 22 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m15:39:21.315642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347, now test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m15:39:21.315642 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:39:21.321081 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m15:39:21.322625 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:39:21.325652 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m15:39:21.326646 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m15:39:21.327173 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: BEGIN
[0m15:39:21.327640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:21.361382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m15:39:21.361382 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m15:39:21.362384 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from "DBT"."raw"."dim_listings_cleansed"
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:39:21.370967 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m15:39:21.372962 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: ROLLBACK
[0m15:39:21.373530 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m15:39:21.373530 [info ] [Thread-1 (]: 22 of 22 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.06s]
[0m15:39:21.375519 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:39:21.376030 [info ] [MainThread]: 
[0m15:39:21.376952 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:21.376952 [debug] [MainThread]: On master: BEGIN
[0m15:39:21.377950 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:21.416921 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m15:39:21.416921 [debug] [MainThread]: On master: COMMIT
[0m15:39:21.417845 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:21.417845 [debug] [MainThread]: On master: COMMIT
[0m15:39:21.418759 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:39:21.428684 [info ] [MainThread]: ========== Begin Summary ==========
[0m15:39:21.432700 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:21.432700 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw_dbt_test__audit', 'test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4', 'test',
'2025-02-02 14:39:11.026750+00:00',
'2025-02-02 14:39:18.553555',
'2025-02-02 14:39:18.637596'
,'pass','0.08581423759460449',
'644f0f28-4205-4525-a68d-3837d49f50e5','1.9.1',CURRENT_TIMESTAMP(0),'1');
           
      
  
[0m15:39:21.433703 [debug] [MainThread]: Postgres adapter: Postgres error: value too long for type character varying(50)

[0m15:39:21.436690 [debug] [MainThread]: On master: Close
[0m15:39:21.446632 [info ] [MainThread]: 
[0m15:39:21.448634 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m15:39:21.449657 [info ] [MainThread]: 
[0m15:39:21.450621 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m15:39:21.451617 [info ] [MainThread]: 
[0m15:39:21.452620 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_39596d790161761077ff1592b68943f6.sql
[0m15:39:21.453612 [info ] [MainThread]: 
[0m15:39:21.454610 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number (models\schema.yml)
  syntax error at or near ")"
  LINE 10:     ),
               ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_07e7a515218ef6e3a17e164c642c7d18.sql
[0m15:39:21.455609 [info ] [MainThread]: 
[0m15:39:21.455609 [error] [MainThread]:   Database Error in test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_ (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                   ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_table__fbda7436ebe2ffe341acf0622c76d629.sql
[0m15:39:21.456607 [info ] [MainThread]: 
[0m15:39:21.457601 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models\sources.yml)[0m
[0m15:39:21.458624 [error] [MainThread]:   Got 17499 results, configured to fail if != 0
[0m15:39:21.459622 [info ] [MainThread]: 
[0m15:39:21.460595 [info ] [MainThread]:   compiled code at target\compiled\dbtlearn\models\sources.yml\dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb.sql
[0m15:39:21.461592 [info ] [MainThread]: 
[0m15:39:21.462595 [error] [MainThread]:   Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql
[0m15:39:21.463779 [info ] [MainThread]: 
[0m15:39:21.464611 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=6 SKIP=0 TOTAL=22
[0m15:39:21.466580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:21.466580 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m15:39:21.467797 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m15:39:21.467797 [info ] [MainThread]: 
[0m15:39:21.469181 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 6.73 seconds (6.73s).
[0m15:39:21.469570 [error] [MainThread]: Encountered an error:
Database Error
  value too long for type character varying(50)
[0m15:39:21.471589 [debug] [MainThread]: Command `dbt test` failed at 15:39:21.471589 after 10.56 seconds
[0m15:39:21.471589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F8E9E3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255FE4FF290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255FDD23560>]}
[0m15:39:21.472586 [debug] [MainThread]: Flushing usage events
[0m15:39:22.007059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:10.370904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021610109310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021610109220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216101091F0>]}


============================== 20:54:10.377186 | 5831d32f-88a1-4734-a436-f9727bce83d2 ==============================
[0m20:54:10.377186 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:54:10.378155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:54:10.625148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5831d32f-88a1-4734-a436-f9727bce83d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216124908F0>]}
[0m20:54:10.695042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5831d32f-88a1-4734-a436-f9727bce83d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002160F792690>]}
[0m20:54:10.697042 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:54:10.922622 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:54:11.289654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:54:11.289654 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:54:11.389192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5831d32f-88a1-4734-a436-f9727bce83d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216124D8080>]}
[0m20:54:11.561144 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m20:54:11.564951 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m20:54:11.612693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5831d32f-88a1-4734-a436-f9727bce83d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021613CBAAB0>]}
[0m20:54:11.612693 [info ] [MainThread]: Found 8 models, 1 analysis, 22 data tests, 1 seed, 1 operation, 2 snapshots, 3 sources, 1 exposure, 814 macros
[0m20:54:11.613950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5831d32f-88a1-4734-a436-f9727bce83d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216127349E0>]}
[0m20:54:11.616790 [info ] [MainThread]: 
[0m20:54:11.617757 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:11.617757 [info ] [MainThread]: 
[0m20:54:11.618819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:54:11.624046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m20:54:11.715527 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m20:54:11.716526 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m20:54:11.717098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:11.758734 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m20:54:11.758734 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m20:54:11.759731 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:54:11.767737 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.008 seconds
[0m20:54:11.769734 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m20:54:11.770728 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m20:54:11.783693 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:11.783693 [debug] [MainThread]: On master: BEGIN
[0m20:54:11.784691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:11.981523 [debug] [MainThread]: SQL status: BEGIN in 0.197 seconds
[0m20:54:11.981523 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:11.982550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:54:11.998532 [debug] [MainThread]: SQL status: SELECT 3 in 0.014 seconds
[0m20:54:12.000527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5831d32f-88a1-4734-a436-f9727bce83d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021612586960>]}
[0m20:54:12.001524 [debug] [MainThread]: On master: ROLLBACK
[0m20:54:12.002225 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:12.002225 [debug] [MainThread]: On master: BEGIN
[0m20:54:12.003797 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:54:12.004252 [debug] [MainThread]: On master: COMMIT
[0m20:54:12.005250 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:12.005250 [debug] [MainThread]: On master: COMMIT
[0m20:54:12.006739 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:54:12.007215 [debug] [MainThread]: On master: Close
[0m20:54:12.010211 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m20:54:12.011208 [info ] [Thread-1 (]: 1 of 22 START test accepted_values_dim_hosts_cleansed_is_superhost__t__f ....... [RUN]
[0m20:54:12.012891 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4'
[0m20:54:12.013734 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m20:54:12.043632 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m20:54:12.044825 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m20:54:12.062605 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m20:54:12.064153 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m20:54:12.064568 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: BEGIN
[0m20:54:12.064568 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:54:12.099978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m20:54:12.100869 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m20:54:12.100869 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_superhost as value_field,
        count(*) as n_records

    from "DBT"."raw"."dim_hosts_cleansed"
    group by is_superhost

)

select *
from all_values
where value_field not in (
    't','f'
)



      
    ) dbt_internal_test
[0m20:54:12.105519 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m20:54:12.109511 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: ROLLBACK
[0m20:54:12.110419 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: Close
[0m20:54:12.110419 [info ] [Thread-1 (]: 1 of 22 PASS accepted_values_dim_hosts_cleansed_is_superhost__t__f ............. [[32mPASS[0m in 0.10s]
[0m20:54:12.112409 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m20:54:12.112409 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m20:54:12.112409 [info ] [Thread-1 (]: 2 of 22 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m20:54:12.113718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4, now test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m20:54:12.114613 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m20:54:12.132535 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m20:54:12.135530 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m20:54:12.143548 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m20:54:12.145500 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m20:54:12.146526 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: BEGIN
[0m20:54:12.146526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:12.207394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m20:54:12.208372 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m20:54:12.210370 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from "DBT"."raw"."dim_listings_cleansed"
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m20:54:12.221475 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:54:12.225330 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: ROLLBACK
[0m20:54:12.226433 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m20:54:12.228281 [info ] [Thread-1 (]: 2 of 22 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.11s]
[0m20:54:12.230274 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m20:54:12.231946 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m20:54:12.233094 [info ] [Thread-1 (]: 3 of 22 START test accepted_values_fct_reviews_review_sentiment__positive__neutral__negative  [RUN]
[0m20:54:12.235321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef)
[0m20:54:12.236349 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m20:54:12.252317 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m20:54:12.255278 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m20:54:12.265239 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m20:54:12.268231 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m20:54:12.269524 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: BEGIN
[0m20:54:12.270228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:12.330587 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m20:54:12.331315 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"
[0m20:54:12.331315 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        review_sentiment as value_field,
        count(*) as n_records

    from "DBT"."raw"."fct_reviews"
    group by review_sentiment

)

select *
from all_values
where value_field not in (
    'positive','neutral','negative'
)



      
    ) dbt_internal_test
[0m20:54:12.452930 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.120 seconds
[0m20:54:12.456919 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: ROLLBACK
[0m20:54:12.457875 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef: Close
[0m20:54:12.459627 [info ] [Thread-1 (]: 3 of 22 PASS accepted_values_fct_reviews_review_sentiment__positive__neutral__negative  [[32mPASS[0m in 0.22s]
[0m20:54:12.461862 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef
[0m20:54:12.462858 [debug] [Thread-1 (]: Began running node test.dbtlearn.consistent_created_at
[0m20:54:12.463856 [info ] [Thread-1 (]: 4 of 22 START test consistent_created_at ....................................... [RUN]
[0m20:54:12.466211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef, now test.dbtlearn.consistent_created_at)
[0m20:54:12.466854 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.consistent_created_at
[0m20:54:12.475828 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m20:54:12.477910 [debug] [Thread-1 (]: Began executing node test.dbtlearn.consistent_created_at
[0m20:54:12.481810 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.consistent_created_at"
[0m20:54:12.483803 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.consistent_created_at"
[0m20:54:12.483803 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: BEGIN
[0m20:54:12.484803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:12.539327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m20:54:12.540318 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.consistent_created_at"
[0m20:54:12.540318 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * FROM "DBT"."raw"."dim_listings_cleansed" l
INNER JOIN "DBT"."raw"."fct_reviews" r
USING (listing_id)
WHERE l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m20:54:12.717601 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.176 seconds
[0m20:54:12.720769 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: ROLLBACK
[0m20:54:12.721738 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: Close
[0m20:54:12.722588 [info ] [Thread-1 (]: 4 of 22 PASS consistent_created_at ............................................. [[32mPASS[0m in 0.26s]
[0m20:54:12.725582 [debug] [Thread-1 (]: Finished running node test.dbtlearn.consistent_created_at
[0m20:54:12.726577 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m20:54:12.727575 [info ] [Thread-1 (]: 5 of 22 START test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [RUN]
[0m20:54:12.728575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.consistent_created_at, now test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75)
[0m20:54:12.729569 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m20:54:12.772459 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m20:54:12.775449 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m20:54:12.780433 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m20:54:12.782428 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m20:54:12.784423 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: BEGIN
[0m20:54:12.784423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:12.837338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m20:54:12.838337 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m20:54:12.838337 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  
( 1=1 and max(price) <= 5000
)
 as expression


    from "DBT"."raw"."dim_listings_w_hosts"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m20:54:12.839333 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.dim_listings_w_hosts" does not exist
LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                  ^

[0m20:54:12.839333 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: ROLLBACK
[0m20:54:12.840332 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: Close
[0m20:54:12.846315 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m20:54:12.847312 [error] [Thread-1 (]: 5 of 22 ERROR dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [[31mERROR[0m in 0.12s]
[0m20:54:12.848309 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m20:54:12.849307 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m20:54:12.849307 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql.
[0m20:54:12.850303 [info ] [Thread-1 (]: 6 of 22 START test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [RUN]
[0m20:54:12.851301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75, now test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970)
[0m20:54:12.852298 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m20:54:12.865264 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m20:54:12.867260 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m20:54:12.872247 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m20:54:12.874241 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m20:54:12.874241 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: BEGIN
[0m20:54:12.875239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:12.925105 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m20:54:12.926102 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m20:54:12.927105 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and percentile_cont(0.99) within group (order by price) >= 50 and percentile_cont(0.99) within group (order by price) <= 500
)
 as expression


    from "DBT"."raw"."dim_listings_w_hosts"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m20:54:12.928096 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.dim_listings_w_hosts" does not exist
LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                  ^

[0m20:54:12.929093 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: ROLLBACK
[0m20:54:12.929093 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: Close
[0m20:54:12.933082 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_39596d790161761077ff1592b68943f6.sql
[0m20:54:12.934080 [error] [Thread-1 (]: 6 of 22 ERROR dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [[31mERROR[0m in 0.08s]
[0m20:54:12.935077 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m20:54:12.935077 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m20:54:12.936075 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_39596d790161761077ff1592b68943f6.sql.
[0m20:54:12.936075 [info ] [Thread-1 (]: 7 of 22 START test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [RUN]
[0m20:54:12.937072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970, now test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a)
[0m20:54:12.938069 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m20:54:12.967990 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m20:54:12.968699 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: BEGIN
[0m20:54:12.968987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:13.005889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m20:54:13.005889 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m20:54:13.006885 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'dim_listings_w_hosts'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:54:13.022842 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.016 seconds
[0m20:54:13.026833 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m20:54:13.027830 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m20:54:13.031820 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m20:54:13.032849 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m20:54:13.032849 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PRICE'
            and
            relation_column_type not in ('NUMBER')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m20:54:13.033911 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 10:     ),
             ^

[0m20:54:13.033911 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: ROLLBACK
[0m20:54:13.034842 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: Close
[0m20:54:13.037834 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number (models\schema.yml)
  syntax error at or near ")"
  LINE 10:     ),
               ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_07e7a515218ef6e3a17e164c642c7d18.sql
[0m20:54:13.038830 [error] [Thread-1 (]: 7 of 22 ERROR dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [[31mERROR[0m in 0.10s]
[0m20:54:13.039797 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m20:54:13.039797 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m20:54:13.040826 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number (models\schema.yml)
  syntax error at or near ")"
  LINE 10:     ),
               ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_07e7a515218ef6e3a17e164c642c7d18.sql.
[0m20:54:13.040826 [info ] [Thread-1 (]: 8 of 22 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m20:54:13.041792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a, now test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da)
[0m20:54:13.041792 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m20:54:13.064761 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m20:54:13.065760 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m20:54:13.068751 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m20:54:13.069931 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m20:54:13.070717 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: BEGIN
[0m20:54:13.071732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:13.298307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.227 seconds
[0m20:54:13.300649 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m20:54:13.302293 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        "DBT"."raw"."dim_listings_w_hosts"
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        "DBT"."raw"."raw_listings"
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m20:54:13.306328 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.dim_listings_w_hosts" does not exist
LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                 ^

[0m20:54:13.308499 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: ROLLBACK
[0m20:54:13.311276 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m20:54:13.324239 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_ (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                   ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_table__fbda7436ebe2ffe341acf0622c76d629.sql
[0m20:54:13.327236 [error] [Thread-1 (]: 8 of 22 ERROR dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[31mERROR[0m in 0.28s]
[0m20:54:13.332259 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m20:54:13.334208 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m20:54:13.337201 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_ (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                   ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_table__fbda7436ebe2ffe341acf0622c76d629.sql.
[0m20:54:13.340194 [info ] [Thread-1 (]: 9 of 22 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m20:54:13.347175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da, now test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65)
[0m20:54:13.350168 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m20:54:13.409844 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m20:54:13.411818 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m20:54:13.417802 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m20:54:13.419796 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m20:54:13.421791 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: BEGIN
[0m20:54:13.422791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:13.474894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m20:54:13.475486 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m20:54:13.476484 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct room_type) = 4
 as expression


    from "DBT"."raw"."raw_listings"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m20:54:13.487455 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:54:13.489449 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: ROLLBACK
[0m20:54:13.490716 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: Close
[0m20:54:13.491414 [info ] [Thread-1 (]: 9 of 22 PASS dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[32mPASS[0m in 0.15s]
[0m20:54:13.493410 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m20:54:13.494435 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m20:54:13.495404 [info ] [Thread-1 (]: 10 of 22 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m20:54:13.496400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65, now test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9)
[0m20:54:13.497398 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m20:54:13.526322 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m20:54:13.528316 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m20:54:13.534331 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m20:54:13.536295 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m20:54:13.537293 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: BEGIN
[0m20:54:13.539287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:13.612848 [debug] [Thread-1 (]: SQL status: BEGIN in 0.074 seconds
[0m20:54:13.614885 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m20:54:13.615881 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(price, '^\\$[0-9][0-9\\.]+$', '')), 1), 0)


 > 0
 as expression


    from "DBT"."raw"."raw_listings"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





      
    ) dbt_internal_test
[0m20:54:13.639965 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.024 seconds
[0m20:54:13.643989 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: ROLLBACK
[0m20:54:13.645990 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: Close
[0m20:54:13.646984 [error] [Thread-1 (]: 10 of 22 FAIL 17499 dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[31mFAIL 17499[0m in 0.15s]
[0m20:54:13.649985 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m20:54:13.651356 [debug] [Thread-1 (]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m20:54:13.651976 [info ] [Thread-1 (]: 11 of 22 START test dim_listings_minimum_nights ................................ [RUN]
[0m20:54:13.653961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9, now test.dbtlearn.dim_listings_minimum_nights)
[0m20:54:13.656160 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m20:54:13.665949 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m20:54:13.667936 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m20:54:13.675910 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dim_listings_minimum_nights"
[0m20:54:13.676907 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dim_listings_minimum_nights"
[0m20:54:13.677865 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: BEGIN
[0m20:54:13.678893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:13.890973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.212 seconds
[0m20:54:13.890973 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dim_listings_minimum_nights"
[0m20:54:13.891973 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM
    "DBT"."raw"."dim_listings_cleansed"
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m20:54:13.899919 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m20:54:13.903953 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: ROLLBACK
[0m20:54:13.905432 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m20:54:13.906902 [info ] [Thread-1 (]: 11 of 22 PASS dim_listings_minimum_nights ...................................... [[32mPASS[0m in 0.25s]
[0m20:54:13.908937 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m20:54:13.909934 [debug] [Thread-1 (]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m20:54:13.910932 [info ] [Thread-1 (]: 12 of 22 START test no_nulls_in_dim_listings ................................... [RUN]
[0m20:54:13.911889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dim_listings_minimum_nights, now test.dbtlearn.no_nulls_in_dim_listings)
[0m20:54:13.912923 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m20:54:13.922857 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m20:54:13.923856 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: BEGIN
[0m20:54:13.923856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:13.959761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m20:54:13.960641 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m20:54:13.960641 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'dim_listings_cleansed'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:54:13.978420 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.017 seconds
[0m20:54:13.980447 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m20:54:13.981413 [debug] [Thread-1 (]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m20:54:13.984438 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m20:54:13.985402 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m20:54:13.985960 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM "DBT"."raw"."dim_listings_cleansed" WHERE
    listing_id IS NULL OR
    listing_name IS NULL OR
    room_type IS NULL OR
    minimum_nights IS NULL OR
    host_id IS NULL OR
    price_str IS NULL OR
    created_at IS NULL OR
    updated_at IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m20:54:13.991418 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m20:54:13.992417 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: ROLLBACK
[0m20:54:13.993781 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m20:54:13.993781 [info ] [Thread-1 (]: 12 of 22 PASS no_nulls_in_dim_listings ......................................... [[32mPASS[0m in 0.08s]
[0m20:54:13.995810 [debug] [Thread-1 (]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m20:54:13.995810 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m20:54:13.996842 [info ] [Thread-1 (]: 13 of 22 START test not_null_dim_hosts_cleansed_host_id ........................ [RUN]
[0m20:54:13.996842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.no_nulls_in_dim_listings, now test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05)
[0m20:54:13.997772 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m20:54:14.005751 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m20:54:14.006748 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m20:54:14.080597 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m20:54:14.082553 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m20:54:14.083543 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: BEGIN
[0m20:54:14.084543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:14.134338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m20:54:14.135356 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m20:54:14.135356 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from "DBT"."raw"."dim_hosts_cleansed"
where host_id is null



      
    ) dbt_internal_test
[0m20:54:14.139318 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:54:14.141341 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: ROLLBACK
[0m20:54:14.142344 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m20:54:14.143515 [info ] [Thread-1 (]: 13 of 22 PASS not_null_dim_hosts_cleansed_host_id .............................. [[32mPASS[0m in 0.15s]
[0m20:54:14.144305 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m20:54:14.145325 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m20:54:14.145913 [info ] [Thread-1 (]: 14 of 22 START test not_null_dim_hosts_cleansed_host_name ...................... [RUN]
[0m20:54:14.146327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05, now test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830)
[0m20:54:14.147327 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m20:54:14.153496 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m20:54:14.154280 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m20:54:14.160264 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m20:54:14.161291 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m20:54:14.162287 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: BEGIN
[0m20:54:14.162287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:14.214786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m20:54:14.215817 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m20:54:14.215817 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_name
from "DBT"."raw"."dim_hosts_cleansed"
where host_name is null



      
    ) dbt_internal_test
[0m20:54:14.217779 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "host_name" does not exist
LINE 13: select host_name
                ^

[0m20:54:14.217779 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: ROLLBACK
[0m20:54:14.219802 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830: Close
[0m20:54:14.224788 [debug] [Thread-1 (]: Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql
[0m20:54:14.225757 [error] [Thread-1 (]: 14 of 22 ERROR not_null_dim_hosts_cleansed_host_name ........................... [[31mERROR[0m in 0.08s]
[0m20:54:14.227997 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m20:54:14.227997 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:54:14.229963 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql.
[0m20:54:14.229259 [info ] [Thread-1 (]: 15 of 22 START test not_null_dim_listings_cleansed_host_id ..................... [RUN]
[0m20:54:14.230989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830, now test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m20:54:14.231958 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:54:14.238969 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m20:54:14.239967 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:54:14.243954 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m20:54:14.244952 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m20:54:14.245920 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: BEGIN
[0m20:54:14.246918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:14.288806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m20:54:14.289803 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m20:54:14.289803 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from "DBT"."raw"."dim_listings_cleansed"
where host_id is null



      
    ) dbt_internal_test
[0m20:54:14.294177 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m20:54:14.296171 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: ROLLBACK
[0m20:54:14.297540 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m20:54:14.298415 [info ] [Thread-1 (]: 15 of 22 PASS not_null_dim_listings_cleansed_host_id ........................... [[32mPASS[0m in 0.07s]
[0m20:54:14.299411 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:54:14.299411 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:54:14.300678 [info ] [Thread-1 (]: 16 of 22 START test not_null_dim_listings_cleansed_listing_id .................. [RUN]
[0m20:54:14.301406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m20:54:14.301406 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:54:14.306420 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m20:54:14.308431 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:54:14.312376 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m20:54:14.314720 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m20:54:14.315405 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: BEGIN
[0m20:54:14.315405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:14.357923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m20:54:14.358950 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m20:54:14.358950 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from "DBT"."raw"."dim_listings_cleansed"
where listing_id is null



      
    ) dbt_internal_test
[0m20:54:14.362944 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:54:14.364904 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: ROLLBACK
[0m20:54:14.365550 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m20:54:14.365550 [info ] [Thread-1 (]: 16 of 22 PASS not_null_dim_listings_cleansed_listing_id ........................ [[32mPASS[0m in 0.06s]
[0m20:54:14.367525 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:54:14.367525 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m20:54:14.368524 [info ] [Thread-1 (]: 17 of 22 START test not_null_fct_reviews_reviewer_name ......................... [RUN]
[0m20:54:14.369519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88)
[0m20:54:14.369519 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m20:54:14.377531 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m20:54:14.378525 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m20:54:14.381521 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m20:54:14.382519 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m20:54:14.383512 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: BEGIN
[0m20:54:14.383512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:14.424056 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m20:54:14.425081 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m20:54:14.425081 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reviewer_name
from "DBT"."raw"."fct_reviews"
where reviewer_name is null



      
    ) dbt_internal_test
[0m20:54:14.515199 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.089 seconds
[0m20:54:14.518191 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: ROLLBACK
[0m20:54:14.519914 [debug] [Thread-1 (]: On test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88: Close
[0m20:54:14.521762 [info ] [Thread-1 (]: 17 of 22 PASS not_null_fct_reviews_reviewer_name ............................... [[32mPASS[0m in 0.15s]
[0m20:54:14.523755 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88
[0m20:54:14.524752 [debug] [Thread-1 (]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m20:54:14.526782 [info ] [Thread-1 (]: 18 of 22 START test positive_value_dim_listings_cleansed_minimum_nights ........ [RUN]
[0m20:54:14.529739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88, now test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313)
[0m20:54:14.531252 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m20:54:14.543732 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m20:54:14.545751 [debug] [Thread-1 (]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m20:54:14.549713 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m20:54:14.550711 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m20:54:14.551679 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: BEGIN
[0m20:54:14.552086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:14.592652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m20:54:14.593540 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m20:54:14.593540 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
    *
FROM
    "DBT"."raw"."dim_listings_cleansed"
WHERE
    minimum_nights < 1

      
    ) dbt_internal_test
[0m20:54:14.597859 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:54:14.598859 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: ROLLBACK
[0m20:54:14.600274 [debug] [Thread-1 (]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m20:54:14.600274 [info ] [Thread-1 (]: 18 of 22 PASS positive_value_dim_listings_cleansed_minimum_nights .............. [[32mPASS[0m in 0.07s]
[0m20:54:14.602262 [debug] [Thread-1 (]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m20:54:14.602262 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:54:14.603259 [info ] [Thread-1 (]: 19 of 22 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m20:54:14.604254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313, now test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m20:54:14.604254 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:54:14.613230 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m20:54:14.614929 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:54:14.617220 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m20:54:14.619216 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m20:54:14.620445 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: BEGIN
[0m20:54:14.620445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:14.659626 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m20:54:14.660660 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m20:54:14.660660 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from "DBT"."raw"."dim_listings_cleansed"
    where host_id is not null
),

parent as (
    select host_id as to_field
    from "DBT"."raw"."dim_hosts_cleansed"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:54:14.670598 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m20:54:14.674923 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: ROLLBACK
[0m20:54:14.675584 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m20:54:14.677589 [info ] [Thread-1 (]: 19 of 22 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.07s]
[0m20:54:14.679946 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:54:14.681584 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m20:54:14.682709 [info ] [Thread-1 (]: 20 of 22 START test relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_  [RUN]
[0m20:54:14.684561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe)
[0m20:54:14.684561 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m20:54:14.698550 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m20:54:14.699521 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m20:54:14.704507 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m20:54:14.709674 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m20:54:14.710520 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: BEGIN
[0m20:54:14.711518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:14.760357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m20:54:14.761388 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m20:54:14.761388 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select listing_id as from_field
    from "DBT"."raw"."fct_reviews"
    where listing_id is not null
),

parent as (
    select listing_id as to_field
    from "DBT"."raw"."dim_listings_cleansed"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:54:14.918932 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.157 seconds
[0m20:54:14.921955 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: ROLLBACK
[0m20:54:14.922723 [debug] [Thread-1 (]: On test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: Close
[0m20:54:14.922955 [info ] [Thread-1 (]: 20 of 22 PASS relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_  [[32mPASS[0m in 0.24s]
[0m20:54:14.924914 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m20:54:14.924914 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m20:54:14.925913 [info ] [Thread-1 (]: 21 of 22 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m20:54:14.926909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe, now test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347)
[0m20:54:14.926909 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m20:54:14.937880 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m20:54:14.938878 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m20:54:14.943040 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m20:54:14.944861 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m20:54:14.944861 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: BEGIN
[0m20:54:14.945858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:14.989785 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m20:54:14.989785 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m20:54:14.990739 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from "DBT"."raw"."dim_hosts_cleansed"
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:54:14.999188 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m20:54:15.001182 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: ROLLBACK
[0m20:54:15.002452 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m20:54:15.003336 [info ] [Thread-1 (]: 21 of 22 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 0.08s]
[0m20:54:15.005381 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m20:54:15.006328 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:54:15.006328 [info ] [Thread-1 (]: 22 of 22 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m20:54:15.007393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347, now test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m20:54:15.008349 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:54:15.013341 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m20:54:15.014745 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:54:15.018326 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m20:54:15.019372 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m20:54:15.019372 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: BEGIN
[0m20:54:15.020291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:15.204294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.183 seconds
[0m20:54:15.204294 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m20:54:15.205291 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from "DBT"."raw"."dim_listings_cleansed"
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:54:15.219176 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m20:54:15.223208 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: ROLLBACK
[0m20:54:15.224246 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m20:54:15.225160 [info ] [Thread-1 (]: 22 of 22 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.22s]
[0m20:54:15.227157 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:54:15.229180 [info ] [MainThread]: 
[0m20:54:15.230189 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:15.231174 [debug] [MainThread]: On master: BEGIN
[0m20:54:15.231174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:15.298998 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m20:54:15.299963 [debug] [MainThread]: On master: COMMIT
[0m20:54:15.300962 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:15.300962 [debug] [MainThread]: On master: COMMIT
[0m20:54:15.301958 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:54:15.315917 [info ] [MainThread]: ========== Begin Summary ==========
[0m20:54:15.318942 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:15.319907 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw_dbt_test__audit', 'test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4', 'test',
'2025-02-02 19:54:10.222478+00:00',
'2025-02-02 19:54:12.014731',
'2025-02-02 19:54:12.109511'
,'pass','0.09752917289733887',
'5831d32f-88a1-4734-a436-f9727bce83d2','1.9.1',CURRENT_TIMESTAMP(0),'1');
           
      
  
[0m20:54:15.321902 [debug] [MainThread]: Postgres adapter: Postgres error: value too long for type character varying(50)

[0m20:54:15.324894 [debug] [MainThread]: On master: Close
[0m20:54:15.333869 [info ] [MainThread]: 
[0m20:54:15.334867 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m20:54:15.335865 [info ] [MainThread]: 
[0m20:54:15.336861 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 23:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m20:54:15.338863 [info ] [MainThread]: 
[0m20:54:15.339855 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99 (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 24:     from "DBT"."raw"."dim_listings_w_hosts"
                    ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_39596d790161761077ff1592b68943f6.sql
[0m20:54:15.342883 [info ] [MainThread]: 
[0m20:54:15.342883 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number (models\schema.yml)
  syntax error at or near ")"
  LINE 10:     ),
               ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_column_07e7a515218ef6e3a17e164c642c7d18.sql
[0m20:54:15.344842 [info ] [MainThread]: 
[0m20:54:15.345840 [error] [MainThread]:   Database Error in test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_ (models\schema.yml)
  relation "raw.dim_listings_w_hosts" does not exist
  LINE 14:         "DBT"."raw"."dim_listings_w_hosts"
                   ^
  compiled code at target\run\dbtlearn\models\schema.yml\dbt_expectations_expect_table__fbda7436ebe2ffe341acf0622c76d629.sql
[0m20:54:15.347833 [info ] [MainThread]: 
[0m20:54:15.348832 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models\sources.yml)[0m
[0m20:54:15.350133 [error] [MainThread]:   Got 17499 results, configured to fail if != 0
[0m20:54:15.350826 [info ] [MainThread]: 
[0m20:54:15.351823 [info ] [MainThread]:   compiled code at target\compiled\dbtlearn\models\sources.yml\dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb.sql
[0m20:54:15.352819 [info ] [MainThread]: 
[0m20:54:15.353818 [error] [MainThread]:   Database Error in test not_null_dim_hosts_cleansed_host_name (models\schema.yml)
  column "host_name" does not exist
  LINE 13: select host_name
                  ^
  compiled code at target\run\dbtlearn\models\schema.yml\not_null_dim_hosts_cleansed_host_name.sql
[0m20:54:15.355813 [info ] [MainThread]: 
[0m20:54:15.356811 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=6 SKIP=0 TOTAL=22
[0m20:54:15.357808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:15.357808 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m20:54:15.358805 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m20:54:15.358805 [info ] [MainThread]: 
[0m20:54:15.360099 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m20:54:15.360798 [error] [MainThread]: Encountered an error:
Database Error
  value too long for type character varying(50)
[0m20:54:15.362823 [debug] [MainThread]: Command `dbt test` failed at 20:54:15.362823 after 5.25 seconds
[0m20:54:15.363817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021611EAF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216142EB260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216141CD4F0>]}
[0m20:54:15.364333 [debug] [MainThread]: Flushing usage events
[0m20:54:16.289514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:50.895452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E82284170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EFF72C860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EFF72C8C0>]}


============================== 20:56:50.901434 | 4eac666d-0248-4118-b683-3a877019842e ==============================
[0m20:56:50.901434 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:56:50.902273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:56:51.121046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eac666d-0248-4118-b683-3a877019842e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E8263BE30>]}
[0m20:56:51.184209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eac666d-0248-4118-b683-3a877019842e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E81990710>]}
[0m20:56:51.185296 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:56:51.417243 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:56:51.777688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:56:51.778686 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models\schema.yml
[0m20:56:52.348521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eac666d-0248-4118-b683-3a877019842e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E83DA4E90>]}
[0m20:56:52.512760 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m20:56:52.516474 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m20:56:52.562536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eac666d-0248-4118-b683-3a877019842e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E84360860>]}
[0m20:56:52.562961 [info ] [MainThread]: Found 8 models, 1 analysis, 9 data tests, 1 seed, 1 operation, 2 snapshots, 3 sources, 1 exposure, 814 macros
[0m20:56:52.563566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eac666d-0248-4118-b683-3a877019842e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E826C2EA0>]}
[0m20:56:52.566527 [info ] [MainThread]: 
[0m20:56:52.567093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:52.567093 [info ] [MainThread]: 
[0m20:56:52.567977 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:56:52.572984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m20:56:52.663065 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m20:56:52.663065 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m20:56:52.664063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:52.719588 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m20:56:52.720627 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m20:56:52.721627 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:56:52.733790 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.012 seconds
[0m20:56:52.737885 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m20:56:52.738840 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m20:56:52.760782 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:52.761780 [debug] [MainThread]: On master: BEGIN
[0m20:56:52.762777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:52.815728 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m20:56:52.815728 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:52.816756 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:56:52.830158 [debug] [MainThread]: SQL status: SELECT 3 in 0.013 seconds
[0m20:56:52.833181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eac666d-0248-4118-b683-3a877019842e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E83EB0920>]}
[0m20:56:52.833181 [debug] [MainThread]: On master: ROLLBACK
[0m20:56:52.834178 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:52.835176 [debug] [MainThread]: On master: BEGIN
[0m20:56:52.836233 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:56:52.836233 [debug] [MainThread]: On master: COMMIT
[0m20:56:52.837172 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:52.838168 [debug] [MainThread]: On master: COMMIT
[0m20:56:52.839138 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:56:52.840134 [debug] [MainThread]: On master: Close
[0m20:56:52.845165 [debug] [Thread-1 (]: Began running node test.dbtlearn.consistent_created_at
[0m20:56:52.846159 [info ] [Thread-1 (]: 1 of 9 START test consistent_created_at ........................................ [RUN]
[0m20:56:52.848374 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbtlearn.consistent_created_at'
[0m20:56:52.849372 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.consistent_created_at
[0m20:56:52.869306 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m20:56:52.870301 [debug] [Thread-1 (]: Began executing node test.dbtlearn.consistent_created_at
[0m20:56:52.970037 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.consistent_created_at"
[0m20:56:52.971003 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.consistent_created_at"
[0m20:56:52.972001 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: BEGIN
[0m20:56:52.972001 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:56:53.013759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m20:56:53.013759 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.consistent_created_at"
[0m20:56:53.014791 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * FROM "DBT"."raw"."dim_listings_cleansed" l
INNER JOIN "DBT"."raw"."fct_reviews" r
USING (listing_id)
WHERE l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m20:56:53.128239 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.113 seconds
[0m20:56:53.138212 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: ROLLBACK
[0m20:56:53.139209 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: Close
[0m20:56:53.141161 [info ] [Thread-1 (]: 1 of 9 PASS consistent_created_at .............................................. [[32mPASS[0m in 0.29s]
[0m20:56:53.144153 [debug] [Thread-1 (]: Finished running node test.dbtlearn.consistent_created_at
[0m20:56:53.145155 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m20:56:53.146333 [info ] [Thread-1 (]: 2 of 9 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m20:56:53.148142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.consistent_created_at, now test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65)
[0m20:56:53.150137 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m20:56:53.186041 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m20:56:53.188035 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m20:56:53.193902 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m20:56:53.195485 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m20:56:53.196218 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: BEGIN
[0m20:56:53.196218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:53.392152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.195 seconds
[0m20:56:53.393071 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m20:56:53.394243 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct room_type) = 4
 as expression


    from "DBT"."raw"."raw_listings"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m20:56:53.405097 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:56:53.408179 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: ROLLBACK
[0m20:56:53.408179 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: Close
[0m20:56:53.409056 [info ] [Thread-1 (]: 2 of 9 PASS dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[32mPASS[0m in 0.26s]
[0m20:56:53.411022 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m20:56:53.412020 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m20:56:53.412187 [info ] [Thread-1 (]: 3 of 9 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m20:56:53.413331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65, now test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9)
[0m20:56:53.414046 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m20:56:53.429970 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m20:56:53.430968 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m20:56:53.433960 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m20:56:53.434958 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m20:56:53.435372 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: BEGIN
[0m20:56:53.435979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:53.473389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m20:56:53.473389 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m20:56:53.474410 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(price, '^\\$[0-9][0-9\\.]+$', '')), 1), 0)


 > 0
 as expression


    from "DBT"."raw"."raw_listings"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





      
    ) dbt_internal_test
[0m20:56:53.485388 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:56:53.486647 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: ROLLBACK
[0m20:56:53.487381 [debug] [Thread-1 (]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: Close
[0m20:56:53.488348 [error] [Thread-1 (]: 3 of 9 FAIL 17499 dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[31mFAIL 17499[0m in 0.07s]
[0m20:56:53.489346 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m20:56:53.490344 [debug] [Thread-1 (]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m20:56:53.490344 [info ] [Thread-1 (]: 4 of 9 START test dim_listings_minimum_nights .................................. [RUN]
[0m20:56:53.491340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9, now test.dbtlearn.dim_listings_minimum_nights)
[0m20:56:53.492339 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m20:56:53.495361 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m20:56:53.496359 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m20:56:53.499319 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dim_listings_minimum_nights"
[0m20:56:53.500316 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dim_listings_minimum_nights"
[0m20:56:53.501406 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: BEGIN
[0m20:56:53.501406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:53.541764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m20:56:53.542754 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.dim_listings_minimum_nights"
[0m20:56:53.543751 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM
    "DBT"."raw"."dim_listings_cleansed"
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m20:56:53.547740 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:56:53.548737 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: ROLLBACK
[0m20:56:53.550224 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m20:56:53.550731 [info ] [Thread-1 (]: 4 of 9 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.06s]
[0m20:56:53.551729 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m20:56:53.552777 [debug] [Thread-1 (]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m20:56:53.552777 [info ] [Thread-1 (]: 5 of 9 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m20:56:53.553724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dim_listings_minimum_nights, now test.dbtlearn.no_nulls_in_dim_listings)
[0m20:56:53.553724 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m20:56:53.577693 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m20:56:53.578694 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: BEGIN
[0m20:56:53.578694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:53.616074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m20:56:53.616074 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m20:56:53.616074 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'dim_listings_cleansed'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:56:53.634220 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.017 seconds
[0m20:56:53.638016 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m20:56:53.638983 [debug] [Thread-1 (]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m20:56:53.642005 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m20:56:53.642971 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m20:56:53.642971 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM "DBT"."raw"."dim_listings_cleansed" WHERE
    listing_id IS NULL OR
    listing_name IS NULL OR
    room_type IS NULL OR
    minimum_nights IS NULL OR
    host_id IS NULL OR
    price_str IS NULL OR
    created_at IS NULL OR
    updated_at IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m20:56:53.648111 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m20:56:53.649111 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: ROLLBACK
[0m20:56:53.650599 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m20:56:53.650599 [info ] [Thread-1 (]: 5 of 9 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 0.10s]
[0m20:56:53.652548 [debug] [Thread-1 (]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m20:56:53.652548 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:56:53.652548 [info ] [Thread-1 (]: 6 of 9 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m20:56:53.653869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.no_nulls_in_dim_listings, now test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m20:56:53.654577 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:56:53.661524 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m20:56:53.663523 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:56:53.667540 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m20:56:53.668543 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m20:56:53.668543 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: BEGIN
[0m20:56:53.669504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:53.709772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m20:56:53.709772 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m20:56:53.710763 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from "DBT"."raw"."dim_listings_cleansed"
where host_id is null



      
    ) dbt_internal_test
[0m20:56:53.714784 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m20:56:53.716781 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: ROLLBACK
[0m20:56:53.717364 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m20:56:53.717364 [info ] [Thread-1 (]: 6 of 9 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.06s]
[0m20:56:53.719351 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:56:53.719351 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:56:53.720521 [info ] [Thread-1 (]: 7 of 9 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m20:56:53.721387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m20:56:53.721387 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:56:53.727360 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m20:56:53.728327 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:56:53.731349 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m20:56:53.732348 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m20:56:53.732348 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: BEGIN
[0m20:56:53.733354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:53.772679 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m20:56:53.773833 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m20:56:53.775536 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from "DBT"."raw"."dim_listings_cleansed"
where listing_id is null



      
    ) dbt_internal_test
[0m20:56:53.779725 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:56:53.781712 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: ROLLBACK
[0m20:56:53.782676 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m20:56:53.782676 [info ] [Thread-1 (]: 7 of 9 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.06s]
[0m20:56:53.784671 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:56:53.784671 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:56:53.785828 [info ] [Thread-1 (]: 8 of 9 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m20:56:53.786666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m20:56:53.786666 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:56:53.795683 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m20:56:53.796675 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:56:53.800630 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m20:56:53.802624 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m20:56:53.802624 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: BEGIN
[0m20:56:53.803718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:53.844968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m20:56:53.845963 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m20:56:53.846964 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from "DBT"."raw"."dim_listings_cleansed"
    where host_id is not null
),

parent as (
    select host_id as to_field
    from "DBT"."raw"."dim_hosts_cleansed"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:56:53.855489 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m20:56:53.857449 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: ROLLBACK
[0m20:56:53.858586 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m20:56:53.859476 [info ] [Thread-1 (]: 8 of 9 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.07s]
[0m20:56:53.860440 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:56:53.861472 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:56:53.861472 [info ] [Thread-1 (]: 9 of 9 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m20:56:53.862466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m20:56:53.863464 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:56:53.871438 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m20:56:53.872437 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:56:53.876427 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m20:56:53.877524 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m20:56:53.878395 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: BEGIN
[0m20:56:53.879418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:53.918925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m20:56:53.918925 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m20:56:53.919954 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from "DBT"."raw"."dim_listings_cleansed"
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:56:53.930104 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m20:56:53.932101 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: ROLLBACK
[0m20:56:53.932832 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m20:56:53.932832 [info ] [Thread-1 (]: 9 of 9 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.07s]
[0m20:56:53.934819 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:56:53.935889 [info ] [MainThread]: 
[0m20:56:53.936839 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:53.936839 [debug] [MainThread]: On master: BEGIN
[0m20:56:53.937839 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:54.120454 [debug] [MainThread]: SQL status: BEGIN in 0.183 seconds
[0m20:56:54.121451 [debug] [MainThread]: On master: COMMIT
[0m20:56:54.121451 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:54.122449 [debug] [MainThread]: On master: COMMIT
[0m20:56:54.123283 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:56:54.134417 [info ] [MainThread]: ========== Begin Summary ==========
[0m20:56:54.138439 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:54.139435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw_dbt_test__audit', 'test.dbtlearn.consistent_created_at', 'test',
'2025-02-02 19:56:50.769638+00:00',
'2025-02-02 19:56:52.849372',
'2025-02-02 19:56:53.138212'
,'pass','0.2929651737213135',
'4eac666d-0248-4118-b683-3a877019842e','1.9.1',CURRENT_TIMESTAMP(0),'1');
           
      
  
[0m20:56:54.142396 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.003 seconds
[0m20:56:54.144389 [info ] [MainThread]: 
     
[0m20:56:54.146385 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:54.146385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw_dbt_test__audit', 'test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65', 'test',
'2025-02-02 19:56:50.769638+00:00',
'2025-02-02 19:56:53.151134',
'2025-02-02 19:56:53.407033'
,'pass','0.2609138488769531',
'4eac666d-0248-4118-b683-3a877019842e','1.9.1',CURRENT_TIMESTAMP(0),'1');
           
      
  
[0m20:56:54.148397 [debug] [MainThread]: Postgres adapter: Postgres error: value too long for type character varying(50)

[0m20:56:54.151371 [debug] [MainThread]: On master: Close
[0m20:56:54.161539 [info ] [MainThread]: 
[0m20:56:54.162343 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m20:56:54.163339 [info ] [MainThread]: 
[0m20:56:54.164337 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models\sources.yml)[0m
[0m20:56:54.165333 [error] [MainThread]:   Got 17499 results, configured to fail if != 0
[0m20:56:54.165333 [info ] [MainThread]: 
[0m20:56:54.166332 [info ] [MainThread]:   compiled code at target\compiled\dbtlearn\models\sources.yml\dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb.sql
[0m20:56:54.167329 [info ] [MainThread]: 
[0m20:56:54.168326 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m20:56:54.169324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:54.169324 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m20:56:54.169324 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m20:56:54.170347 [info ] [MainThread]: 
[0m20:56:54.171291 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m20:56:54.172160 [error] [MainThread]: Encountered an error:
Database Error
  value too long for type character varying(50)
[0m20:56:54.174183 [debug] [MainThread]: Command `dbt test` failed at 20:56:54.174183 after 3.50 seconds
[0m20:56:54.175193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E82006CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E819E0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E83D54E60>]}
[0m20:56:54.176150 [debug] [MainThread]: Flushing usage events
[0m20:56:54.906826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:22:20.186083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020896288FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208962890A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020896289100>]}


============================== 21:22:20.190330 | bc721adb-57f6-48ad-8050-58b64fda4844 ==============================
[0m21:22:20.190330 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:22:20.191939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select test_listing_review_created_at_consistency', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:22:20.417650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc721adb-57f6-48ad-8050-58b64fda4844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020898600710>]}
[0m21:22:20.481470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc721adb-57f6-48ad-8050-58b64fda4844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002089615A480>]}
[0m21:22:20.486779 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:22:20.703131 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m21:22:21.106732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:22:21.106732 [debug] [MainThread]: Partial parsing: added file: dbtlearn://tests\test_listing_review_created_at_consistency.sql
[0m21:22:21.219325 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtlearn.test_listing_review_created_at_consistency' (tests\test_listing_review_created_at_consistency.sql) depends on a node named 'listings' in package '' which was not found
[0m21:22:21.223855 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtlearn.test_listing_review_created_at_consistency' (tests\test_listing_review_created_at_consistency.sql) depends on a node named 'reviews' in package '' which was not found
[0m21:22:21.372015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc721adb-57f6-48ad-8050-58b64fda4844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020899D0BCE0>]}
[0m21:22:21.535916 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m21:22:21.539864 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m21:22:21.584797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc721adb-57f6-48ad-8050-58b64fda4844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020899D186E0>]}
[0m21:22:21.584797 [info ] [MainThread]: Found 8 models, 1 analysis, 9 data tests, 1 seed, 1 operation, 2 snapshots, 3 sources, 1 exposure, 814 macros
[0m21:22:21.585795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc721adb-57f6-48ad-8050-58b64fda4844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002089768BCE0>]}
[0m21:22:21.586819 [warn ] [MainThread]: The selection criterion 'test_listing_review_created_at_consistency' does not match any enabled nodes
[0m21:22:21.587815 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:22:21.589146 [debug] [MainThread]: Command end result
[0m21:22:21.631050 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m21:22:21.632810 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m21:22:21.636781 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m21:22:21.636781 [debug] [MainThread]: Command `dbt test` succeeded at 21:22:21.636781 after 1.68 seconds
[0m21:22:21.637812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002089802D0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020897ED4E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020897ED76E0>]}
[0m21:22:21.637812 [debug] [MainThread]: Flushing usage events
[0m21:22:22.226422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:22:59.650636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2DEE7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2DB1C170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2D5936E0>]}


============================== 21:22:59.655839 | caf2247b-7f92-4e53-93cd-9399908236fb ==============================
[0m21:22:59.655839 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:22:59.656730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select test_listing_review_created_at_consistency', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:22:59.900867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caf2247b-7f92-4e53-93cd-9399908236fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2E023260>]}
[0m21:22:59.969204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caf2247b-7f92-4e53-93cd-9399908236fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2BB79280>]}
[0m21:22:59.971226 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:23:00.197224 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m21:23:00.548680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:23:00.550798 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://tests\test_listing_review_created_at_consistency.sql
[0m21:23:00.797124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caf2247b-7f92-4e53-93cd-9399908236fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2F69F530>]}
[0m21:23:00.953527 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m21:23:00.960290 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m21:23:01.002214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caf2247b-7f92-4e53-93cd-9399908236fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2FB0F830>]}
[0m21:23:01.002214 [info ] [MainThread]: Found 8 models, 1 analysis, 10 data tests, 1 seed, 1 operation, 2 snapshots, 3 sources, 1 exposure, 814 macros
[0m21:23:01.003370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caf2247b-7f92-4e53-93cd-9399908236fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2F71DDF0>]}
[0m21:23:01.004393 [info ] [MainThread]: 
[0m21:23:01.005400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:23:01.006208 [info ] [MainThread]: 
[0m21:23:01.006208 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:23:01.007206 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m21:23:01.087318 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m21:23:01.087318 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m21:23:01.087318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:01.261616 [debug] [ThreadPool]: SQL status: BEGIN in 0.168 seconds
[0m21:23:01.261616 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m21:23:01.261616 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m21:23:01.277626 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.013 seconds
[0m21:23:01.279240 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m21:23:01.279240 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m21:23:01.305269 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:01.306266 [debug] [MainThread]: On master: BEGIN
[0m21:23:01.307263 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:23:01.376864 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m21:23:01.376864 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:01.377898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:23:01.386387 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m21:23:01.386387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caf2247b-7f92-4e53-93cd-9399908236fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2B5F94C0>]}
[0m21:23:01.386387 [debug] [MainThread]: On master: ROLLBACK
[0m21:23:01.389179 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:01.389179 [debug] [MainThread]: On master: BEGIN
[0m21:23:01.390176 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:23:01.390176 [debug] [MainThread]: On master: COMMIT
[0m21:23:01.390176 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:01.391173 [debug] [MainThread]: On master: COMMIT
[0m21:23:01.391655 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:23:01.391655 [debug] [MainThread]: On master: Close
[0m21:23:01.393884 [debug] [Thread-1 (]: Began running node test.dbtlearn.test_listing_review_created_at_consistency
[0m21:23:01.393884 [info ] [Thread-1 (]: 1 of 1 START test test_listing_review_created_at_consistency ................... [RUN]
[0m21:23:01.395069 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbtlearn.test_listing_review_created_at_consistency'
[0m21:23:01.395069 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.test_listing_review_created_at_consistency
[0m21:23:01.397095 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.test_listing_review_created_at_consistency"
[0m21:23:01.404383 [debug] [Thread-1 (]: Began executing node test.dbtlearn.test_listing_review_created_at_consistency
[0m21:23:01.422448 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.test_listing_review_created_at_consistency"
[0m21:23:01.424814 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.test_listing_review_created_at_consistency"
[0m21:23:01.424814 [debug] [Thread-1 (]: On test.dbtlearn.test_listing_review_created_at_consistency: BEGIN
[0m21:23:01.425924 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:23:01.461783 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m21:23:01.462814 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.test_listing_review_created_at_consistency"
[0m21:23:01.462814 [debug] [Thread-1 (]: On test.dbtlearn.test_listing_review_created_at_consistency: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.test_listing_review_created_at_consistency"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_listing_review_created_at_consistency.sql

WITH listing_reviews AS (
    SELECT
        l.listing_id,
        l.created_at AS listing_created_at,
        r.created_at AS review_created_at
    FROM "DBT"."raw"."src_listings" l
    LEFT JOIN "DBT"."raw"."src_reviews" r
    ON l.listing_id = r.listing_id
)

SELECT
    listing_id,
    listing_created_at,
    review_created_at
FROM listing_reviews
WHERE review_created_at IS NOT NULL
  AND review_created_at < listing_created_at
      
    ) dbt_internal_test
[0m21:23:01.464704 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column r.created_at does not exist
LINE 13:         r.created_at AS review_created_at
                 ^
HINT:  Perhaps you meant to reference the column "l.created_at".

[0m21:23:01.464704 [debug] [Thread-1 (]: On test.dbtlearn.test_listing_review_created_at_consistency: ROLLBACK
[0m21:23:01.465733 [debug] [Thread-1 (]: On test.dbtlearn.test_listing_review_created_at_consistency: Close
[0m21:23:01.471626 [debug] [Thread-1 (]: Database Error in test test_listing_review_created_at_consistency (tests\test_listing_review_created_at_consistency.sql)
  column r.created_at does not exist
  LINE 13:         r.created_at AS review_created_at
                   ^
  HINT:  Perhaps you meant to reference the column "l.created_at".
  compiled code at target\run\dbtlearn\tests\test_listing_review_created_at_consistency.sql
[0m21:23:01.471626 [error] [Thread-1 (]: 1 of 1 ERROR test_listing_review_created_at_consistency ........................ [[31mERROR[0m in 0.08s]
[0m21:23:01.474103 [debug] [Thread-1 (]: Finished running node test.dbtlearn.test_listing_review_created_at_consistency
[0m21:23:01.475132 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.test_listing_review_created_at_consistency' to be skipped because of status 'error'.  Reason: Database Error in test test_listing_review_created_at_consistency (tests\test_listing_review_created_at_consistency.sql)
  column r.created_at does not exist
  LINE 13:         r.created_at AS review_created_at
                   ^
  HINT:  Perhaps you meant to reference the column "l.created_at".
  compiled code at target\run\dbtlearn\tests\test_listing_review_created_at_consistency.sql.
[0m21:23:01.477044 [info ] [MainThread]: 
[0m21:23:01.478059 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:01.478059 [debug] [MainThread]: On master: BEGIN
[0m21:23:01.479073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:23:01.520484 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m21:23:01.521508 [debug] [MainThread]: On master: COMMIT
[0m21:23:01.521508 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:01.521508 [debug] [MainThread]: On master: COMMIT
[0m21:23:01.522853 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:23:01.529003 [info ] [MainThread]: ========== Begin Summary ==========
[0m21:23:01.536595 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:01.536595 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw_dbt_test__audit', 'test.dbtlearn.test_listing_review_created_at_consistency', 'test',
'2025-02-02 20:22:59.552083+00:00',
'2025-02-02 20:23:01.396102',
'2025-02-02 20:23:01.465733'
,'error','0.07655715942382812',
'caf2247b-7f92-4e53-93cd-9399908236fb','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m21:23:01.536595 [debug] [MainThread]: Postgres adapter: Postgres error: value too long for type character varying(50)

[0m21:23:01.541449 [debug] [MainThread]: On master: Close
[0m21:23:01.550776 [info ] [MainThread]: 
[0m21:23:01.551774 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m21:23:01.552771 [info ] [MainThread]: 
[0m21:23:01.552771 [error] [MainThread]:   Database Error in test test_listing_review_created_at_consistency (tests\test_listing_review_created_at_consistency.sql)
  column r.created_at does not exist
  LINE 13:         r.created_at AS review_created_at
                   ^
  HINT:  Perhaps you meant to reference the column "l.created_at".
  compiled code at target\run\dbtlearn\tests\test_listing_review_created_at_consistency.sql
[0m21:23:01.554767 [info ] [MainThread]: 
[0m21:23:01.555891 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:23:01.555891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:01.556997 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m21:23:01.556997 [debug] [MainThread]: Connection 'test.dbtlearn.test_listing_review_created_at_consistency' was properly closed.
[0m21:23:01.557995 [info ] [MainThread]: 
[0m21:23:01.558442 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m21:23:01.559449 [error] [MainThread]: Encountered an error:
Database Error
  value too long for type character varying(50)
[0m21:23:01.561459 [debug] [MainThread]: Command `dbt test` failed at 21:23:01.560460 after 2.11 seconds
[0m21:23:01.561459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2D654740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2F736AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2FF0CAA0>]}
[0m21:23:01.562455 [debug] [MainThread]: Flushing usage events
[0m21:23:02.335055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:32.200191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3C8E42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3C8E6FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3C8E57C0>]}


============================== 21:27:32.204332 | d709d00d-66fa-4a1d-880c-30ba7fcf996b ==============================
[0m21:27:32.204332 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:27:32.205781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_listings_w_hosts', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:27:32.439579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd709d00d-66fa-4a1d-880c-30ba7fcf996b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E39CAD910>]}
[0m21:27:32.499236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd709d00d-66fa-4a1d-880c-30ba7fcf996b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3CA74620>]}
[0m21:27:32.503075 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:27:32.734754 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m21:27:33.096590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:33.096590 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models\dim\dim_listings_w_hosts.sql
[0m21:27:33.452894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd709d00d-66fa-4a1d-880c-30ba7fcf996b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3E202BD0>]}
[0m21:27:33.614111 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m21:27:33.620397 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m21:27:33.651193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd709d00d-66fa-4a1d-880c-30ba7fcf996b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3CBBEC30>]}
[0m21:27:33.651193 [info ] [MainThread]: Found 8 models, 1 analysis, 10 data tests, 1 seed, 1 operation, 2 snapshots, 3 sources, 1 exposure, 814 macros
[0m21:27:33.652477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd709d00d-66fa-4a1d-880c-30ba7fcf996b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3DEB9400>]}
[0m21:27:33.654506 [info ] [MainThread]: 
[0m21:27:33.655245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:27:33.655245 [info ] [MainThread]: 
[0m21:27:33.656243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:27:33.657621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT'
[0m21:27:33.734295 [debug] [ThreadPool]: Using postgres connection "list_DBT"
[0m21:27:33.734295 [debug] [ThreadPool]: On list_DBT: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT"} */

    select distinct nspname from pg_namespace
  
[0m21:27:33.734295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:33.785497 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.047 seconds
[0m21:27:33.788211 [debug] [ThreadPool]: On list_DBT: Close
[0m21:27:33.791831 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m21:27:33.799050 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m21:27:33.799050 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m21:27:33.799050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:33.858758 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m21:27:33.858758 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m21:27:33.859972 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m21:27:33.870623 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.011 seconds
[0m21:27:33.870623 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m21:27:33.875225 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m21:27:33.884744 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:33.884744 [debug] [MainThread]: On master: BEGIN
[0m21:27:33.884744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:33.946663 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m21:27:33.946663 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:33.947699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:27:33.961211 [debug] [MainThread]: SQL status: SELECT 3 in 0.015 seconds
[0m21:27:33.961211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd709d00d-66fa-4a1d-880c-30ba7fcf996b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3E14A6F0>]}
[0m21:27:33.961211 [debug] [MainThread]: On master: ROLLBACK
[0m21:27:33.969288 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:33.969288 [debug] [MainThread]: On master: BEGIN
[0m21:27:33.971286 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:27:33.972324 [debug] [MainThread]: On master: COMMIT
[0m21:27:33.972324 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:33.972324 [debug] [MainThread]: On master: COMMIT
[0m21:27:33.972324 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:27:33.972324 [debug] [MainThread]: On master: Close
[0m21:27:33.980166 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m21:27:33.981196 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.dim_listings_w_hosts .......................... [RUN]
[0m21:27:33.983971 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.dim_listings_w_hosts'
[0m21:27:33.985001 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m21:27:34.006104 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m21:27:34.007101 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m21:27:34.051080 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m21:27:34.051080 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m21:27:34.057968 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: BEGIN
[0m21:27:34.057968 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:27:34.098573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m21:27:34.098573 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m21:27:34.098573 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */

  
    

  create  table "DBT"."raw"."dim_listings_w_hosts__dbt_tmp"
  
  
    as
  
  (
    

WITH    
l As (
    select * from "DBT"."raw"."dim_listings_cleansed"
),
h as (select * from "DBT"."raw"."dim_hosts_cleansed")

select 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price_str,
    l.host_id,
    h.NAME,
    h.IS_SUPERHOST as host_is_superhost,
    l.created_at,
    GREATEST (l.updated_at,h.updated_at) as update_at
    from l   
    left join h on (h.host_id = l.host_id)
  );
  
[0m21:27:34.187264 [debug] [Thread-1 (]: SQL status: SELECT 17499 in 0.088 seconds
[0m21:27:34.195361 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m21:27:34.195361 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
alter table "DBT"."raw"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m21:27:34.195361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:27:34.208613 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: COMMIT
[0m21:27:34.208613 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m21:27:34.216608 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: COMMIT
[0m21:27:34.225387 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m21:27:34.241423 [debug] [Thread-1 (]: Applying DROP to: "DBT"."raw"."dim_listings_w_hosts__dbt_backup"
[0m21:27:34.250461 [debug] [Thread-1 (]: Using postgres connection "model.dbtlearn.dim_listings_w_hosts"
[0m21:27:34.251488 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
drop table if exists "DBT"."raw"."dim_listings_w_hosts__dbt_backup" cascade
[0m21:27:34.252482 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m21:27:34.252482 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m21:27:34.258838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd709d00d-66fa-4a1d-880c-30ba7fcf996b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E39CAC980>]}
[0m21:27:34.259835 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.dim_listings_w_hosts ..................... [[32mSELECT 17499[0m in 0.27s]
[0m21:27:34.260425 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m21:27:34.261717 [info ] [MainThread]: 
[0m21:27:34.262714 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:34.262714 [debug] [MainThread]: On master: BEGIN
[0m21:27:34.263713 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:27:34.302959 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m21:27:34.303948 [debug] [MainThread]: On master: COMMIT
[0m21:27:34.303948 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:34.304948 [debug] [MainThread]: On master: COMMIT
[0m21:27:34.305648 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:27:34.316571 [info ] [MainThread]: ========== Begin Summary ==========
[0m21:27:34.320131 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:34.320131 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw', 'model.dbtlearn.dim_listings_w_hosts', 'table',
'2025-02-02 20:27:32.059474+00:00',
'2025-02-02 20:27:33.985001',
'2025-02-02 20:27:34.252482'
,'success','0.26950740814208984',
'd709d00d-66fa-4a1d-880c-30ba7fcf996b','1.9.1',CURRENT_TIMESTAMP(0),'17499');
           
      
  
[0m21:27:34.324813 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.003 seconds
[0m21:27:34.324813 [info ] [MainThread]: 
     
[0m21:27:34.327686 [info ] [MainThread]: ========== End Summary ==========
[0m21:27:34.328715 [debug] [MainThread]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m21:27:34.335674 [info ] [MainThread]: 1 of 1 START hook: dbtlearn.on-run-end.0 ....................................... [RUN]
[0m21:27:34.338432 [info ] [MainThread]: 1 of 1 OK hook: dbtlearn.on-run-end.0 .......................................... [[32mOK[0m in 0.03s]
[0m21:27:34.339602 [debug] [MainThread]: On master: Close
[0m21:27:34.339602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:34.340789 [debug] [MainThread]: Connection 'list_DBT' was properly closed.
[0m21:27:34.340789 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m21:27:34.341787 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m21:27:34.342265 [info ] [MainThread]: 
[0m21:27:34.343262 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m21:27:34.345258 [debug] [MainThread]: Command end result
[0m21:27:34.393806 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m21:27:34.401187 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m21:27:34.405249 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m21:27:34.409922 [info ] [MainThread]: 
[0m21:27:34.410920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:27:34.410920 [info ] [MainThread]: 
[0m21:27:34.412293 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:27:34.413324 [debug] [MainThread]: Command `dbt run` succeeded at 21:27:34.413324 after 2.45 seconds
[0m21:27:34.413324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3C79F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3C8BE3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3B9A6A50>]}
[0m21:27:34.413324 [debug] [MainThread]: Flushing usage events
[0m21:27:35.233437 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:57.737184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023145DF0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023146BD7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002314931C650>]}


============================== 21:28:57.744920 | 6d823126-f286-4114-9be0-d6ed96abfd1c ==============================
[0m21:28:57.744920 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:28:57.749872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select test_listing_review_created_at_consistency', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:28:57.961322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d823126-f286-4114-9be0-d6ed96abfd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023149484800>]}
[0m21:28:58.023888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d823126-f286-4114-9be0-d6ed96abfd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023149664050>]}
[0m21:28:58.031021 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:28:58.253256 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m21:28:58.655055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:28:58.663015 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://tests\test_listing_review_created_at_consistency.sql
[0m21:28:58.905401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d823126-f286-4114-9be0-d6ed96abfd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002314AC8B260>]}
[0m21:28:59.064857 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m21:28:59.069432 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m21:28:59.110363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d823126-f286-4114-9be0-d6ed96abfd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002314B0D7950>]}
[0m21:28:59.110363 [info ] [MainThread]: Found 8 models, 1 analysis, 10 data tests, 1 seed, 1 operation, 2 snapshots, 3 sources, 1 exposure, 814 macros
[0m21:28:59.111360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d823126-f286-4114-9be0-d6ed96abfd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002314AB11280>]}
[0m21:28:59.113354 [info ] [MainThread]: 
[0m21:28:59.114296 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:28:59.114296 [info ] [MainThread]: 
[0m21:28:59.115294 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:28:59.117289 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m21:28:59.204001 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m21:28:59.204001 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m21:28:59.204001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:59.248393 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m21:28:59.249418 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m21:28:59.249418 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m21:28:59.258807 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.009 seconds
[0m21:28:59.258807 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m21:28:59.258807 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m21:28:59.281429 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:59.282425 [debug] [MainThread]: On master: BEGIN
[0m21:28:59.283423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:28:59.333040 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m21:28:59.334068 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:59.334068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:28:59.344086 [debug] [MainThread]: SQL status: SELECT 3 in 0.010 seconds
[0m21:28:59.344086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d823126-f286-4114-9be0-d6ed96abfd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023149640D70>]}
[0m21:28:59.344086 [debug] [MainThread]: On master: ROLLBACK
[0m21:28:59.344086 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:59.344086 [debug] [MainThread]: On master: BEGIN
[0m21:28:59.350557 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:28:59.350557 [debug] [MainThread]: On master: COMMIT
[0m21:28:59.351584 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:59.351584 [debug] [MainThread]: On master: COMMIT
[0m21:28:59.353352 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:28:59.353352 [debug] [MainThread]: On master: Close
[0m21:28:59.356737 [debug] [Thread-1 (]: Began running node test.dbtlearn.test_listing_review_created_at_consistency
[0m21:28:59.357763 [info ] [Thread-1 (]: 1 of 1 START test test_listing_review_created_at_consistency ................... [RUN]
[0m21:28:59.358732 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbtlearn.test_listing_review_created_at_consistency'
[0m21:28:59.359770 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.test_listing_review_created_at_consistency
[0m21:28:59.373218 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.test_listing_review_created_at_consistency"
[0m21:28:59.373218 [debug] [Thread-1 (]: Began executing node test.dbtlearn.test_listing_review_created_at_consistency
[0m21:28:59.402033 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.test_listing_review_created_at_consistency"
[0m21:28:59.402033 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.test_listing_review_created_at_consistency"
[0m21:28:59.403902 [debug] [Thread-1 (]: On test.dbtlearn.test_listing_review_created_at_consistency: BEGIN
[0m21:28:59.403902 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:28:59.437891 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m21:28:59.438888 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.test_listing_review_created_at_consistency"
[0m21:28:59.438888 [debug] [Thread-1 (]: On test.dbtlearn.test_listing_review_created_at_consistency: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.test_listing_review_created_at_consistency"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_listing_review_created_at_consistency.sql

WITH listing_reviews AS (
    SELECT
        l.listing_id,
        l.created_at AS listing_created_at,
        r.created_at AS review_created_at
    FROM "DBT"."raw"."dim_hosts_cleansed" l
    LEFT JOIN "DBT"."raw"."dim_listings_cleansed" r
    ON l.listing_id = r.listing_id
)

SELECT
    listing_id,
    listing_created_at,
    review_created_at
FROM listing_reviews
WHERE review_created_at IS NOT NULL
  AND review_created_at < listing_created_at
      
    ) dbt_internal_test
[0m21:28:59.440135 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column l.listing_id does not exist
LINE 16:     ON l.listing_id = r.listing_id
                ^
HINT:  Perhaps you meant to reference the column "r.listing_id".

[0m21:28:59.440135 [debug] [Thread-1 (]: On test.dbtlearn.test_listing_review_created_at_consistency: ROLLBACK
[0m21:28:59.441134 [debug] [Thread-1 (]: On test.dbtlearn.test_listing_review_created_at_consistency: Close
[0m21:28:59.446805 [debug] [Thread-1 (]: Database Error in test test_listing_review_created_at_consistency (tests\test_listing_review_created_at_consistency.sql)
  column l.listing_id does not exist
  LINE 16:     ON l.listing_id = r.listing_id
                  ^
  HINT:  Perhaps you meant to reference the column "r.listing_id".
  compiled code at target\run\dbtlearn\tests\test_listing_review_created_at_consistency.sql
[0m21:28:59.446805 [error] [Thread-1 (]: 1 of 1 ERROR test_listing_review_created_at_consistency ........................ [[31mERROR[0m in 0.09s]
[0m21:28:59.448358 [debug] [Thread-1 (]: Finished running node test.dbtlearn.test_listing_review_created_at_consistency
[0m21:28:59.449387 [debug] [Thread-4 (]: Marking all children of 'test.dbtlearn.test_listing_review_created_at_consistency' to be skipped because of status 'error'.  Reason: Database Error in test test_listing_review_created_at_consistency (tests\test_listing_review_created_at_consistency.sql)
  column l.listing_id does not exist
  LINE 16:     ON l.listing_id = r.listing_id
                  ^
  HINT:  Perhaps you meant to reference the column "r.listing_id".
  compiled code at target\run\dbtlearn\tests\test_listing_review_created_at_consistency.sql.
[0m21:28:59.450669 [info ] [MainThread]: 
[0m21:28:59.451667 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:59.451667 [debug] [MainThread]: On master: BEGIN
[0m21:28:59.451667 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:28:59.491432 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m21:28:59.492457 [debug] [MainThread]: On master: COMMIT
[0m21:28:59.492984 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:59.492984 [debug] [MainThread]: On master: COMMIT
[0m21:28:59.493987 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:28:59.505009 [info ] [MainThread]: ========== Begin Summary ==========
[0m21:28:59.507744 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:59.507744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw_dbt_test__audit', 'test.dbtlearn.test_listing_review_created_at_consistency', 'test',
'2025-02-02 20:28:57.601754+00:00',
'2025-02-02 20:28:59.359770',
'2025-02-02 20:28:59.441134'
,'error','0.08807253837585449',
'6d823126-f286-4114-9be0-d6ed96abfd1c','1.9.1',CURRENT_TIMESTAMP(0),'');
           
      
  
[0m21:28:59.507744 [debug] [MainThread]: Postgres adapter: Postgres error: value too long for type character varying(50)

[0m21:28:59.513292 [debug] [MainThread]: On master: Close
[0m21:28:59.522872 [info ] [MainThread]: 
[0m21:28:59.523871 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m21:28:59.526097 [info ] [MainThread]: 
[0m21:28:59.527091 [error] [MainThread]:   Database Error in test test_listing_review_created_at_consistency (tests\test_listing_review_created_at_consistency.sql)
  column l.listing_id does not exist
  LINE 16:     ON l.listing_id = r.listing_id
                  ^
  HINT:  Perhaps you meant to reference the column "r.listing_id".
  compiled code at target\run\dbtlearn\tests\test_listing_review_created_at_consistency.sql
[0m21:28:59.529082 [info ] [MainThread]: 
[0m21:28:59.530084 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:28:59.530084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:59.531077 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m21:28:59.531077 [debug] [MainThread]: Connection 'test.dbtlearn.test_listing_review_created_at_consistency' was properly closed.
[0m21:28:59.532109 [info ] [MainThread]: 
[0m21:28:59.532680 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m21:28:59.533687 [error] [MainThread]: Encountered an error:
Database Error
  value too long for type character varying(50)
[0m21:28:59.536670 [debug] [MainThread]: Command `dbt test` failed at 21:28:59.536670 after 2.03 seconds
[0m21:28:59.536670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002314B0D5C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002314893F800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002314893C440>]}
[0m21:28:59.536670 [debug] [MainThread]: Flushing usage events
[0m21:29:00.151966 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:10:47.845497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296E847AFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296E5918B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296E7CD17C0>]}


============================== 22:10:47.851950 | f56d37a4-3289-4bc0-8dbd-94d4e0ae4bb0 ==============================
[0m22:10:47.851950 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:10:47.855067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select test_listing_review_created_at_consistency', 'send_anonymous_usage_stats': 'True'}
[0m22:10:48.088341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f56d37a4-3289-4bc0-8dbd-94d4e0ae4bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296E7B33710>]}
[0m22:10:48.144407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f56d37a4-3289-4bc0-8dbd-94d4e0ae4bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296E7BB9100>]}
[0m22:10:48.150433 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:10:48.364076 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m22:10:48.748517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:10:48.749188 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://tests\test_listing_review_created_at_consistency.sql
[0m22:10:48.992105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f56d37a4-3289-4bc0-8dbd-94d4e0ae4bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296E9E23A70>]}
[0m22:10:49.149525 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m22:10:49.153421 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m22:10:49.205008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f56d37a4-3289-4bc0-8dbd-94d4e0ae4bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296EA260EC0>]}
[0m22:10:49.205008 [info ] [MainThread]: Found 8 models, 1 analysis, 10 data tests, 1 seed, 1 operation, 2 snapshots, 3 sources, 1 exposure, 814 macros
[0m22:10:49.206037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f56d37a4-3289-4bc0-8dbd-94d4e0ae4bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296E865B230>]}
[0m22:10:49.208033 [info ] [MainThread]: 
[0m22:10:49.209025 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:10:49.209025 [info ] [MainThread]: 
[0m22:10:49.210131 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:10:49.214643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m22:10:49.292400 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m22:10:49.292400 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m22:10:49.292400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:49.340635 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m22:10:49.340980 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m22:10:49.340980 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m22:10:49.350638 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.008 seconds
[0m22:10:49.350638 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m22:10:49.350638 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m22:10:49.363242 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:49.363242 [debug] [MainThread]: On master: BEGIN
[0m22:10:49.369295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:49.412307 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m22:10:49.413307 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:49.413307 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:10:49.424658 [debug] [MainThread]: SQL status: SELECT 3 in 0.011 seconds
[0m22:10:49.425682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f56d37a4-3289-4bc0-8dbd-94d4e0ae4bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296EA29BFB0>]}
[0m22:10:49.425682 [debug] [MainThread]: On master: ROLLBACK
[0m22:10:49.425682 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:49.425682 [debug] [MainThread]: On master: BEGIN
[0m22:10:49.430918 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:10:49.430918 [debug] [MainThread]: On master: COMMIT
[0m22:10:49.431918 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:49.431918 [debug] [MainThread]: On master: COMMIT
[0m22:10:49.433403 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:10:49.433403 [debug] [MainThread]: On master: Close
[0m22:10:49.436143 [debug] [Thread-1 (]: Began running node test.dbtlearn.test_listing_review_created_at_consistency
[0m22:10:49.437166 [info ] [Thread-1 (]: 1 of 1 START test test_listing_review_created_at_consistency ................... [RUN]
[0m22:10:49.438157 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbtlearn.test_listing_review_created_at_consistency'
[0m22:10:49.439183 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.test_listing_review_created_at_consistency
[0m22:10:49.442302 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.test_listing_review_created_at_consistency"
[0m22:10:49.450395 [debug] [Thread-1 (]: Began executing node test.dbtlearn.test_listing_review_created_at_consistency
[0m22:10:49.469398 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.test_listing_review_created_at_consistency"
[0m22:10:49.474823 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.test_listing_review_created_at_consistency"
[0m22:10:49.476095 [debug] [Thread-1 (]: On test.dbtlearn.test_listing_review_created_at_consistency: BEGIN
[0m22:10:49.476095 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:10:49.512342 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m22:10:49.512342 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.test_listing_review_created_at_consistency"
[0m22:10:49.512342 [debug] [Thread-1 (]: On test.dbtlearn.test_listing_review_created_at_consistency: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.test_listing_review_created_at_consistency"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with listing_reviews as
(
	select
	rl.id as listing_id,
	rl.created_at  as listing_created_at,
	rr.review_date as review_created_at
	from raw.raw_listings rl left join raw.raw_reviews rr
	on rl.id=rr.listing_id
	--where rl.created_at > rr.review_date
)

select 
listing_id,
listing_created_at,
review_created_at
from 
listing_reviews
where review_created_at < listing_created_at
      
    ) dbt_internal_test
[0m22:10:49.673125 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.159 seconds
[0m22:10:49.674151 [debug] [Thread-1 (]: On test.dbtlearn.test_listing_review_created_at_consistency: ROLLBACK
[0m22:10:49.681005 [debug] [Thread-1 (]: On test.dbtlearn.test_listing_review_created_at_consistency: Close
[0m22:10:49.682032 [info ] [Thread-1 (]: 1 of 1 PASS test_listing_review_created_at_consistency ......................... [[32mPASS[0m in 0.24s]
[0m22:10:49.683654 [debug] [Thread-1 (]: Finished running node test.dbtlearn.test_listing_review_created_at_consistency
[0m22:10:49.685649 [info ] [MainThread]: 
[0m22:10:49.686774 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:49.687770 [debug] [MainThread]: On master: BEGIN
[0m22:10:49.687770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:49.746204 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m22:10:49.746204 [debug] [MainThread]: On master: COMMIT
[0m22:10:49.746204 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:49.747228 [debug] [MainThread]: On master: COMMIT
[0m22:10:49.747990 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:10:49.759088 [info ] [MainThread]: ========== Begin Summary ==========
[0m22:10:49.763246 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:49.763246 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */

          
     
    INSERT INTO dbtraw.dbtlogs (TargetSchema, ModelName, Materialization,JobStartDate,
    ModelCreateStartDate,ModelCreateEndDate,Status, Executiontime,InvocationId,DbtVersion,
    RecordInsertedDate,Rowcount)
VALUES ('raw_dbt_test__audit', 'test.dbtlearn.test_listing_review_created_at_consistency', 'test',
'2025-02-02 21:10:47.662982+00:00',
'2025-02-02 21:10:49.439183',
'2025-02-02 21:10:49.674151'
,'pass','0.24387502670288086',
'f56d37a4-3289-4bc0-8dbd-94d4e0ae4bb0','1.9.1',CURRENT_TIMESTAMP(0),'1');
           
      
  
[0m22:10:49.763246 [debug] [MainThread]: Postgres adapter: Postgres error: value too long for type character varying(50)

[0m22:10:49.768974 [debug] [MainThread]: On master: Close
[0m22:10:49.779619 [info ] [MainThread]: 
[0m22:10:49.780618 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m22:10:49.781614 [info ] [MainThread]: 
[0m22:10:49.782153 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:10:49.782153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:49.783150 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m22:10:49.783150 [debug] [MainThread]: Connection 'test.dbtlearn.test_listing_review_created_at_consistency' was properly closed.
[0m22:10:49.783150 [info ] [MainThread]: 
[0m22:10:49.784825 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m22:10:49.785825 [error] [MainThread]: Encountered an error:
Database Error
  value too long for type character varying(50)
[0m22:10:49.787818 [debug] [MainThread]: Command `dbt test` failed at 22:10:49.787818 after 2.22 seconds
[0m22:10:49.787818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296E7F8C740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296EA5CF6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296EA5CE510>]}
[0m22:10:49.787818 [debug] [MainThread]: Flushing usage events
[0m22:10:50.548754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:07.114577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117C74BC170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117C725C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117C725DCA0>]}


============================== 22:18:07.125356 | 0ed7a9d4-1b6f-4bb6-9a72-ad4caf8c3d86 ==============================
[0m22:18:07.125356 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:18:07.127353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:18:07.342577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ed7a9d4-1b6f-4bb6-9a72-ad4caf8c3d86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117C4AAD9A0>]}
[0m22:18:07.409674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ed7a9d4-1b6f-4bb6-9a72-ad4caf8c3d86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117C774C350>]}
[0m22:18:07.414299 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:18:07.682624 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m22:18:08.050552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:08.050552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:08.141640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ed7a9d4-1b6f-4bb6-9a72-ad4caf8c3d86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117C79FA870>]}
[0m22:18:08.184386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ed7a9d4-1b6f-4bb6-9a72-ad4caf8c3d86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117C8D15010>]}
[0m22:18:08.185383 [info ] [MainThread]: Found 8 models, 1 analysis, 10 data tests, 1 seed, 1 operation, 2 snapshots, 3 sources, 1 exposure, 814 macros
[0m22:18:08.186345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ed7a9d4-1b6f-4bb6-9a72-ad4caf8c3d86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117C8CCF2C0>]}
[0m22:18:08.187372 [info ] [MainThread]: 
[0m22:18:08.190823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:18:08.191824 [info ] [MainThread]: 
[0m22:18:08.192855 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:18:08.197635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DBT_raw'
[0m22:18:08.293140 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m22:18:08.293140 [debug] [ThreadPool]: On list_DBT_raw: BEGIN
[0m22:18:08.293140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:08.339973 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m22:18:08.339973 [debug] [ThreadPool]: Using postgres connection "list_DBT_raw"
[0m22:18:08.339973 [debug] [ThreadPool]: On list_DBT_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_DBT_raw"} */
select
      'DBT' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'DBT' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m22:18:08.349564 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.008 seconds
[0m22:18:08.349564 [debug] [ThreadPool]: On list_DBT_raw: ROLLBACK
[0m22:18:08.349564 [debug] [ThreadPool]: On list_DBT_raw: Close
[0m22:18:08.361514 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:08.361514 [debug] [MainThread]: On master: BEGIN
[0m22:18:08.361514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:08.413680 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m22:18:08.414715 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:08.414715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:18:08.431309 [debug] [MainThread]: SQL status: SELECT 3 in 0.014 seconds
[0m22:18:08.431309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ed7a9d4-1b6f-4bb6-9a72-ad4caf8c3d86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117C78F7560>]}
[0m22:18:08.431309 [debug] [MainThread]: On master: ROLLBACK
[0m22:18:08.439407 [debug] [MainThread]: On master: Close
[0m22:18:08.446349 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m22:18:08.447387 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbtlearn.src_hosts'
[0m22:18:08.447387 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m22:18:08.467455 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m22:18:08.467455 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m22:18:08.470671 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m22:18:08.471703 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m22:18:08.472617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m22:18:08.472617 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m22:18:08.474944 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m22:18:08.478579 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m22:18:08.480585 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m22:18:08.480585 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m22:18:08.482309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m22:18:08.483473 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m22:18:08.484471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m22:18:08.492766 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m22:18:08.494833 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m22:18:08.496122 [debug] [Thread-1 (]: Began running node operation.dbtlearn.dbtlearn-on-run-end-0
[0m22:18:08.497120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now operation.dbtlearn.dbtlearn-on-run-end-0)
[0m22:18:08.498150 [debug] [Thread-1 (]: Began compiling node operation.dbtlearn.dbtlearn-on-run-end-0
[0m22:18:08.516271 [info ] [Thread-1 (]: ========== Begin Summary ==========
[0m22:18:08.517493 [info ] [Thread-1 (]: ========== End Summary ==========
[0m22:18:08.518491 [debug] [Thread-1 (]: Writing injected SQL for node "operation.dbtlearn.dbtlearn-on-run-end-0"
[0m22:18:08.519488 [debug] [Thread-1 (]: Began executing node operation.dbtlearn.dbtlearn-on-run-end-0
[0m22:18:08.519825 [debug] [Thread-1 (]: Finished running node operation.dbtlearn.dbtlearn-on-run-end-0
[0m22:18:08.520855 [debug] [Thread-1 (]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m22:18:08.520855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly operation.dbtlearn.dbtlearn-on-run-end-0, now seed.dbtlearn.seed_full_moon_dates)
[0m22:18:08.521678 [debug] [Thread-1 (]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m22:18:08.524033 [debug] [Thread-1 (]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m22:18:08.525078 [debug] [Thread-1 (]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m22:18:08.525078 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_hosts
[0m22:18:08.526077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtlearn.seed_full_moon_dates, now snapshot.dbtlearn.scd_raw_hosts)
[0m22:18:08.526077 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_hosts
[0m22:18:08.530969 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_hosts
[0m22:18:08.532318 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_hosts
[0m22:18:08.533355 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m22:18:08.533812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearn.scd_raw_hosts, now snapshot.dbtlearn.scd_raw_listings)
[0m22:18:08.533812 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m22:18:08.534838 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m22:18:08.534838 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m22:18:08.539573 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m22:18:08.539573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearn.scd_raw_listings, now test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65)
[0m22:18:08.540571 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m22:18:08.563528 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m22:18:08.563528 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m22:18:08.563528 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m22:18:08.566398 [debug] [Thread-1 (]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m22:18:08.566398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65, now test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9)
[0m22:18:08.567427 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m22:18:08.577272 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m22:18:08.577272 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m22:18:08.583076 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m22:18:08.583076 [debug] [Thread-1 (]: Began running node test.dbtlearn.test_listing_review_created_at_consistency
[0m22:18:08.583076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9, now test.dbtlearn.test_listing_review_created_at_consistency)
[0m22:18:08.584106 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.test_listing_review_created_at_consistency
[0m22:18:08.585808 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.test_listing_review_created_at_consistency"
[0m22:18:08.587131 [debug] [Thread-1 (]: Began executing node test.dbtlearn.test_listing_review_created_at_consistency
[0m22:18:08.588445 [debug] [Thread-1 (]: Finished running node test.dbtlearn.test_listing_review_created_at_consistency
[0m22:18:08.588445 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m22:18:08.589443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.test_listing_review_created_at_consistency, now model.dbtlearn.dim_hosts_cleansed)
[0m22:18:08.589584 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m22:18:08.590618 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m22:18:08.593941 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m22:18:08.594987 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m22:18:08.594987 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m22:18:08.596142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m22:18:08.596142 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m22:18:08.597174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m22:18:08.600356 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m22:18:08.601396 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m22:18:08.601396 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m22:18:08.602425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m22:18:08.602680 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m22:18:08.625550 [info ] [Thread-1 (]: Loading "DBT"."raw"."fct_reviews" incrementally (all missing dates)
[0m22:18:08.628512 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m22:18:08.629546 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m22:18:08.630506 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m22:18:08.630506 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m22:18:08.632013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m22:18:08.632013 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m22:18:08.633047 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m22:18:08.637770 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m22:18:08.638769 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m22:18:08.638769 [debug] [Thread-1 (]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m22:18:08.640488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_w_hosts, now test.dbtlearn.dim_listings_minimum_nights)
[0m22:18:08.640488 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m22:18:08.644107 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m22:18:08.647462 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m22:18:08.649489 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m22:18:08.650660 [debug] [Thread-1 (]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m22:18:08.650660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dim_listings_minimum_nights, now test.dbtlearn.no_nulls_in_dim_listings)
[0m22:18:08.651684 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m22:18:08.670937 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m22:18:08.670937 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: BEGIN
[0m22:18:08.670937 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:18:08.870273 [debug] [Thread-1 (]: SQL status: BEGIN in 0.198 seconds
[0m22:18:08.871270 [debug] [Thread-1 (]: Using postgres connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m22:18:08.871270 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "DBT".INFORMATION_SCHEMA.columns
      where table_name = 'dim_listings_cleansed'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m22:18:08.907771 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.041 seconds
[0m22:18:08.923853 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m22:18:08.923853 [debug] [Thread-1 (]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m22:18:08.928199 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: ROLLBACK
[0m22:18:08.929510 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m22:18:08.931881 [debug] [Thread-1 (]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m22:18:08.933212 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m22:18:08.934210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.no_nulls_in_dim_listings, now test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m22:18:08.935244 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m22:18:08.952371 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m22:18:08.961929 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m22:18:08.963966 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m22:18:08.965480 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m22:18:08.966496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m22:18:08.967371 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m22:18:08.968415 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m22:18:08.976585 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m22:18:08.977709 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m22:18:08.977709 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m22:18:08.978944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m22:18:08.978944 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m22:18:08.989207 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m22:18:08.990552 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m22:18:08.991549 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m22:18:08.992382 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m22:18:08.993379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m22:18:08.993379 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m22:18:08.995208 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m22:18:09.001337 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m22:18:09.002394 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m22:18:09.003391 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m22:18:09.003720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e, now model.dbtlearn.mart_fullmoon_reviews)
[0m22:18:09.003720 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m22:18:09.004717 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m22:18:09.010185 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m22:18:09.011418 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m22:18:09.011418 [debug] [Thread-1 (]: Began running node test.dbtlearn.consistent_created_at
[0m22:18:09.012415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.mart_fullmoon_reviews, now test.dbtlearn.consistent_created_at)
[0m22:18:09.012845 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.consistent_created_at
[0m22:18:09.013841 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m22:18:09.016549 [debug] [Thread-1 (]: Began executing node test.dbtlearn.consistent_created_at
[0m22:18:09.017547 [debug] [Thread-1 (]: Finished running node test.dbtlearn.consistent_created_at
[0m22:18:09.017547 [debug] [Thread-1 (]: Began running node analysis.dbtlearn.full_moon_no_sleep
[0m22:18:09.018808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.consistent_created_at, now analysis.dbtlearn.full_moon_no_sleep)
[0m22:18:09.018808 [debug] [Thread-1 (]: Began compiling node analysis.dbtlearn.full_moon_no_sleep
[0m22:18:09.019805 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbtlearn.full_moon_no_sleep"
[0m22:18:09.019805 [debug] [Thread-1 (]: Began executing node analysis.dbtlearn.full_moon_no_sleep
[0m22:18:09.023879 [debug] [Thread-1 (]: Finished running node analysis.dbtlearn.full_moon_no_sleep
[0m22:18:09.024948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:09.024948 [debug] [MainThread]: Connection 'list_DBT_raw' was properly closed.
[0m22:18:09.024948 [debug] [MainThread]: Connection 'analysis.dbtlearn.full_moon_no_sleep' was properly closed.
[0m22:18:09.025947 [debug] [MainThread]: Command end result
[0m22:18:09.187256 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m22:18:09.197698 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m22:18:09.198696 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\run_results.json
[0m22:18:10.512682 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m22:18:10.513680 [info ] [MainThread]: Building catalog
[0m22:18:10.519476 [debug] [ThreadPool]: Acquiring new postgres connection 'DBT.information_schema'
[0m22:18:10.535935 [debug] [ThreadPool]: Using postgres connection "DBT.information_schema"
[0m22:18:10.536934 [debug] [ThreadPool]: On DBT.information_schema: BEGIN
[0m22:18:10.538456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:10.745697 [debug] [ThreadPool]: SQL status: BEGIN in 0.207 seconds
[0m22:18:10.745697 [debug] [ThreadPool]: Using postgres connection "DBT.information_schema"
[0m22:18:10.745697 [debug] [ThreadPool]: On DBT.information_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "DBT.information_schema"} */

    
    

    select
        'DBT' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('raw_listings')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('raw_hosts')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('dim_listings_cleansed')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('src_reviews')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('mart_fullmoon_reviews')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('src_listings')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('scd_raw_hosts')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('scd_raw_listings')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('src_hosts')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('raw_reviews')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('seed_full_moon_dates')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('dim_hosts_cleansed')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('dim_listings_w_hosts')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('fct_reviews')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m22:18:10.775920 [debug] [ThreadPool]: SQL status: SELECT 97 in 0.029 seconds
[0m22:18:10.809552 [debug] [ThreadPool]: On DBT.information_schema: ROLLBACK
[0m22:18:10.809552 [debug] [ThreadPool]: On DBT.information_schema: Close
[0m22:18:10.838691 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\catalog.json
[0m22:18:10.962627 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\manifest.json
[0m22:18:10.965966 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\semantic_manifest.json
[0m22:18:10.966561 [info ] [MainThread]: Catalog written to C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\dbtlearn\target\catalog.json
[0m22:18:10.967559 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:18:10.967559 after 4.15 seconds
[0m22:18:10.968557 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:18:10.968557 [debug] [MainThread]: Connection 'DBT.information_schema' was properly closed.
[0m22:18:10.969297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117C9816720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117C9816DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117C9816060>]}
[0m22:18:10.969297 [debug] [MainThread]: Flushing usage events
[0m22:18:11.611976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:21.131680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5ADFA8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5D5F7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5D6F7560>]}


============================== 22:18:21.139440 | 9ea93000-10f8-48c7-b4dc-585add0daf12 ==============================
[0m22:18:21.139440 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:18:21.144620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\admin\\Desktop\\Course\\complete-dbt-bootcamp-zero-to-hero\\dbtlearn\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:18:21.369343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ea93000-10f8-48c7-b4dc-585add0daf12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5DC3CDA0>]}
[0m22:18:21.433421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ea93000-10f8-48c7-b4dc-585add0daf12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5B032540>]}
[0m22:18:21.691542 [error] [MainThread]: Encountered an error:
[WinError 10048] Only one usage of each socket address (protocol/network address/port) is normally permitted
[0m22:18:21.747630 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\env\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\env\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\env\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\env\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\env\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\env\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\admin\Desktop\Course\complete-dbt-bootcamp-zero-to-hero\env\Lib\site-packages\dbt\task\docs\serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\admin\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 457, in __init__
    self.server_bind()
  File "C:\Users\admin\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [WinError 10048] Only one usage of each socket address (protocol/network address/port) is normally permitted

[0m22:18:21.753641 [debug] [MainThread]: Command `dbt docs serve` failed at 22:18:21.753641 after 0.83 seconds
[0m22:18:21.754641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5B2FCDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5DEBC4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5D069E80>]}
[0m22:18:21.755161 [debug] [MainThread]: Flushing usage events
[0m22:18:22.650762 [debug] [MainThread]: An error was encountered while trying to flush usage events
